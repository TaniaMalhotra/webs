<?xml version="1.0" encoding="UTF-8"?><rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:wfw="http://wellformedweb.org/CommentAPI/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
	xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
	
	xmlns:georss="http://www.georss.org/georss"
	xmlns:geo="http://www.w3.org/2003/01/geo/wgs84_pos#"
	>

<channel>
	<title>transform &#8211; CSS-Tricks</title>
	<atom:link href="https://css-tricks.com/tag/transform/feed/" rel="self" type="application/rss+xml" />
	<link>https://css-tricks.com</link>
	<description>Tips, Tricks, and Techniques on using Cascading Style Sheets.</description>
	<lastBuildDate>Mon, 11 May 2020 14:46:22 +0000</lastBuildDate>
	<language>en-US</language>
	<sy:updatePeriod>
	hourly	</sy:updatePeriod>
	<sy:updateFrequency>
	1	</sy:updateFrequency>
	<generator>https://wordpress.org/?v=5.4.2</generator>
<site xmlns="com-wordpress:feed-additions:1">45537868</site>	<item>
		<title>Turning a Fixed-Size Object into a Responsive Element</title>
		<link>https://css-tricks.com/turning-a-fixed-size-object-into-a-responsive-element/</link>
					<comments>https://css-tricks.com/turning-a-fixed-size-object-into-a-responsive-element/#comments</comments>
		
		<dc:creator><![CDATA[Philip Kiely]]></dc:creator>
		<pubDate>Mon, 11 May 2020 14:46:21 +0000</pubDate>
				<category><![CDATA[Article]]></category>
		<category><![CDATA[bootstrap]]></category>
		<category><![CDATA[responsive]]></category>
		<category><![CDATA[transform]]></category>
		<category><![CDATA[units]]></category>
		<guid isPermaLink="false">https://css-tricks.com/?p=308201</guid>

					<description><![CDATA[<p>I was in a situation recently where I wanted to show an iPhone on a website. I wanted users to be able to interact with an application demo on this “mock” phone, so it had to be rendered in CSS, not an image. I found a great library called <a href="https://github.com/marvelapp/devices.css">marvelapp/devices.css</a>. The library implemented the device I needed with pure CSS, and they looked great, but there was a problem: the devices it offered were not responsive (i.e. they couldn’t &#8230; <a href="https://css-tricks.com/turning-a-fixed-size-object-into-a-responsive-element/" class="read-more">Read article <span class="screen-reader-text"> &#8220;Turning a Fixed-Size Object into a Responsive Element&#8221;</span></a></p>
<p>The post <a rel="nofollow" href="https://css-tricks.com/turning-a-fixed-size-object-into-a-responsive-element/">Turning a Fixed-Size Object into a Responsive Element</a> appeared first on <a rel="nofollow" href="https://css-tricks.com">CSS-Tricks</a>.</p>
]]></description>
										<content:encoded><![CDATA[
<p>I was in a situation recently where I wanted to show an iPhone on a website. I wanted users to be able to interact with an application demo on this “mock” phone, so it had to be rendered in CSS, not an image. I found a great library called <a href="https://github.com/marvelapp/devices.css">marvelapp/devices.css</a>. The library implemented the device I needed with pure CSS, and they looked great, but there was a problem: the devices it offered were not responsive (i.e. they couldn’t be scaled). An <a href="https://github.com/marvelapp/devices.css/issues/21">open issue</a> listed a few options, but each had browser incompatibilities or other issues. I set out to modify the library to make the devices responsive.</p>



<span id="more-308201"></span>



<p>Here is <a href="https://github.com/philipkiely/devices.css">the final resizable library</a>. Below, we&#8217;ll walk through the code involved in creating it.</p>



<p>The original library was written in Sass and implements the devices using elements with fixed sizing in pixels. The authors also provided a straightforward HTML example for each device, including the iPhone X we&#8217;ll be working with throughout this article. Here&#8217;s a look at the original. Note that the device it renders, while detailed, is rather large and does not change sizes.</p>



<div class="wp-block-cp-codepen-gutenberg-embed-block cp_embed_wrapper"><iframe id="cp_embed_mderJRM" src="//codepen.io/anon/embed/mderJRM?height=450&amp;theme-id=1&amp;slug-hash=mderJRM&amp;default-tab=result" height="450" scrolling="no" frameborder="0" allowfullscreen allowpaymentrequest name="CodePen Embed mderJRM" title="CodePen Embed mderJRM" class="cp_embed_iframe" style="width:100%;overflow:hidden">CodePen Embed Fallback</iframe></div>



<h3>Here’s the approach</h3>



<p>There are three CSS tricks that I used to make the devices resizable:</p>



<ol><li><code>calc()</code>, <a href="https://css-tricks.com/a-complete-guide-to-calc-in-css/">a CSS function</a> that can perform calculations, even when inputs have different units</li><li><code>--size-divisor</code>, a CSS custom property used with the <code>var()</code> function</li><li><code>@media</code> queries separated by <code>min-width</code></li></ol>



<p>Let&#8217;s take a look at each of them.</p>



<h4><strong>c</strong>alc()</h4>



<p>The <a href="https://css-tricks.com/a-complete-guide-to-calc-in-css/">CSS <code>calc()</code> function</a> allows us to change the size of the various aspects of the device. The function takes an expression as an input and returns the evaluation of the function as the output, with appropriate units. If we wanted to make the devices half of their original size, we would need to divide every pixel measurement by 2.</p>



<p>Before:</p>



<pre rel="CSS" class="wp-block-csstricks-code-block language-css" data-line=""><code markup="tt">width: 375px;</code></pre>



<p>After:</p>



<pre rel="CSS" class="wp-block-csstricks-code-block language-css" data-line=""><code markup="tt">width: calc(375px / 2);</code></pre>



<p>The second snippet yields a length half the size of the first snippet. Every pixel measurement in the original library will need to be wrapped in a <code>calc()</code> function for this to resize the whole device.</p>



<h4>var(&#8211;size-divisor)</h4>



<p>A <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/var">CSS variable</a> must first be declared at the beginning of the file before it can be used anywhere.</p>



<pre rel="CSS" class="wp-block-csstricks-code-block language-css" data-line=""><code markup="tt">:root {
  --size-divisor: 3;
}</code></pre>



<p>With that, this value is accessible throughout the stylesheet with the var() function. This will be exceedingly useful as we will want all pixel counts to be divided by the same number when resizing devices, while avoiding magic numbers and simplifying the code needed to make the devices responsive.</p>



<pre rel="CSS" class="wp-block-csstricks-code-block language-css" data-line=""><code markup="tt">width: calc(375px / var(--size-divisor));</code></pre>



<p>With the value defined above, this would return the original width divided by three, in pixels.</p>



<h4>@media</h4>



<p>To make the devices responsive, they must <em>respond</em> to changes in screen size. We achieve this using <a href="https://css-tricks.com/snippets/css/media-queries-for-standard-devices/">media queries</a>. These queries watch the width of the screen and fire if the screen size crosses given thresholds. I chose the breakpoints based on <a href="https://getbootstrap.com/docs/4.4/layout/overview/%23responsive-breakpoints">Bootstrap&#8217;s sizes for <code>xs</code>, <code>sm</code>, and so on</a>.&nbsp;</p>



<p>There is no need to set a breakpoint at a minimum width of zero pixels; instead, the <code>:root</code> declaration at the beginning of the file handles these extra-small screens. These media queries must go at the end of the document and be arranged in ascending order of <code>min-width</code>.</p>



<pre rel="CSS" class="wp-block-csstricks-code-block language-css" data-line=""><code markup="tt">@media (min-width: 576px) {
  :root {
    --size-divisor: 2;
  }
}
@media (min-width: 768px) {
  :root {
    --size-divisor: 1.5;
  }
}
@media (min-width: 992px) { 
  :root {
    --size-divisor: 1;
  }
}
@media (min-width: 1200px) { 
  :root {
    --size-divisor: .67;
  }
}</code></pre>



<p>Changing the values in these queries will adjust the magnitude of resizing that the device undergoes. Note that <code>calc()</code> handles floats just as well as integers.</p>



<h3>Preprocessing the preprocessor with Python</h3>



<p>With these tools in hand, I needed a way to apply my new approach to the multi-thousand-line library. The resulting file will start with a variable declaration, include the entire library with each pixel measurement wrapped in a <code>calc()</code> function, and end with the above media queries.</p>



<p>Rather than prepare the changes by hand, I created a Python script that automatically converts all of the pixel measurements.</p>



<pre rel="Python" class="wp-block-csstricks-code-block language-javascript" data-line=""><code markup="tt">def scale(token):
  if token[-2:] == ';\n':
    return 'calc(' + token[:-2] + ' / var(--size-divisor));\n'
  elif token[-3:] == ');\n':
    return '(' + token[:-3] + ' / var(--size-divisor));\n'
  return 'calc(' + token + ' / var(--size-divisor))'</code></pre>



<p>This function, given a string containing <code>NNpx</code>, returns <code>calc(NNpx / var(--size-divisor));</code>. Throughout the file, there are fortunately only three matches for pixels: <code>NNpx</code>, <code>NNpx</code>; and<code> NNpx</code>);. The rest is just string concatenation. However, these tokens have already been generated by separating each line by space characters.</p>



<pre rel="Python" class="wp-block-csstricks-code-block language-javascript" data-line=""><code markup="tt">def build_file(scss):
  out = ':root {\n\t--size-divisor: 3;\n}\n\n'
  for line in scss:
    tokens = line.split(' ')
    for i in range(len(tokens)):
      if 'px' in tokens[i]:
        tokens[i] = scale(tokens[i])
    out += ' '.join(tokens)
  out += "@media (min-width: 576px) {\n  \
    :root {\n\t--size-divisor: 2;\n  \
    }\n}\n\n@media (min-width: 768px) {\n \
    :root {\n\t--size-divisor: 1.5;\n  \
    }\n}\n\n@media (min-width: 992px) { \
    \n  :root {\n\t--size-divisor: 1;\n  \
    }\n}\n\n@media (min-width: 1200px) { \
    \n  :root {\n\t--size-divisor: .67;\n  }\n}"
  return out</code></pre>



<p>This function, which builds the new library, begins by declaring the CSS variable. Then, it iterates through the entire old library in search of pixel measurements to scale. For each of the hundreds of tokens it finds that contain <code>px</code>, it scales that token. As the iteration progresses, the function preserves the original line structure by rejoining the tokens. Finally, it appends the necessary media queries and returns the entire library as a string. A bit of code to run the functions and read and write from files finishes the job.</p>



<pre rel="Python" class="wp-block-csstricks-code-block language-javascript" data-line=""><code markup="tt">if __name__ == '__main__':
  f = open('devices_old.scss', 'r')
  scss = f.readlines()
  f.close()
  out = build_file(scss)
  f = open('devices_new.scss', 'w')
  f.write(out)
  f.close()</code></pre>



<p>This process creates a new library in Sass. To create the CSS file for final use, run:</p>



<pre rel="Terminal" class="wp-block-csstricks-code-block language-javascript" data-line=""><code markup="tt">sass devices_new.scss devices.css</code></pre>



<p>This new library offers the same devices, but they are responsive! Here it is:</p>



<div class="wp-block-cp-codepen-gutenberg-embed-block cp_embed_wrapper"><iframe id="cp_embed_NWGRqpL" src="//codepen.io/anon/embed/NWGRqpL?height=450&amp;theme-id=1&amp;slug-hash=NWGRqpL&amp;default-tab=result" height="450" scrolling="no" frameborder="0" allowfullscreen allowpaymentrequest name="CodePen Embed NWGRqpL" title="CodePen Embed NWGRqpL" class="cp_embed_iframe" style="width:100%;overflow:hidden">CodePen Embed Fallback</iframe></div>



<p>To read the actual output file, which is thousands of lines, <a href="https://github.com/philipkiely/devices.css">check it out on GitHub.</a></p>



<h3>Other approaches</h3>



<p>While the results of this process are pretty compelling, it was a bit of work to get them. Why didn&#8217;t I take a simpler approach? Here are three more approaches with their advantages and drawbacks.</p>



<h4>zoom</h4>



<p>One initially promising approach would be to use zoom to scale the devices. This would uniformly scale the device and could be paired with media queries as with my solution, but would function without the troublesome <code>calc()</code> and variable.</p>



<p>This won&#8217;t work for a simple reason: <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/zoom">zoom is a non-standard property</a>. Among other limitations, it is not supported in Firefox.</p>



<h4>Replace px with em</h4>



<p>Another find-and-replace approach prescribes replacing all instances of px with em. Then, the devices shrink and grow according to font size. However, getting them small enough to fit on a mobile display may require minuscule font sizes, smaller than the minimum sizes browsers, like Chrome, enforce. This approach could also run into trouble if a visitor to your website is using assistive technology that increases font size.</p>



<p>This could be addressed by scaling all of the values down by a factor of 100 and then applying standard font sizes. However, that requires just as much preprocessing as this article&#8217;s approach, and I think it is more elegant to perform these calculations directly rather than manipulate font sizes.</p>



<h4>scale()</h4>



<p>The <a href="https://css-tricks.com/almanac/properties/t/transform/">scale() function</a> can change the size of entire objects. The function returns a <code>&lt;transform-function&gt;</code>, which can be given to a transform attribute in a style. Overall, this is a strong approach, but does not change the actual measurement of the CSS device. I prefer my approach, especially when working with complex UI elements rendered on the device&#8217;s &#8220;screen.&#8221;</p>



<p>Chris Coyier prepared an example using this approach.</p>



<div class="wp-block-cp-codepen-gutenberg-embed-block cp_embed_wrapper"><iframe id="cp_embed_MWwdpVL" src="//codepen.io/anon/embed/MWwdpVL?height=525&amp;theme-id=1&amp;slug-hash=MWwdpVL&amp;default-tab=result" height="525" scrolling="no" frameborder="0" allowfullscreen allowpaymentrequest name="CodePen Embed MWwdpVL" title="CodePen Embed MWwdpVL" class="cp_embed_iframe" style="width:100%;overflow:hidden">CodePen Embed Fallback</iframe></div>



<h3>In conclusion</h3>



<p>Hundreds of <code>calc()</code> calls might not be the first tool I would reach for if implementing this library from scratch, but overall, this is an effective approach for making existing libraries resizable. Adding variables and media queries makes the objects responsive. Should the underlying library be updated, the Python script would be able to process these changes into a new version of our responsive library.</p>
<p>The post <a rel="nofollow" href="https://css-tricks.com/turning-a-fixed-size-object-into-a-responsive-element/">Turning a Fixed-Size Object into a Responsive Element</a> appeared first on <a rel="nofollow" href="https://css-tricks.com">CSS-Tricks</a>.</p>
]]></content:encoded>
					
					<wfw:commentRss>https://css-tricks.com/turning-a-fixed-size-object-into-a-responsive-element/feed/</wfw:commentRss>
			<slash:comments>3</slash:comments>
		
		
		<post-id xmlns="com-wordpress:feed-additions:1">308201</post-id>	</item>
		<item>
		<title>Create Diagonal Layouts Like it&#8217;s 2020</title>
		<link>https://9elements.com/blog/pure-css-diagonal-layouts/</link>
					<comments>https://css-tricks.com/create-diagonal-layouts-like-its-2020/#comments</comments>
		
		<dc:creator><![CDATA[Chris Coyier]]></dc:creator>
		<pubDate>Thu, 09 Apr 2020 14:44:57 +0000</pubDate>
				<category><![CDATA[Link]]></category>
		<category><![CDATA[clip-path]]></category>
		<category><![CDATA[transform]]></category>
		<guid isPermaLink="false">https://css-tricks.com/?p=306409</guid>

					<description><![CDATA[<p>Nils Binder <a href="https://9elements.com/blog/pure-css-diagonal-layouts/" class="ek-link">covers the ways</a>:</p>
<blockquote class="wp-block-quote">
<p>1. Use an SVG in the form of a triangle. This technique is nicely described by Erik Kennedy on&#160;<a href="https://css-tricks.com/creating-non-rectangular-headers/" class="ek-link">CSS-Tricks</a>.</p>
<p>2. Hide part of your section using <code>clip-path</code>. Read&#160;<a href="https://codyhouse.co/blog/post/css-diagonal-containers" class="ek-link">Diagonal Containers in CSS&#160;by Sebastiano Guerriero</a> or&#160;<a href="https://kilianvalkhof.com/2017/design/sloped-edges-with-consistent-angle-in-css/" class="ek-link">Sloped edges with consistent angle in CSS&#160;by Kilian Valkhof.</a></p>
<p>3. Using CSS Transforms</p>
</blockquote>
<p>I would normally be a #2 kinda guy — slice off the top and bottom a bit, make sure there is ample padding, &#8230; <a href="https://css-tricks.com/create-diagonal-layouts-like-its-2020/" class="read-more">Read article <span class="screen-reader-text"> &#8220;Create Diagonal Layouts Like it&#8217;s 2020&#8221;</span></a></p>
<p>The post <a rel="nofollow" href="https://css-tricks.com/create-diagonal-layouts-like-its-2020/">Create Diagonal Layouts Like it&#8217;s 2020</a> appeared first on <a rel="nofollow" href="https://css-tricks.com">CSS-Tricks</a>.</p>
]]></description>
										<content:encoded><![CDATA[
<p>Nils Binder <a href="https://9elements.com/blog/pure-css-diagonal-layouts/" class="ek-link">covers the ways</a>:</p>



<blockquote class="wp-block-quote"><p>1. Use an SVG in the form of a triangle. This technique is nicely described by Erik Kennedy on&nbsp;<a href="https://css-tricks.com/creating-non-rectangular-headers/" class="ek-link">CSS-Tricks</a>.</p><p>2. Hide part of your section using <code>clip-path</code>. Read&nbsp;<a href="https://codyhouse.co/blog/post/css-diagonal-containers" class="ek-link">Diagonal Containers in CSS&nbsp;by Sebastiano Guerriero</a> or&nbsp;<a href="https://kilianvalkhof.com/2017/design/sloped-edges-with-consistent-angle-in-css/" class="ek-link">Sloped edges with consistent angle in CSS&nbsp;by Kilian Valkhof.</a></p><p>3. Using CSS Transforms</p></blockquote>



<p>I would normally be a #2 kinda guy — slice off the top and bottom a bit, make sure there is ample padding, and call it a day. But Nils almost has me convinced this fancy math is better.</p>



<span id="more-306409"></span>



<p>Here&#8217;s a kinda dumb <code>clip-path</code> way:</p>



<div class="wp-block-cp-codepen-gutenberg-embed-block cp_embed_wrapper"><iframe id="cp_embed_QWbeMdv" src="//codepen.io/anon/embed/QWbeMdv?height=550&amp;theme-id=1&amp;slug-hash=QWbeMdv&amp;default-tab=result" height="550" scrolling="no" frameborder="0" allowfullscreen allowpaymentrequest name="CodePen Embed QWbeMdv" title="CodePen Embed QWbeMdv" class="cp_embed_iframe" style="width:100%;overflow:hidden">CodePen Embed Fallback</iframe></div>



<p>And Nils incredibly fancy playground:</p>



<div class="wp-block-cp-codepen-gutenberg-embed-block cp_embed_wrapper"><iframe id="cp_embed_yLyrmyg" src="//codepen.io/anon/embed/yLyrmyg?height=550&amp;theme-id=1&amp;slug-hash=yLyrmyg&amp;default-tab=result" height="550" scrolling="no" frameborder="0" allowfullscreen allowpaymentrequest name="CodePen Embed yLyrmyg" title="CodePen Embed yLyrmyg" class="cp_embed_iframe" style="width:100%;overflow:hidden">CodePen Embed Fallback</iframe></div>
<p><a href="https://9elements.com/blog/pure-css-diagonal-layouts/" title="Direct link to featured article">Direct Link to Article</a> &#8212; <a href="https://css-tricks.com/create-diagonal-layouts-like-its-2020/">Permalink</a></p><p>The post <a rel="nofollow" href="https://css-tricks.com/create-diagonal-layouts-like-its-2020/">Create Diagonal Layouts Like it&#8217;s 2020</a> appeared first on <a rel="nofollow" href="https://css-tricks.com">CSS-Tricks</a>.</p>
]]></content:encoded>
					
					<wfw:commentRss>https://css-tricks.com/create-diagonal-layouts-like-its-2020/feed/</wfw:commentRss>
			<slash:comments>2</slash:comments>
		
		
		<post-id xmlns="com-wordpress:feed-additions:1">306409</post-id>	</item>
		<item>
		<title>How to Re-Create a Nifty Netflix Animation in CSS</title>
		<link>https://css-tricks.com/how-to-re-create-a-nifty-netflix-animation-in-css/</link>
					<comments>https://css-tricks.com/how-to-re-create-a-nifty-netflix-animation-in-css/#comments</comments>
		
		<dc:creator><![CDATA[Chris Geelhoed]]></dc:creator>
		<pubDate>Tue, 07 Apr 2020 14:51:52 +0000</pubDate>
				<category><![CDATA[Article]]></category>
		<category><![CDATA[css animation]]></category>
		<category><![CDATA[transform]]></category>
		<guid isPermaLink="false">https://css-tricks.com/?p=305681</guid>

					<description><![CDATA[<p>The design for Netflix&#8217;s browse page has remained pretty similar for a few years now. One mainstay component is the preview slider that allows users to scroll through content and hover on items to see a preview.</p>
<p>One unique characteristic of the UI is its hover behavior. When a show preview expands on hover, the cards next to it are pushed outward so that they don’t overlap.&#160;</p>
<p>Like this:</p>
<p>It’s like Bill Murray and Brad Pitt are fighting for the&#8230; <a href="https://css-tricks.com/how-to-re-create-a-nifty-netflix-animation-in-css/" class="read-more">Read article <span class="screen-reader-text"> &#8220;How to Re-Create a Nifty Netflix Animation in CSS&#8221;</span></a></p>
<p>The post <a rel="nofollow" href="https://css-tricks.com/how-to-re-create-a-nifty-netflix-animation-in-css/">How to Re-Create a Nifty Netflix Animation in CSS</a> appeared first on <a rel="nofollow" href="https://css-tricks.com">CSS-Tricks</a>.</p>
]]></description>
										<content:encoded><![CDATA[
<p>The design for Netflix&#8217;s browse page has remained pretty similar for a few years now. One mainstay component is the preview slider that allows users to scroll through content and hover on items to see a preview.</p>



<p>One unique characteristic of the UI is its hover behavior. When a show preview expands on hover, the cards next to it are pushed outward so that they don’t overlap.&nbsp;</p>



<span id="more-305681"></span>



<p>Like this:</p>



<figure class="wp-block-image size-large"><img src="https://i2.wp.com/css-tricks.com/wp-content/uploads/2020/03/Oi8Y_TWA.gif?ssl=1" alt="" class="wp-image-305682" data-recalc-dims="1"/><figcaption>It’s like Bill Murray and Brad Pitt are fighting for the spotlight.</figcaption></figure>



<p>We can do this in CSS! No JavaScript. No dependencies. Plain CSS. But before getting into any code, here’s exactly what we want to do:</p>



<ol><li>The card that is hovered over should expand while keeping its aspect ratio.</li><li>When a card is hovered, the other cards should not change size and move outwards so that they don&#8217;t overlap one another.</li><li>All the cards should remain vertically centered with one another.</li></ol>



<p>Sound good? Now let’s get into the code.</p>



<h3>HTML and flexible elements</h3>



<p>Let’s set up a row of images that represents Netflix’s video previews. That includes:</p>



<ul><li>A &nbsp;<code>.container</code>&nbsp;parent element with several <code>.item</code> elements inside</li><li>Each <code>.item</code> element consisting of an image wrapped in an anchor tag</li><li>Turning <code>.container</code> into a flex container that aligns the items in a row</li><li>Setting the flex behavior for the <code>.item</code> class so they take up equal space in the row</li></ul>



<div class="wp-block-cp-codepen-gutenberg-embed-block cp_embed_wrapper"><iframe id="cp_embed_eYNMawe" src="//codepen.io/anon/embed/eYNMawe?height=350&amp;theme-id=1&amp;slug-hash=eYNMawe&amp;default-tab=result" height="350" scrolling="no" frameborder="0" allowfullscreen allowpaymentrequest name="CodePen Embed eYNMawe" title="CodePen Embed eYNMawe" class="cp_embed_iframe" style="width:100%;overflow:hidden">CodePen Embed Fallback</iframe></div>



<h3>Expanding an item on hover</h3>



<p>Our next step is getting an item to expand when it is hovered. We could do this by animating the element’s <code>width</code>, but that would affect the flow of the document and cause the hovered item’s siblings to shrink – plus, animating the <code>width</code> property is known to be <a href="https://developers.google.com/web/fundamentals/design-and-ux/animations/animations-and-performance">poor for performance</a> in some cases.</p>



<p>To avoid squeezing the sibling of the hovered item, we are going to animate the <code>transform</code> property — specifically, its <code>scale()</code> function — instead. This won’t affect document flow the same way <code>width</code> does.</p>



<div class="wp-block-cp-codepen-gutenberg-embed-block cp_embed_wrapper"><iframe id="cp_embed_LYVdooX" src="//codepen.io/anon/embed/LYVdooX?height=350&amp;theme-id=1&amp;slug-hash=LYVdooX&amp;default-tab=result" height="350" scrolling="no" frameborder="0" allowfullscreen allowpaymentrequest name="CodePen Embed LYVdooX" title="CodePen Embed LYVdooX" class="cp_embed_iframe" style="width:100%;overflow:hidden">CodePen Embed Fallback</iframe></div>



<h3>Moving siblings outward</h3>



<p>Getting the siblings of a hovered item to move away from the hovered item is the tricky part of this whole thing. One CSS feature we have at our disposal is the <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/General_sibling_combinator">general sibling combinator</a>. This lets us select all of the sibling items that are positioned <em>after</em> the hovered item.</p>



<p>We’ll turn to the <code>transform</code>&nbsp;property’s <code>translateX()</code>&nbsp;function to move things around. Again, animating <code>transform</code> is much nicer than other properties that impact document flow, like margins and padding.</p>



<p>Since we’ve set an item to scale up 150% on hover, the translation should be set to 25%. That’s half of the additional space that is being occupied by the hovered item.</p>



<pre rel="CSS" class="wp-block-csstricks-code-block language-css" data-line=""><code markup="tt">.item:hover ~ .item {
  transform: translateX(25%);
}</code></pre>



<p>That handles moving things to the right, but how can we translate the items on the <em>left</em>? Since the general sibling combinator only applies to siblings positioned <em>after</em> a given selector (no going “backwards”), we’ll need another approach.</p>



<p>One way is to add an additional hover rule on the parent container itself. Here is the plan:</p>



<ul><li>When hovering the parent container, shift all the items inside that container to the left.</li><li>Use the general sibling combinator to make the items positioned after the hovered item move to the right.</li><li>Get super specific so a hovered item isn’t translated like the rest of the items.</li></ul>



<p>We’re making a big assumption that your document uses a left-to-right writing mode. If you want to use this effect in a right-to-left context, you will need to set all items inside the hovered outer container to move <em>right</em> and use the general sibling combinator to move all selected items <em>left</em>.</p>



<h3>Demo time!</h3>



<div class="wp-block-cp-codepen-gutenberg-embed-block cp_embed_wrapper"><iframe id="cp_embed_RwPjBag" src="//codepen.io/anon/embed/RwPjBag?height=350&amp;theme-id=1&amp;slug-hash=RwPjBag&amp;default-tab=result" height="350" scrolling="no" frameborder="0" allowfullscreen allowpaymentrequest name="CodePen Embed RwPjBag" title="CodePen Embed RwPjBag" class="cp_embed_iframe" style="width:100%;overflow:hidden">CodePen Embed Fallback</iframe></div>



<p>One little thing to note: this final version is using <code>:focus</code> and <code>:focus-within</code> pseudo-classes to support keyboard navigation. The Netflix example isn’t using it, but I think that’s a nice touch for accessibility.</p>



<hr class="wp-block-separator"/>



<p>There we have it! Yes, we could have used JavaScript event listeners instead of CSS hover rules., and that could possibly be better for maintainability and readability. But it’s sometimes fun to see just how far CSS can take us!</p>
<p>The post <a rel="nofollow" href="https://css-tricks.com/how-to-re-create-a-nifty-netflix-animation-in-css/">How to Re-Create a Nifty Netflix Animation in CSS</a> appeared first on <a rel="nofollow" href="https://css-tricks.com">CSS-Tricks</a>.</p>
]]></content:encoded>
					
					<wfw:commentRss>https://css-tricks.com/how-to-re-create-a-nifty-netflix-animation-in-css/feed/</wfw:commentRss>
			<slash:comments>16</slash:comments>
		
		
		<post-id xmlns="com-wordpress:feed-additions:1">305681</post-id>	</item>
		<item>
		<title>How They Fit Together: Transform, Translate, Rotate, Scale, and Offset</title>
		<link>https://danielcwilson.com/blog/2020/02/motion-path-transforms/</link>
		
		<dc:creator><![CDATA[Chris Coyier]]></dc:creator>
		<pubDate>Mon, 30 Mar 2020 14:20:34 +0000</pubDate>
				<category><![CDATA[Article]]></category>
		<category><![CDATA[transform]]></category>
		<guid isPermaLink="false">https://css-tricks.com/?p=305639</guid>

					<description><![CDATA[<p>Firefox 72 was first out of the gate with &#8220;independent transforms.&#8221; That is, instead of having to combine transforms together, like:</p>
<pre rel="CSS" class="wp-block-csstricks-code-block language-css" data-line=""><code markup="tt">.el {
  transform: translate(10px, 10px) scale(0.95) rotate(10deg);
}</code></pre>
<p>&#8230;we can do:</p>
<pre rel="CSS" class="wp-block-csstricks-code-block language-css" data-line=""><code markup="tt">.el {
  rotate: 10deg;
  scale: 0.95;
  translate: 10px 10px;
}</code></pre>
<p>That&#8217;s extremely useful, as having to <em>repeat</em> other transforms when you change a single one, lest remove them, is tedious and prone to error.</p>
<p>But there is some nuance to know about here, and <a href="https://danielcwilson.com/blog/2020/02/motion-path-transforms/">Dan Wilson digs in</a>&#8230; <a href="https://css-tricks.com/how-they-fit-together-transform-translate-rotate-scale-and-offset/" class="read-more">Read article <span class="screen-reader-text"> &#8220;How They Fit Together: Transform, Translate, Rotate, Scale, and Offset&#8221;</span></a></p>
<p>The post <a rel="nofollow" href="https://css-tricks.com/how-they-fit-together-transform-translate-rotate-scale-and-offset/">How They Fit Together: Transform, Translate, Rotate, Scale, and Offset</a> appeared first on <a rel="nofollow" href="https://css-tricks.com">CSS-Tricks</a>.</p>
]]></description>
										<content:encoded><![CDATA[
<p>Firefox 72 was first out of the gate with &#8220;independent transforms.&#8221; That is, instead of having to combine transforms together, like:</p>



<pre rel="CSS" class="wp-block-csstricks-code-block language-css" data-line=""><code markup="tt">.el {
  transform: translate(10px, 10px) scale(0.95) rotate(10deg);
}</code></pre>



<p>&#8230;we can do:</p>



<pre rel="CSS" class="wp-block-csstricks-code-block language-css" data-line=""><code markup="tt">.el {
  rotate: 10deg;
  scale: 0.95;
  translate: 10px 10px;
}</code></pre>



<p>That&#8217;s extremely useful, as having to <em>repeat</em> other transforms when you change a single one, lest remove them, is tedious and prone to error.</p>



<p>But there is some nuance to know about here, and <a href="https://danielcwilson.com/blog/2020/02/motion-path-transforms/">Dan Wilson digs in</a>.</p>



<span id="more-305639"></span>



<p>Little things to know:</p>



<ul><li>Independent transforms happen <em>first</em>. The <code>transform</code> property happens last and stacks on top of what has already been done, which can get confusing<a href="#fn:1">¹</a>.  </li><li>They all share the same <code>transform-origin</code>.</li><li>The <code>offset-*</code> properties <em>also</em> effectively moves/rotates elements. Those happen <em>after</em> independent transforms and <em>before</em> <code>transform</code>.</li></ul>



<div class="wp-block-group footnotes" id="fn:1"><div class="wp-block-group__inner-container">
<ol><li>Claus Colloseus wrote in to fix some issues in this post and clarify just how confusing this can be. For example, <code>rotate: 45deg; transform: rotate(-45deg);</code> will do nothing as both of them will apply and effectively cancel each other out. So shouldn&#8217;t <code>translate: 50px 0; rotate: 45deg; transform: translate(-50px, 0) rotate(-45deg);</code> also all cancel out? No, because of the ordering, the end result is like <code>translate(14.6447px, -35.3553px)</code>.</li></ol>
</div></div>
<p><a href="https://danielcwilson.com/blog/2020/02/motion-path-transforms/" title="Direct link to featured article">Direct Link to Article</a> &#8212; <a href="https://css-tricks.com/how-they-fit-together-transform-translate-rotate-scale-and-offset/">Permalink</a></p><p>The post <a rel="nofollow" href="https://css-tricks.com/how-they-fit-together-transform-translate-rotate-scale-and-offset/">How They Fit Together: Transform, Translate, Rotate, Scale, and Offset</a> appeared first on <a rel="nofollow" href="https://css-tricks.com">CSS-Tricks</a>.</p>
]]></content:encoded>
					
		
		
		<post-id xmlns="com-wordpress:feed-additions:1">305639</post-id>	</item>
		<item>
		<title>Weaving a Line Through Text in CSS</title>
		<link>https://css-tricks.com/weaving-a-line-through-text-in-css/</link>
					<comments>https://css-tricks.com/weaving-a-line-through-text-in-css/#comments</comments>
		
		<dc:creator><![CDATA[Ana Tudor]]></dc:creator>
		<pubDate>Wed, 26 Feb 2020 15:04:24 +0000</pubDate>
				<category><![CDATA[Article]]></category>
		<category><![CDATA[CSS]]></category>
		<category><![CDATA[css animation]]></category>
		<category><![CDATA[transform]]></category>
		<guid isPermaLink="false">https://css-tricks.com/?p=303448</guid>

					<description><![CDATA[<p>Earlier this year, I came across <a href="https://codepen.io/FlorinPop17/pen/LYYGMOV">this demo</a> by Florin Pop, which makes a line go either over or under the letters of a single line heading. I thought this was a cool idea, but there were a few little things about the implementation I felt I could simplify and improve at the same time.</p>
<p>First off, the original demo duplicates the headline text, which I knew could be easily avoided. Then there&#8217;s the fact that the length of the &#8230; <a href="https://css-tricks.com/weaving-a-line-through-text-in-css/" class="read-more">Read article <span class="screen-reader-text"> &#8220;Weaving a Line Through Text in CSS&#8221;</span></a></p>
<p>The post <a rel="nofollow" href="https://css-tricks.com/weaving-a-line-through-text-in-css/">Weaving a Line Through Text in CSS</a> appeared first on <a rel="nofollow" href="https://css-tricks.com">CSS-Tricks</a>.</p>
]]></description>
										<content:encoded><![CDATA[
<p>Earlier this year, I came across <a href="https://codepen.io/FlorinPop17/pen/LYYGMOV">this demo</a> by Florin Pop, which makes a line go either over or under the letters of a single line heading. I thought this was a cool idea, but there were a few little things about the implementation I felt I could simplify and improve at the same time.</p>



<span id="more-303448"></span>



<figure class="wp-block-image size-large"><img src="https://i0.wp.com/css-tricks.com/wp-content/uploads/2020/02/interweaving-headline.png?fit=1024%2C324&amp;ssl=1" alt="" class="wp-image-303821"/></figure>



<p>First off, the original demo duplicates the headline text, which I knew could be easily avoided. Then there&#8217;s the fact that the length of the line going through the text is a magic number, which is not a very flexible approach. And finally, can&#8217;t we get rid of the JavaScript?</p>



<p>So let&#8217;s take a look into where I ended up taking this.</p>



<h3 id="structure">HTML structure</h3>



<p>Florin puts the text into a heading element and then duplicates this heading, using <a href="https://splitting.js.org/">Splitting.js</a> to replace the text content of the duplicated heading with spans, each containing one letter of the original text.</p>



<p>Already having decided to do this without text duplication, using a library to split the text into characters and then put each into a <code>span</code> feels a bit like overkill, so we&#8217;re doing it all with an HTML preprocessor.</p>



<pre rel="Pug" class="wp-block-csstricks-code-block language-none" data-line=""><code markup="tt">- let text = 'We Love to Play';
- let arr = text.split('');

h1(role='image' aria-label=text)
  - arr.forEach(letter => {
    span.letter #{letter}
  - });</code></pre>



<p>Since splitting text into multiple elements may not work nicely with screen readers, we&#8217;ve given the whole thing a <code>role</code> of <code>image</code> and an <code>aria-label</code>.</p>



<p>This generates the following HTML:</p>



<pre rel="HTML" class="wp-block-csstricks-code-block language-markup" data-line=""><code markup="tt">&lt;h1 role="image" aria-label="We Love to Play">
  &lt;span class="letter">W&lt;/span>
  &lt;span class="letter">e&lt;/span>
  &lt;span class="letter"> &lt;/span>
  &lt;span class="letter">L&lt;/span>
  &lt;span class="letter">o&lt;/span>
  &lt;span class="letter">v&lt;/span>
  &lt;span class="letter">e&lt;/span>
  &lt;span class="letter"> &lt;/span>
  &lt;span class="letter">t&lt;/span>
  &lt;span class="letter">o&lt;/span>
  &lt;span class="letter"> &lt;/span>
  &lt;span class="letter">P&lt;/span>
  &lt;span class="letter">l&lt;/span>
  &lt;span class="letter">a&lt;/span>
  &lt;span class="letter">y&lt;/span>
&lt;/h1></code></pre>



<h3 id="basic-styles">Basic styles</h3>



<p>We place the heading in the middle of its parent (the <code>body</code> in this case) by using a <code>grid</code> layout:</p>



<pre rel="CSS" class="wp-block-csstricks-code-block language-css" data-line=""><code markup="tt">body {
  display: grid;
  place-content: center;
}</code></pre>



<figure class="wp-block-image"><img src="https://i0.wp.com/css-tricks.com/wp-content/uploads/2020/02/grid_item.png?ssl=1" alt="Screenshot of grid layout lines around the centrally placed heading when inspecting it with Firefox DevTools." data-recalc-dims="1"/><figcaption>The heading doesn&#8217;t stretch across its parent to cover its entire <code>width</code>, but is instead placed in the middle.</figcaption></figure>



<p>We may also add some prettifying touches, like a nice <code>font</code> or a <code>background</code> on the container.</p>



<p>Next, we create the line with an absolutely positioned <code>::after</code> pseudo-element of thickness (<code>height</code>) <code>$h</code>:</p>



<pre rel="SCSS" class="wp-block-csstricks-code-block language-scss" data-line=""><code markup="tt">$h: .125em;
$r: .5*$h;

h1 {
  position: relative;
  
  &amp;::after {
    position: absolute;
    top: calc(50% - #{$r}); right: 0;
    height: $h;
    border-radius: 0 $r $r 0;
    background: crimson;
  }
}</code></pre>



<p>The above code takes care of the positioning and <code>height</code> of the pseudo-element, but what about the <code>width</code>? How do we make it stretch from the left edge of the viewport to the right edge of the heading text?</p>



<h3 id="line-length">Line length</h3>



<p>Well, since we have a <code>grid</code> layout where the heading is middle-aligned horizontally, this means that the vertical midline of the viewport coincides with that of the heading, splitting both into two equal-width halves:</p>



<figure class="wp-block-image"><img src="https://css-tricks.com/wp-content/uploads/2020/02/heading_viewport_split.svg" alt="SVG illustration. Shows how the vertical midline of the viewport coincides with that of the heading and splits both into equal width halves."/><figcaption>The middle-aligned heading.</figcaption></figure>



<p>Consequently, the distance between the left edge of the viewport and the right edge of the heading is half the viewport width (<code>50vw</code>) plus half the heading width, which can be expressed as a <code>%</code> value when used in the computation of its pseudo-element&#8217;s <code>width</code>.</p>



<p>So the <code>width</code> of our <code>::after</code> pseudo-element is:</p>



<pre rel="CSS" class="wp-block-csstricks-code-block language-css" data-line=""><code markup="tt">width: calc(50vw + 50%);</code></pre>



<h3 id="over-and-under">Making the line go over and under</h3>



<p>So far, the result is just a crimson line crossing some black text:</p>



<div class="wp-block-cp-codepen-gutenberg-embed-block cp_embed_wrapper"><iframe id="cp_embed_RwPNxNG" src="//codepen.io/anon/embed/RwPNxNG?height=250&amp;theme-id=1&amp;slug-hash=RwPNxNG&amp;default-tab=result" height="250" scrolling="no" frameborder="0" allowfullscreen allowpaymentrequest name="CodePen Embed RwPNxNG" title="CodePen Embed RwPNxNG" class="cp_embed_iframe" style="width:100%;overflow:hidden">CodePen Embed Fallback</iframe></div>



<p>What we want is for some of the letters to show up on top of the line. In order to get this effect, we give them (or we don&#8217;t give them) a class of <code>.over</code> at random. This means slightly altering the Pug code:</p>



<pre rel="Pug" class="wp-block-csstricks-code-block language-none" data-line=""><code markup="tt">- let text = 'We Love to Play';
- let arr = text.split('');

h1(role='image' aria-label=text)
  - arr.forEach(letter => {
    span.letter(class=Math.random() > .5 ? 'over' : null) #{letter}
  - });</code></pre>



<p>We then relatively position the letters with a class of <code>.over</code> and give them a positive <code>z-index</code>.</p>



<pre rel="CSS" class="wp-block-csstricks-code-block language-css" data-line=""><code markup="tt">.over {
  position: relative;
  z-index: 1;
}</code></pre>



<p class="explanation">My initial idea involved using <code>translatez(1px)</code> instead of <code>z-index: 1</code>, but then it hit me that using <code>z-index</code> has both better  browser support and involves less effort.</p>



<p>The line passes over some letters, but underneath others:</p>



<div class="wp-block-cp-codepen-gutenberg-embed-block cp_embed_wrapper"><iframe id="cp_embed_oNXgpxj" src="//codepen.io/anon/embed/oNXgpxj?height=250&amp;theme-id=1&amp;slug-hash=oNXgpxj&amp;default-tab=result" height="250" scrolling="no" frameborder="0" allowfullscreen allowpaymentrequest name="CodePen Embed oNXgpxj" title="CodePen Embed oNXgpxj" class="cp_embed_iframe" style="width:100%;overflow:hidden">CodePen Embed Fallback</iframe></div>



<h3 id="animation">Animate it!</h3>



<p>Now that we got over the tricky part, we can also add in an <code>animation</code> to make the line enter in. This means having the crimson line shift to the left (in the negative direction of the x-axis, so the sign will be minus) by its full <code>width</code> (<code>100%</code>) at the beginning, only to then allow it to go back to its normal position.</p>



<pre rel="CSS" class="wp-block-csstricks-code-block language-css" data-line=""><code markup="tt">@keyframes slide { 0% { transform: translate(-100%); } }</code></pre>



<p>I opted to have a bit of time to breathe before the start of the <code>animation</code>. This meant adding in the <code>1s</code> delay which, in turn, meant adding the <code>backwards</code> keyword for the <code>animation-fill-mode</code>, so that the line would stay in the state specified by the <code>0%</code> keyframe before the start of the <code>animation</code>:</p>



<pre rel="CSS" class="wp-block-csstricks-code-block language-css" data-line=""><code markup="tt">animation: slide 2s ease-out 1s backwards;</code></pre>



<div class="wp-block-cp-codepen-gutenberg-embed-block cp_embed_wrapper"><iframe id="cp_embed_vYErMKQ" src="//codepen.io/anon/embed/vYErMKQ?height=250&amp;theme-id=1&amp;slug-hash=vYErMKQ&amp;default-tab=result" height="250" scrolling="no" frameborder="0" allowfullscreen allowpaymentrequest name="CodePen Embed vYErMKQ" title="CodePen Embed vYErMKQ" class="cp_embed_iframe" style="width:100%;overflow:hidden">CodePen Embed Fallback</iframe></div>



<h3 id="3d-touch">A 3D touch</h3>



<p>Doing this gave me another idea, which was to make the line go through every single letter, that is, start above the letter, go through it and finish underneath (or the other way around).</p>



<p>This requires real 3D and a few small tweaks.</p>



<p>First off, we set <code>transform-style</code> to <code>preserve-3d</code> on the heading since we want all its children (and pseudo-elements) to a be part of the same 3D assembly, which will make them be ordered and intersect according to how they&#8217;re positioned in 3D.</p>



<p>Next, we want to rotate each letter around its y-axis, with the direction of rotation depending on the presence of the randomly assigned class (whose name we change to <code>.rev</code> from &#8220;reverse&#8221; as &#8220;over&#8221; isn&#8217;t really suggestive of what we&#8217;re doing here anymore).</p>



<p>However, before we do this, we need to remember our span elements are still inline ones at this point and setting a <code>transform</code> on an inline element has absolutely no effect.</p>



<p>To get around this issue, we set <code>display: flex</code> on the heading. However, this creates a new issue and that&#8217;s the fact that span elements that contain only a space (<code>" "</code>) get squished to zero <code>width</code>.</p>



<figure class="wp-block-image"><img src="https://i2.wp.com/css-tricks.com/wp-content/uploads/2020/02/space_flex_item.png?ssl=1" alt="Screenshot showing how the span containing only a space gets squished to zero width when setting `display: flex` on its parent." data-recalc-dims="1"/><figcaption>Inspecting a space only <code>&lt;span&gt;</code> in Firefox DevTools.</figcaption></figure>



<p>A simple fix for this is to set <code>white-space: pre</code> on our <code>.letter</code> spans.</p>



<p>Once we&#8217;ve done this, we can rotate our spans by an angle <code>$a</code>&#8230; in one direction or the other!</p>



<pre rel="SCSS" class="wp-block-csstricks-code-block language-scss" data-line=""><code markup="tt">$a: 2deg;

.letter {
  white-space: pre;
  transform: rotatey($a);
}

.rev { transform: rotatey(-$a); }</code></pre>



<p>Since rotation around the y-axis squishes our letters horizontally, we can scale them along the x-axis by a factor (<code>$f</code>) that&#8217;s the inverse of the cosine of <code>$a</code>.</p>



<pre rel="SCSS" class="wp-block-csstricks-code-block language-scss" data-line=""><code markup="tt">$a: 2deg;
$f: 1/cos($a)

.letter {
  white-space: pre;
  transform: rotatey($a) scalex($f)
}

.rev { transform: rotatey(-$a) scalex($f) }</code></pre>



<p class="explanation">If you wish to understand the why behind using this particular scaling factor, you can check out this older <a href="https://css-tricks.com/solving-last-item-problem-circular-distribution-partially-overlapping-items/">article</a> where I explain it all in detail.</p>



<p>And that&#8217;s it! We now have the 3D result we&#8217;ve been after! Do note however that the font used here was chosen so that our result looks good and another font may not work as well.</p>



<div class="wp-block-cp-codepen-gutenberg-embed-block cp_embed_wrapper"><iframe id="cp_embed_KKpwmEg" src="//codepen.io/anon/embed/KKpwmEg?height=350&amp;theme-id=1&amp;slug-hash=KKpwmEg&amp;default-tab=result" height="350" scrolling="no" frameborder="0" allowfullscreen allowpaymentrequest name="CodePen Embed KKpwmEg" title="CodePen Embed KKpwmEg" class="cp_embed_iframe" style="width:100%;overflow:hidden">CodePen Embed Fallback</iframe></div>
<p>The post <a rel="nofollow" href="https://css-tricks.com/weaving-a-line-through-text-in-css/">Weaving a Line Through Text in CSS</a> appeared first on <a rel="nofollow" href="https://css-tricks.com">CSS-Tricks</a>.</p>
]]></content:encoded>
					
					<wfw:commentRss>https://css-tricks.com/weaving-a-line-through-text-in-css/feed/</wfw:commentRss>
			<slash:comments>10</slash:comments>
		
		
		<post-id xmlns="com-wordpress:feed-additions:1">303448</post-id>	</item>
		<item>
		<title>Various Methods for Expanding a Box While Preserving the Border Radius</title>
		<link>https://css-tricks.com/various-methods-for-expanding-a-box-while-preserving-the-border-radius/</link>
					<comments>https://css-tricks.com/various-methods-for-expanding-a-box-while-preserving-the-border-radius/#comments</comments>
		
		<dc:creator><![CDATA[Ana Tudor]]></dc:creator>
		<pubDate>Fri, 06 Sep 2019 14:19:05 +0000</pubDate>
				<category><![CDATA[Article]]></category>
		<category><![CDATA[animation]]></category>
		<category><![CDATA[clip-path]]></category>
		<category><![CDATA[CSS]]></category>
		<category><![CDATA[scaling]]></category>
		<category><![CDATA[transform]]></category>
		<category><![CDATA[transition]]></category>
		<guid isPermaLink="false">http://css-tricks.com/?p=292177</guid>

					<description><![CDATA[<p>﻿I&#8217;ve recently noticed an interesting change on CodePen: on hovering the pens on the homepage, there&#8217;s a rectangle with rounded corners expanding in the back.</p>
</p>
<p>Expanding box effect on the CodePen homepage.</p>
<p>Being the curious creature that I am, I had to check how this works! Turns out, the rectangle in the back is an absolutely positioned <code>::after</code> pseudo-element.</p>
<p>Initial <code>::after</code> styles. A positive offset goes inwards from the parent&#8217;s <code>padding</code> limit, while a negative one goes outwards.</p>
<p>On <code>:hover</code>&#8230; <a href="https://css-tricks.com/various-methods-for-expanding-a-box-while-preserving-the-border-radius/" class="read-more">Read article <span class="screen-reader-text"> &#8220;Various Methods for Expanding a Box While Preserving the Border Radius&#8221;</span></a></p>
<p>The post <a rel="nofollow" href="https://css-tricks.com/various-methods-for-expanding-a-box-while-preserving-the-border-radius/">Various Methods for Expanding a Box While Preserving the Border Radius</a> appeared first on <a rel="nofollow" href="https://css-tricks.com">CSS-Tricks</a>.</p>
]]></description>
										<content:encoded><![CDATA[<p>﻿I&#8217;ve recently noticed an interesting change on CodePen: on hovering the pens on the homepage, there&#8217;s a rectangle with rounded corners expanding in the back.</p>
<p><span id="more-292177"></span></p>
<figure><img src="https://i0.wp.com/css-tricks.com/wp-content/uploads/2019/06/cprec.gif?ssl=1" alt="Animated gif recording the CodePen expanding box effect on hover." data-recalc-dims="1"/><figcaption>Expanding box effect on the CodePen homepage.</figcaption></figure>
<p>Being the curious creature that I am, I had to check how this works! Turns out, the rectangle in the back is an absolutely positioned <code>::after</code> pseudo-element.</p>
<figure><img src="https://i0.wp.com/css-tricks.com/wp-content/uploads/2019/06/after_ini.png?ssl=1" alt="Collage. On the left side, there is a DevTools screenshot showing the initial styles applied on the ::after pseudo-element. The relevant ones are those making it absolutely positioned with an offset of 1rem from the top and left and with an offset of -1rem from the right and bottom. On the right side, we have an illustration of these styles, showing the parent element box, the ::after box and the offsets between their edges." data-recalc-dims="1"/><figcaption>Initial <code>::after</code> styles. A positive offset goes inwards from the parent&#8217;s <code>padding</code> limit, while a negative one goes outwards.</figcaption></figure>
<p>On <code>:hover</code>, its offsets are overridden and, combined with the <code>transition</code>, we get the expanding box effect.</p>
<figure><img src="https://i1.wp.com/css-tricks.com/wp-content/uploads/2019/06/after_hov.png?ssl=1" alt="Collage. On the left side, there is a DevTools screenshot showing the :hover styles applied on the ::after pseudo-element. These are all offsets overriding the initial ones and making the boundary of the ::after shift outwards by 2rem in all directions except the right. On the right side, we have an illustration of these styles, showing the parent element box, the ::after box and the offsets between their edges." data-recalc-dims="1"/><figcaption>The <code>::after</code> styles on <code>:hover</code>.</figcaption></figure>
<p>The <code>right</code> property has the same value (<code>-1rem</code>) in both the initial and the <code>:hover</code> rule sets, so it&#8217;s unnecessary to override it, but all the other offsets move by <code>2rem</code> outwards (from <code>1rem</code> to <code>-1rem</code> for the <code>top</code> and <code>left</code> offsets and from <code>-1rem</code> to <code>-3rem</code> for the <code>bottom</code> offset)</p>
<p>One thing to notice here is that the <code>::after</code> pseudo-element has a <code>border-radius</code> of <code>10px</code> which gets preserved as it expands. Which got me to think about what methods we have for expanding/shrinking (pseudo-) elements while preserving their <code>border-radius</code>. How many can you think of? Let me know if you have ideas that haven&#8217;t been included below, where we take a look at a bunch of options and see which is best suited for what situation.</p>
<h3 id="change-offsets">Changing offsets</h3>
<p>This is the method used on CodePen and it works really well in this particular situation for a bunch of reasons. First off, it has great support. It also works when the expanding (pseudo-) element is responsive, with no fixed dimensions and, at the same time, the amount by which it expands is fixed (a <code>rem</code> value). It also works for expanding in more than two directions (<code>top</code>, <code>bottom</code> and <code>left</code> in this particular case).</p>
<p>There are however a couple of caveats we need to be aware of.</p>
<p>First, our expanding element cannot have <code>position: static</code>. This is not a problem in the context of the CodePen use case since the <code>::after</code> pseudo-element needs to be absolutely positioned anyway in order to be placed underneath the rest of this parent&#8217;s content.</p>
<p>Second, going overboard with offset animations (as well as, in general, animating any property that affects layout with box properties the way offsets, margins, border widths, paddings or dimensions do) can negatively impact performance. Again, this is not something of concern here, we only have a little <code>transition</code> on <code>:hover</code>, no big deal.</p>
<h3 id="change-size">Changing dimensions</h3>
<p>Instead of changing offsets, we could change dimensions instead. However, this is a method that works if we want our (pseudo-) element to expand in, at most, two directions. Otherwise, we need to change offsets as well. In order to better understand this, let&#8217;s consider the CodePen situation where we want our <code>::after</code> pseudo-elements to expand in three directions (<code>top</code>, <code>bottom</code> and <code>left</code>).</p>
<p>The relevant initial sizing info is the following:</p>
<pre rel="CSS"><code class="language-css">.single-item::after {
  top: 1rem;
  right: -1rem;
  bottom: -1rem;
  left: 1rem;
}</code></pre>
<p>Since opposing offsets (the <code>top</code>&#8211;<code>bottom</code> and <code>left</code>&#8211;<code>right</code> pairs) cancel each other (<code>1rem - 1rem = 0</code>), it results that the pseudo-element&#8217;s dimensions are equal to those of its parent (or <code>100%</code> of the parent&#8217;s dimensions).</p>
<p>So we can re-write the above as:</p>
<pre rel="CSS"><code class="language-css">.single-item::after {
  top: 1rem;
  right: -1rem;
  width: 100%;
  height: 100%;
}</code></pre>
<p>On <code>:hover</code>, we increase the <code>width</code> by <code>2rem</code> to the <code>left</code> and the <code>height</code> by <code>4rem</code>, <code>2rem</code> to the <code>top</code> and <code>2rem</code> to the <code>bottom</code>. However, just writing:</p>
<pre rel="CSS"><code class="language-css">.single-item::after {
  width: calc(100% + 2rem);
  height: calc(100% + 4rem);
}</code></pre>
<p>&#8230;is not enough, as this makes the <code>height</code> increase the downward direction by <code>4rem</code> instead of increasing it by <code>2rem</code> up and <code>2rem</code> down. The following demo illustrates this (put <code>:focus</code> on or hover over the items to see how the <code>::after</code> pseudo-element expands):</p>
<p data-height="350" style="height: 350px; display: flex; align-items: center; justify-content: center; border: 2px solid black; margin: 1rem 0; padding: 1rem; overflow: auto;" data-theme-id="1" data-slug-hash="orEgaQ" data-default-tab="result" data-user="thebabydino" data-embed-version="2" data-pen-title="Expanding rounded rect #0: dimensions issue" class="codepen">See the <a href="http://codepen.io/thebabydino/pen/orEgaQ/">Pen</a> by thebabydino (<a href="http://codepen.io/thebabydino">@thebabydino</a>) on <a href="http://codepen.io">CodePen</a>.</p>
<p>We&#8217;d need to update the <code>top</code> property as well in order to get the desired effect:</p>
<pre rel="CSS"><code class="language-css">.single-item::after {
  top: -1rem;
  width: calc(100% + 2rem);
  height: calc(100% + 4rem);
}</code></pre>
<p>Which works, as it can be seen below:</p>
<p data-height="350" style="height: 350px; display: flex; align-items: center; justify-content: center; border: 2px solid black; margin: 1rem 0; padding: 1rem; overflow: auto;" data-theme-id="1" data-slug-hash="WqMbBG" data-default-tab="result" data-user="thebabydino" data-embed-version="2" data-pen-title="Expanding rounded rect #1: dimensions fix" class="codepen">See the <a href="http://codepen.io/thebabydino/pen/WqMbBG/">Pen</a> by thebabydino (<a href="http://codepen.io/thebabydino">@thebabydino</a>) on <a href="http://codepen.io">CodePen</a>.</p>
<p>But, to be honest, this feels less desirable than changing offsets alone.</p>
<p>However, changing dimensions is a good solution in a different kind of situation, like when we want to have some bars with rounded corners that expand/shrink in a single direction.</p>
<p data-height="390" style="height: 390px; display: flex; align-items: center; justify-content: center; border: 2px solid black; margin: 1rem 0; padding: 1rem; overflow: auto;" data-theme-id="1" data-slug-hash="pXajMv" data-default-tab="result" data-user="thebabydino" data-embed-version="2" data-pen-title="EQ-like thingie" class="codepen">See the <a href="http://codepen.io/thebabydino/pen/pXajMv/">Pen</a> by thebabydino (<a href="http://codepen.io/thebabydino">@thebabydino</a>) on <a href="http://codepen.io">CodePen</a>.</p>
<p class="explanation">Note that, <em>if we didn&#8217;t have rounded corners to preserve</em>, the better solution would be to use directional scaling via the <code>transform</code> property.</p>
<h3 id="change-padding-border">Changing padding/border-width</h3>
<p>Similar to changing the dimensions, we can change the <code>padding</code> or <code>border-width</code> (for a <code>border</code> that&#8217;s <code>transparent</code>). Note that, just like with changing the dimensions, we need to also update offsets if expanding the box in more than two dimensions:</p>
<p data-height="715" style="height: 715px; display: flex; align-items: center; justify-content: center; border: 2px solid black; margin: 1rem 0; padding: 1rem; overflow: auto;" data-theme-id="1" data-slug-hash="mZXPEy" data-default-tab="result" data-user="thebabydino" data-embed-version="2" data-pen-title="Expanding rounded rect #2: padding/ border-width option" class="codepen">See the <a href="http://codepen.io/thebabydino/pen/mZXPEy/">Pen</a> by thebabydino (<a href="http://codepen.io/thebabydino">@thebabydino</a>) on <a href="http://codepen.io">CodePen</a>.</p>
<p>In the demo above, the pinkish box represents the <code>content-box</code> of the <code>::after</code> pseudo-element and you can see it stays the same size, which is important for this approach.</p>
<p>In order to understand why it is important, consider this other limitation: we also need to have the box dimensions defined by two offsets plus the <code>width</code> and the <code>height</code> instead of using all four offsets. This is because the <code>padding</code>/ <code>border-width</code> would only grow inwards if we were to use four offsets rather than two plus the <code>width</code> and the <code>height</code>.</p>
<p data-height="700" style="height: 700px; display: flex; align-items: center; justify-content: center; border: 2px solid black; margin: 1rem 0; padding: 1rem; overflow: auto;" data-theme-id="1" data-slug-hash="rNBJZvV" data-default-tab="result" data-user="thebabydino" data-embed-version="2" data-pen-title="Expanding rounded rect #3: size setting issue with padding/ border-width" class="codepen">See the <a href="http://codepen.io/thebabydino/pen/rNBJZvV/">Pen</a> by thebabydino (<a href="http://codepen.io/thebabydino">@thebabydino</a>) on <a href="http://codepen.io">CodePen</a>.</p>
<p>For the same reason, we cannot have <code>box-sizing: border-box</code> on our <code>::after</code> pseudo-element.</p>
<p data-height="650" style="height: 650px; display: flex; align-items: center; justify-content: center; border: 2px solid black; margin: 1rem 0; padding: 1rem; overflow: auto;" data-theme-id="1" data-slug-hash="MMQeeR" data-default-tab="result" data-user="thebabydino" data-embed-version="2" data-pen-title="Expanding rounded rect #4: box-sizing issue with padding/ border-width" class="codepen">See the <a href="http://codepen.io/thebabydino/pen/MMQeeR/">Pen</a> by thebabydino (<a href="http://codepen.io/thebabydino">@thebabydino</a>) on <a href="http://codepen.io">CodePen</a>.</p>
<p>In spite of these limitations, this method can come in handy if our expanding (pseudo-) element has text content we don&#8217;t want to see moving around on <code>:hover</code> as illustrated by the Pen below, where the first two examples change offsets/ dimensions, while the last two change paddings/ border widths:</p>
<p data-height="650" style="height: 650px; display: flex; align-items: center; justify-content: center; border: 2px solid black; margin: 1rem 0; padding: 1rem; overflow: auto;" data-theme-id="1" data-slug-hash="OeQXxZ" data-default-tab="result" data-user="thebabydino" data-embed-version="2" data-pen-title="Expanding rounded rect #5: text moving around method comparison" class="codepen">See the <a href="http://codepen.io/thebabydino/pen/OeQXxZ/">Pen</a> by thebabydino (<a href="http://codepen.io/thebabydino">@thebabydino</a>) on <a href="http://codepen.io">CodePen</a>.</p>
<h3 id="change-margin">Changing margin</h3>
<p>Using this method, we first set the offsets to the <code>:hover</code> state values and a <code>margin</code> to compensate and give us the initial state sizing:</p>
<pre rel="CSS"><code class="language-css">.single-item::after {
  top: -1rem;
  right: -1rem;
  bottom: -3rem;
  left: -1rem;
  margin: 2rem 0 2rem 2rem;
}</code></pre>
<p>Then we zero this <code>margin</code> on <code>:hover</code>:</p>
<pre rel="CSS"><code class="language-css">.single-item:hover::after { margin: 0 }</code></pre>
<p data-height="325" style="height: 325px; display: flex; align-items: center; justify-content: center; border: 2px solid black; margin: 1rem 0; padding: 1rem; overflow: auto;" data-theme-id="1" data-slug-hash="rEJMaM" data-default-tab="result" data-user="thebabydino" data-embed-version="2" data-pen-title="Expanding rounded rect #6: margin method" class="codepen">See the <a href="http://codepen.io/thebabydino/pen/rEJMaM/">Pen</a> by thebabydino (<a href="http://codepen.io/thebabydino">@thebabydino</a>) on <a href="http://codepen.io">CodePen</a>.</p>
<p>This is another approach that works great for the CodePen situation, though I cannot really think of other use cases. Also note that, just like changing offsets or dimensions, this method affects the size of the <code>content-box</code>, so any text content we may have gets moved and rearranged.</p>
<h3 id="change-font-size">Changing font size</h3>
<p>This is probably the trickiest one of all and has lots of limitations, the most important of which being we cannot have text content on the actual (pseudo-) element that expands/shrinks &mdash; but it&#8217;s another method that would work well in the CodePen case.</p>
<p>Also, <code>font-size</code> on its own doesn&#8217;t really do anything to make a box expand or shrink. We need to combine it with one of the previously discussed properties.</p>
<p>For example, we can set the <code>font-size</code> on <code>::after</code> to be equal to <code>1rem</code>, set the offsets to the expanded case and set <code>em</code> margins that would correspond to the difference between the expanded and the initial state. </p>
<pre rel="CSS"><code class="language-css">.single-item::after {
  top: -1rem;
  right: -1rem;
  bottom: -3rem;
  left: -1rem;
  margin: 2em 0 2em 2em;
  font-size: 1rem;
}</code></pre>
<p>Then, on <code>:hover</code>, we bring the <code>font-size</code> to <code>0</code>:</p>
<pre rel="CSS"><code class="language-css">.single-item:hover::after { font-size: 0 }</code></pre>
<p data-height="325" style="height: 325px; display: flex; align-items: center; justify-content: center; border: 2px solid black; margin: 1rem 0; padding: 1rem; overflow: auto;" data-theme-id="1" data-slug-hash="BgYWWe" data-default-tab="result" data-user="thebabydino" data-embed-version="2" data-pen-title="Expanding rounded rect #7: font-size + margin method" class="codepen">See the <a href="http://codepen.io/thebabydino/pen/BgYWWe/">Pen</a> by thebabydino (<a href="http://codepen.io/thebabydino">@thebabydino</a>) on <a href="http://codepen.io">CodePen</a>.</p>
<p>We can also use <code>font-size</code> with offsets, though it gets a bit more complicated:</p>
<pre rel="CSS"><code class="language-css">.single-item::after {
  top: calc(2em - 1rem);
  right: -1rem;
  bottom: calc(2em - 3rem);
  left: calc(2em - 1rem);
  font-size: 1rem;
}

.single-item:hover::after { font-size: 0 }</code></pre>
<p>Still, what&#8217;s important is that it works, as it can be seen below:</p>
<p data-height="325" style="height: 325px; display: flex; align-items: center; justify-content: center; border: 2px solid black; margin: 1rem 0; padding: 1rem; overflow: auto;" data-theme-id="1" data-slug-hash="ewVvMW" data-default-tab="result" data-user="thebabydino" data-embed-version="2" data-pen-title="Expanding rounded rect #8: font-size + offsets method" class="codepen">See the <a href="http://codepen.io/thebabydino/pen/ewVvMW/">Pen</a> by thebabydino (<a href="http://codepen.io/thebabydino">@thebabydino</a>) on <a href="http://codepen.io">CodePen</a>.</p>
<p>Combining <code>font-size</code> with dimensions is even hairier, as we also need to change the vertical offset value on <code>:hover</code> on top of everything:</p>
<pre rel="CSS"><code class="language-css">.single-item::after {
  top: 1rem;
  right: -1rem;
  width: calc(100% + 2em);
  height: calc(100% + 4em);
  font-size: 0;
}

.single-item:hover::after {
  top: -1rem;
  font-size: 1rem
}</code></pre>
<p>Oh, well, at least it works:</p>
<p data-height="325" style="height: 325px; display: flex; align-items: center; justify-content: center; border: 2px solid black; margin: 1rem 0; padding: 1rem; overflow: auto;" data-theme-id="1" data-slug-hash="gNvmQV" data-default-tab="result" data-user="thebabydino" data-embed-version="2" data-pen-title="Expanding rounded rect #9: font-size + dimensions method" class="codepen">See the <a href="http://codepen.io/thebabydino/pen/gNvmQV/">Pen</a> by thebabydino (<a href="http://codepen.io/thebabydino">@thebabydino</a>) on <a href="http://codepen.io">CodePen</a>.</p>
<p>Same thing goes for using <code>font-size</code> with <code>padding</code>/<code>border-width</code>:</p>
<pre rel="CSS"><code class="language-css">.single-item::after {
  top: 1rem;
  right: -1rem;
  width: 100%;
  height: 100%;
  font-size: 0;
}

.single-item:nth-child(1)::after {
  padding: 2em 0 2em 2em;
}

.single-item:nth-child(2)::after {
  border: solid 0 transparent;
  border-width: 2em 0 2em 2em;
}

.single-item:hover::after {
  top: -1rem;
  font-size: 1rem;
}</code></pre>
<p data-height="325" style="height: 325px; display: flex; align-items: center; justify-content: center; border: 2px solid black; margin: 1rem 0; padding: 1rem; overflow: auto;" data-theme-id="1" data-slug-hash="YoeZMg" data-default-tab="result" data-user="thebabydino" data-embed-version="2" data-pen-title="Expanding rounded rect #10: font-size + padding/ border method" class="codepen">See the <a href="http://codepen.io/thebabydino/pen/YoeZMg/">Pen</a> by thebabydino (<a href="http://codepen.io/thebabydino">@thebabydino</a>) on <a href="http://codepen.io">CodePen</a>.</p>
<h3 id="change-scale">Changing scale</h3>
<p>If you&#8217;ve read pieces on <code>animation</code> performance, then you&#8217;ve probably read it&#8217;s better to animate transforms instead of properties that impact layout, like offsets, margins, borders, paddings, dimensions &mdash; pretty much what we&#8217;ve used so far!</p>
<p>The first issue that stands out here is that scaling an element also scales its corner rounding, as illustrated below:</p>
<p data-height="650" style="height: 650px; display: flex; align-items: center; justify-content: center; border: 2px solid black; margin: 1rem 0; padding: 1rem; overflow: auto;" data-theme-id="1" data-slug-hash="VJQMmJ" data-default-tab="result" data-user="thebabydino" data-embed-version="2" data-pen-title="Scaling affects border-radius" class="codepen">See the <a href="http://codepen.io/thebabydino/pen/VJQMmJ/">Pen</a> by thebabydino (<a href="http://codepen.io/thebabydino">@thebabydino</a>) on <a href="http://codepen.io">CodePen</a>.</p>
<p>We can get around this by also scaling the <code>border-radius</code> the other way.</p>
<p>Let&#8217;s say we scale an element by a factor <code>$fx</code> along the <var>x</var> axis and by a factor <code>$fy</code> along the <var>y</var> axis and we want to keep its <code>border-radius</code> at a constant value <code>$r</code>.</p>
<p>This means we also need to divide <code>$r</code> by the corresponding scaling factor along each axis.</p>
<pre rel="SCSS"><code class="language-scss">border-radius: #{$r/$fx}/ #{$r/$fy};
transform: scale($fx, $fy)</code></pre>
<p data-height="650" style="height: 650px; display: flex; align-items: center; justify-content: center; border: 2px solid black; margin: 1rem 0; padding: 1rem; overflow: auto;" data-theme-id="1" data-slug-hash="wLyPZR" data-default-tab="result" data-user="thebabydino" data-embed-version="2" data-pen-title="Scaling affects border-radius - fix" class="codepen">See the <a href="http://codepen.io/thebabydino/pen/wLyPZR/">Pen</a> by thebabydino (<a href="http://codepen.io/thebabydino">@thebabydino</a>) on <a href="http://codepen.io">CodePen</a>.</p>
<p>However, note that with this method, we need to use scaling factors, not amounts by which we expand our (pseudo-) element in this or that direction. Getting the scaling factors from the dimensions and expansion amounts is possible, but <em>only if</em> they&#8217;re expressed in units that have a certain fixed relation between them. While preprocessors can mix units like <code>in</code> or <code>px</code> due to the fact that <code>1in</code> is always <code>96px</code>, they cannot resolve how much <code>1em</code> or <code>1%</code> or <code>1vmin</code> or <code>1ch</code> is in <code>px</code> as they lack context. And <code>calc()</code> is not a solution either, as it doesn&#8217;t allow us to divide a length value by another length value to get a unitless scale factor.</p>
<p>This is why scaling is not a solution in the CodePen case, where the <code>::after</code> boxes have dimensions that depend on the viewport and, at the same time, expand by fixed <code>rem</code> amounts.</p>
<p>But if our scale amount is given or we can easily compute it, this is an option to consider, especially since making the scaling factors custom properties we then animate with a bit of Houdini magic can greatly simplify our code.</p>
<pre rel="SCSS"><code class="language-scss">border-radius: calc(#{$r}/var(--fx))/ calc(#{$r}/var(--fy));
transform: scale(var(--fx), var(--fy))</code></pre>
<p class="explanation">Note that Houdini only works in Chromium browsers with the <strong>Experimental Web Platform features</strong> flag enabled.</p>
<p>For example, we can create this tile grid animation:</p>
<figure>
  <video controls loop src="https://res.cloudinary.com/css-tricks/video/upload/f_auto,q_auto/v1562367520/loader_tiles_dtufsq.mp4" aria-label="Animated gif. Shows each square tile of a grid shrinking horizontally to a bar, the vertically do a dot, the expanding horizontally to a bar and then vertically back to the initial square. This animation is delayed diagonally."></video><figcaption>Looping tile grid animation (<a href="https://codepen.io/thebabydino/pen/qzxpJK">Demo</a>, Chrome with flag only)</figcaption></figure>
<p>The square tiles have an edge length <code>$l</code> and with a corner rounding of <code>$k*$l</code>:</p>
<pre rel="SCSS"><code class="language-scss">.tile {
  width: $l;
  height: $l;
  border-radius: calc(#{$r}/var(--fx))/ calc(#{$r}/var(--fy));
  transform: scale(var(--fx), var(--fy))
}</code></pre>
<p>We register our two custom properties:</p>
<pre rel="JavaScript"><code class="language-javascript">CSS.registerProperty({
  name: '--fx', 
  syntax: '&lt;number&gt;', 
  initialValue: 1, 
  inherits: false
});

CSS.registerProperty({
  name: '--fy', 
  syntax: '&lt;number&gt;', 
  initialValue: 1, 
  inherits: false
});</code></pre>
<p>And we can then animate them:</p>
<pre rel="SCSS"><code class="language-scss">.tile {
  /* same as before */
  animation: a $t infinite ease-in alternate;
  animation-name: fx, fy;
}

@keyframes fx {
  0%, 35% { --fx: 1 }
  50%, 100% { --fx: #{2*$k} }
}

@keyframes fy {
  0%, 35% { --fy: 1 }
  50%, 100% { --fy: #{2*$k} }
}</code></pre>
<p>Finally, we add in a delay depending on the horizontal (<code>--i</code>) and vertical (<code>--j</code>) grid indices in order to create a staggered <code>animation</code> effect:</p>
<pre rel="SCSS"><code class="language-scss">animation-delay: 
  calc((var(--i) + var(--m) - var(--j))*#{$t}/(2*var(--m)) - #{$t}), 
  calc((var(--i) + var(--m) - var(--j))*#{$t}/(2*var(--m)) - #{1.5*$t})</code></pre>
<p>Another example is the following one, where the dots are created with the help of pseudo-elements:</p>
<figure>
  <video controls loop src="https://res.cloudinary.com/css-tricks/video/upload/f_auto,q_auto/v1562367521/loader_spikes_qj2vfi.mp4" aria-label="Animated gif. Shows spikes distributed on a circle shrinking/ expanding along their length, with the dots at their ends moving along."></video><figcaption>Looping spikes animation (<a href="https://codepen.io/thebabydino/pen/mgvPzp">Demo</a>, Chrome with flag only)</figcaption></figure>
<p>Since pseudo-elements get scaled together with their parents, we need to also reverse the scaling transform on them:</p>
<pre rel="SCSS"><code class="language-scss">.spike {
  /* other spike styles */
  transform: var(--position) scalex(var(--fx));

  &amp;::before, &amp;::after {
    /* other pseudo styles */
    transform: scalex(calc(1/var(--fx)));
  }
}</code></pre>
<h3 id="change-clip-path">Changing&#8230; clip-path?!</h3>
<p>This is a method I really like, even though it cuts out pre-Chromium Edge and Internet Explorer support.</p>
<p>Pretty much every usage example of <code>clip-path</code> out there has either a <code>polygon()</code> value or an SVG reference value. However, if you&#8217;ve seen some of my previous articles, then you probably know there are other basic shapes we can use, like <code>inset()</code>, which works as illustrated below:</p>
<figure>
  <img src="https://css-tricks.com/wp-content/uploads/2018/11/inset.svg" alt="Illustration showing what the four values of the inset() function represent. The first one is the offset of the top edge of the clipping rectangle with respect to the top edge of the border-box. The second one is the offset of the right edge of the clipping rectangle with respect to the right edge of the border-box. The third one is the offset of the bottom edge of the clipping rectangle with respect to the bottom edge of the border-box. The fourth one is the offset of the left edge of the clipping rectangle with respect to the left edge of the border-box."/><figcaption>How the <code>inset()</code> function works. (<a href="https://codepen.io/thebabydino/pen/PxzOWO/">Demo</a>)</figcaption></figure>
<p>So, in order to reproduce the CodePen effect with this method, we set the <code>::after</code> offsets to the expanded state values and then <a href="https://codepen.io/thebabydino/pen/NZzWjg">cut out</a> what we don&#8217;t want to see with the help of <code>clip-path</code>:</p>
<pre rel="CSS"><code class="language-css">.single-item::after {
  top: -1rem;
  right: -1rem;
  bottom: -3em;
  left: -1em;
  clip-path: inset(2rem 0 2rem 2rem)
}</code></pre>
<p>And then, in the <code>:hover</code> state, we zero all insets:</p>
<pre rel="CSS"><code class="language-css">.single-item:hover::after {
  clip-path: inset(0)
}</code></pre>
<p>This can be seen in action below:</p>
<p data-height="325" style="height: 325px; display: flex; align-items: center; justify-content: center; border: 2px solid black; margin: 1rem 0; padding: 1rem; overflow: auto;" data-theme-id="1" data-slug-hash="mZKdzO" data-default-tab="result" data-user="thebabydino" data-embed-version="2" data-pen-title="Expanding rounded rect #12: clip-path basic effect" class="codepen">See the <a href="http://codepen.io/thebabydino/pen/mZKdzO/">Pen</a> by thebabydino (<a href="http://codepen.io/thebabydino">@thebabydino</a>) on <a href="http://codepen.io">CodePen</a>.</p>
<p>Alright, this works, but we also need a corner rounding. Fortunately, <code>inset()</code> lets us specify that too as whatever <code>border-radius</code> value we may wish.</p>
<p>Here, a <code>10px</code> one for all corners along both directions does it:</p>
<pre rel="CSS"><code class="language-css">.single-item::after {
  /* same styles as before */
  clip-path: inset(2rem 0 2rem 2rem round 10px)
}

.single-item:hover::after {
  clip-path: inset(0 round 10px)
}</code></pre>
<p>And this gives us exactly what we were going for:</p>
<p data-height="325" style="height: 325px; display: flex; align-items: center; justify-content: center; border: 2px solid black; margin: 1rem 0; padding: 1rem; overflow: auto;" data-theme-id="1" data-slug-hash="xozGRP" data-default-tab="result" data-user="thebabydino" data-embed-version="2" data-pen-title="Expanding rounded rect #13: clip-path with rounding" class="codepen">See the <a href="http://codepen.io/thebabydino/pen/xozGRP/">Pen</a> by thebabydino (<a href="http://codepen.io/thebabydino">@thebabydino</a>) on <a href="http://codepen.io">CodePen</a>.</p>
<p>Furthermore, it doesn&#8217;t really break anything in non-supporting browsers, it just always stays in the expanded state.</p>
<p>However, while this is method that works great for a lot of situations &mdash; including the CodePen use case &mdash; it doesn&#8217;t work when our expanding/shrinking elements have descendants that go outside their clipped parent&#8217;s <code>border-box</code>, as it is the case for the last example given with the previously discussed scaling method.</p>
<p>The post <a rel="nofollow" href="https://css-tricks.com/various-methods-for-expanding-a-box-while-preserving-the-border-radius/">Various Methods for Expanding a Box While Preserving the Border Radius</a> appeared first on <a rel="nofollow" href="https://css-tricks.com">CSS-Tricks</a>.</p>
]]></content:encoded>
					
					<wfw:commentRss>https://css-tricks.com/various-methods-for-expanding-a-box-while-preserving-the-border-radius/feed/</wfw:commentRss>
			<slash:comments>3</slash:comments>
		
		<enclosure url="https://res.cloudinary.com/css-tricks/video/upload/f_auto,q_auto/v1562367520/loader_tiles_dtufsq.mp4" length="56085" type="video/mp4" />
<enclosure url="https://res.cloudinary.com/css-tricks/video/upload/f_auto,q_auto/v1562367521/loader_spikes_qj2vfi.mp4" length="377332" type="video/mp4" />

		<post-id xmlns="com-wordpress:feed-additions:1">292177</post-id>	</item>
		<item>
		<title>Iron Man’s Arc Reactor Using CSS3 Transforms and Animations</title>
		<link>https://css-tricks.com/iron-mans-arc-reactor-using-css3-transforms-and-animations/</link>
					<comments>https://css-tricks.com/iron-mans-arc-reactor-using-css3-transforms-and-animations/#comments</comments>
		
		<dc:creator><![CDATA[Kunal Sarkar]]></dc:creator>
		<pubDate>Mon, 02 Apr 2018 13:29:43 +0000</pubDate>
				<category><![CDATA[Article]]></category>
		<category><![CDATA[animation]]></category>
		<category><![CDATA[transform]]></category>
		<guid isPermaLink="false">http://css-tricks.com/?p=268736</guid>

					<description><![CDATA[<p>Alright Iron Man fans, fire up your code editors! We are going to make the Arc Reactor from Iron Man’s suit in CSS. We'll walk through every step so you can see exactly makes what happen.</p>
<p>The post <a rel="nofollow" href="https://css-tricks.com/iron-mans-arc-reactor-using-css3-transforms-and-animations/">Iron Man’s Arc Reactor Using CSS3 Transforms and Animations</a> appeared first on <a rel="nofollow" href="https://css-tricks.com">CSS-Tricks</a>.</p>
]]></description>
										<content:encoded><![CDATA[<p>Alright Iron Man fans, fire up your code editors! We are going to make the Arc reactor from Iron Man’s suit in CSS. Here’s what the end result will look like:</p>
<p data-height="400" style="height: 400px; display: flex; align-items: center; justify-content: center; border: 2px solid black; margin: 1rem 0; padding: 1rem; overflow: auto;" data-theme-id="1" data-slug-hash="QmLEWN" data-default-tab="result" data-user="supersarkar" data-embed-version="2" data-pen-title="Iron Man's Arc Reactor" class="codepen">See the Pen <a href="https://codepen.io/supersarkar/pen/QmLEWN/">Iron Man&#8217;s Arc Reactor</a> by Kunal Sarkar (<a href="https://codepen.io/supersarkar">@supersarkar</a>) on <a href="https://codepen.io">CodePen</a>.</p>
<p><span id="more-268736"></span></p>
<h3>The Full Page Wrapper</h3>
<p>We will make our Arc reactor on a dark full-page background. Here’s our code to make a full page wrapper element:</p>
<pre rel="CSS"><code>body {
  margin: 0;
}

.fullpage-wrapper {
  height: 100vh;
  background: radial-gradient(#353c44, #222931);
}</code></pre>
<p>Why do we declare no margin on the body? The <code>&lt;body&gt;</code> element has some margin set to it by default in the user agent stylesheet. This prevents the elements inside the <code>&lt;body&gt;</code> to touch the edges of the screen. Since we want our wrapper to cover the entire screen, edge to edge, we removed that default margin on <code>&lt;body&gt;</code> element by setting it to <code>0</code>.</p>
<p>We’ve given our <code>.fullpage-wrapper</code> the full height of the viewport. We don’t have to specify a width because a div is full width by default. We could have gone with another approach by setting both the width and height of the element to <code>100%</code> but that comes with some possible drawbacks as more elements are added to the screen. Using viewport units ensures our wrapper always occupies the full vertical space of the screen, regardless of what it is or what other elements are added to the layout.</p>
<p>We also used a radial gradient on our wrapper using <a href="https://css-tricks.com/snippets/css/css-radial-gradient/"><code>radial-gradient()</code></a> CSS function. The parameters inside the function are the color start and end points. So, the center of the background will be more <code>#353c44</code> and more <code>#222931</code> towards the edges. It’s subtle, but a nice touch.</p>
<figure id="post-268738" class="align-none media-268738"><img src="https://i0.wp.com/css-tricks.com/wp-content/uploads/2018/03/ironman-1.jpg?ssl=1" alt="" data-recalc-dims="1" /></figure>
<h3>Centering the Reactor Container</h3>
<p>Before we start creating our reactor, let’s create a container for it and center it:</p>
<pre rel="CSS"><code class="language-css">.reactor-container {
  width: 300px;
  height: 300px;
  margin: auto;
  border: 1px dashed #888;
}</code></pre>
<p>This gives us a <code>300px</code> x <code>300px</code> box with dashed border. The <code>margin: auto;</code> declaration ensures equal horizontal spacing.</p>
<figure id="post-268739" class="align-none media-268739"><img src="https://i2.wp.com/css-tricks.com/wp-content/uploads/2018/03/ironman-2.jpg?ssl=1" alt="" data-recalc-dims="1" /></figure>
<p>But why it doesn’t center it vertically?</p>
<p>Per CSS2 specs, if we give auto margin to the left and right side, then the entire available space will be equally divided to left and right margin. This isn’t the same case for the top and bottom margin though. For top and bottom margin the <a href="https://www.w3.org/TR/CSS22/visudet.html#Computing_heights_and_margins">CSS2 spec</a> says:</p>
<blockquote><p>If <code>margin-top</code>, or <code>margin-bottom</code> are <code>auto</code>, their used value is <code>0</code>.</p></blockquote>
<p>However, we do have a good news. The flexbox layout follows new rules of alignment, and here’s what the <a href="https://www.w3.org/TR/css-flexbox-1/#auto-margins">Flexbox spec</a> has to say:</p>
<blockquote><p>Prior to alignment via justify-content and align-self, any positive free space is distributed to auto margins in that dimension.</p></blockquote>
<p>This means if the element in consideration is displayed as a flex item, then <code>margin: auto;</code> will work in both the directions. Let’s make our wrapper a flex container and its child elements flex items:</p>
<pre rel="CSS"><code>.fullpage-wrapper {
  width: 100%;
  height: 100vh;
  background: radial-gradient(#353c44, #222931);
  display: flex;
}</code></pre>
<p>There, that’s much better:</p>
<figure id="post-268740" class="align-none media-268740"><img src="https://i2.wp.com/css-tricks.com/wp-content/uploads/2018/03/ironman-3.jpg?ssl=1" alt="" data-recalc-dims="1" /></figure>
<p>There are many other methods to center elements in HTML. There’s a <a href="https://css-tricks.com/centering-css-complete-guide/">detailed guide on centering</a> right here on CSS-Tricks to learn more.</p>
<h3>The Reactor Core: Concentric Circles in CSS</h3>
<p>We know that new elements in HTML are created from left to right (for left-to-right languages), or top to bottom. Elements never overlap, until you provide some negative margin.</p>
<p>So, how are we going to display concentric circles? We will use absolute positioning. </p>
<p>The default value of <a href="https://css-tricks.com/almanac/properties/p/position/"><code>position</code></a> property is <code>static</code>. Static and relative positioning follow the flow of top to bottom and left to right. However, an absolutely positioned element is not treated as a part of the document flow and can be positioned anywhere using the top, right, bottom and left properties.</p>
<p>Let’s start by creating the smallest circle:</p>
<pre rel="HTML"><code>&lt;div class="fullpage-wrapper"&gt;
  &lt;div class="reactor-container"&gt;
    &lt;!-- the smallest circle --&gt;
    &lt;div class="core-inner"&gt;&lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;</code></pre>
<pre rel="CSS"><code class="language-css">.core-inner {
  position: absolute;
  width: 70px;
  height: 70px;
  border-radius: 50%;
  border: 5px solid #1b4e5f;
  background-color: #fff;
}</code></pre>
<figure id="post-268741" class="align-none media-268741"><img src="https://i2.wp.com/css-tricks.com/wp-content/uploads/2018/03/ironman-4.jpg?ssl=1" alt="" data-recalc-dims="1" /></figure>
<p>We need to center this div. You might be tempted to apply the same flexbox concept we used on the reactor element to center this circle as well. But, here’s what <a href="https://www.w3.org/TR/CSS22/visudet.html#abs-non-replaced-height">CSS2 spec</a> has to say about setting <code>margin: auto;</code> on <em>absolutely positioned</em> elements:</p>
<blockquote><p>If none of the three (<code>top</code>, <code>height</code>, and <code>bottom</code>) are <code>auto</code>: If both <code>margin-top</code> and <code>margin-bottom</code> are <code>auto</code>, solve the equation under the extra constraint that the two margins get equal values.</p></blockquote>
<p>This means if an absolutely positioned element has any value for <code>top</code>, <code>height</code> and <code>bottom</code> other than <code>auto</code>, then setting the top and bottom margin to <code>auto</code> will center the element vertically.</p>
<p>Same case for horizontal centering: if an absolutely positioned element has any value for <code>left</code>, <code>width</code> and <code>right</code> other than <code>auto</code>, then setting the left and right margin to <code>auto</code> will center the element horizontally.</p>
<p>That means we don’t need flexbox layout to center an absolutely positioned element with a known height and width. We just have to make sure that we give some value to <code>top</code>, <code>right</code>, <code>bottom</code> and <code>left</code> other than <code>auto</code>. So, we will use <code>0</code>:</p>
<pre rel="CSS"><code class="language-css">.core-inner {
  position: absolute;
  width: 70px;
  height: 70px;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
  margin: auto;
  border-radius: 50%;
  border: 5px solid #1b4e5f;
  background-color: #fff;
}</code></pre>
<p>We do not want to repeat these five lines for all the concentric circles we are going to have, so let’s create a separate class for this. We also don’t want to define <code>border-radius: 50%;</code> for all the divs that we want to display as circles, so we will create a class for that too:</p>
<pre rel="CSS"><code class="language-css">.circle {
  border-radius: 50%;
}

.abs-center {
  position: absolute;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
  margin: auto;

}

.core-inner {
  width: 70px;
  height: 70px;
  border: 5px solid #1b4e5f;
  background-color: #fff;
}</code></pre>
<p>Also, add these new classes to out <code>.core-inner</code> element:</p>
<pre rel="HTML"><code class="language-markup">&lt;div class="fullpage-wrapper"&gt;
  &lt;div class="reactor-container"&gt;
    &lt;!-- the smallest circle --&gt;
    &lt;div class="core-inner circle abs-center"&gt;&lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;</code></pre>
<figure id="post-268742" class="align-none media-268742"><img src="https://i0.wp.com/css-tricks.com/wp-content/uploads/2018/03/ironman-5.jpg?ssl=1" alt="" data-recalc-dims="1" /></figure>
<p>Okay, our concentric circle is centered. Let’s make it glow. </p>
<p>But CSS doesn’t have any &#8220;glow&#8221; property.</p>
<p>Don’t worry, we have the <a href="https://css-tricks.com/almanac/properties/b/box-shadow/"><code>box-shadow</code></a> property. Instead of giving the shadow a dark color, we will give it a bright color to make the shadow look like glow. Pretty clever, isn’t it? &#x1f609; </p>
<p>Let’s do this:</p>
<pre rel="CSS"><code class="language-css">.core-inner {
  width: 70px;
  height: 70px;
  border: 5px solid #1b4e5f;
  background-color: #fff;
  box-shadow: 0px 0px 7px 5px #52fefe;
}</code></pre>
<figure id="post-268743" class="align-none media-268743"><img src="https://i0.wp.com/css-tricks.com/wp-content/uploads/2018/03/ironman-6.jpg?ssl=1" alt="" data-recalc-dims="1" /></figure>
<p>Let’s take a break and understand the syntax of <code>box-shadow</code> first because we will be using it a lot. Here are what those values for <code>box-shadow</code> mean in that order:</p>
<ul>
<li><code>x-offset</code>: how much we want to push the shadow on the right side (x-axis). Negative values will push the shadow to the left side.</li>
<li><code>y-offset</code>: how much we want to push the shadow up or down (y-axis).</li>
<li><code>blur-radius</code>: how blurry we want our shadow to be.</li>
<li><code>spread-radius</code>: how much we want our shadow to spread.</li>
<li><code>color</code>: color of the shadow.</li>
</ul>
<p>Play with these values a bit to see their effects in real time.</p>
<p>In real life, shadows don’t drop only outside of an object. Shadows drop upon the objects too. Imagine a pit dug by a dog, it will have a shadow inside it, right?</p>
<p>We can give a shadow inside an element using the <code>inset</code> keyword in the <code>box-sizing</code>  property. To give an element both, outside and inside shadow, we simply separate them with a comma. Let’s do this to get an outside and inside glow to our reactor’s inner core:</p>
<pre rel="CSS"><code class="language-css">.core-inner {
  width: 70px;
  height: 70px;
  border: 5px solid #1B4e5f;
  background-color: #fff;
  box-shadow: 0px 0px 7px 5px #52fefe, 0px 0px 10px 10px #52fefe inset;
}</code></pre>
<figure id="post-268744" class="align-none media-268744"><img src="https://i0.wp.com/css-tricks.com/wp-content/uploads/2018/03/ironman-7.jpg?ssl=1" alt="" data-recalc-dims="1" /></figure>
<p>Now it’s starting to look sci-fi!</p>
<p>Let’s create one more circle on top. We want the inner circle to display on top of the other circles, so we will add new circle divs *above* the inner-circle in code:</p>
<pre rel="HTML"><code>&lt;div class="fullpage-wrapper"&gt;
  &lt;div class="reactor-container"&gt;
    &lt;!-- the second circle --&gt;
    &lt;div class="core-outer circle abs-center"&gt;&lt;/div&gt;
    &lt;!-- the smallest circle --&gt;
    &lt;div class="core-inner circle abs-center"&gt;&lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;</code></pre>
<p>The elements down in the code, are displayed above on the screen. If we put the core-outer below the core-inner in the code, then core-inner won’t be visible, because core-outer will cover it.</p>
<p>Let’s give style to outer-code. The outer core will be a little bigger than the inner core and we will give an outer and inner glow to core-outer too:</p>
<pre rel="CSS"><code class="language-css">.core-outer {
  width: 120px;
  height: 120px;
  border: 1px solid #52fefe;
  background-color: #fff;
  box-shadow: 0px 0px 2px 1px #52fefe, 0px 0px 10px 5px #52fefe inset;
}</code></pre>
<figure id="post-268745" class="align-none media-268745"><img src="https://i1.wp.com/css-tricks.com/wp-content/uploads/2018/03/ironman-8.jpg?ssl=1" alt="" data-recalc-dims="1" /></figure>
<p>I want you to do one thing: look at the shadows (glow) and try to identify which one is of which circle. There are four shadows and two circles (until now).</p>
<p>To finish designing the core, we will need one more circle that will wrap the inner and outer circles:</p>
<pre rel="HTML"><code>&lt;div class="fullpage-wrapper"&gt;
  &lt;div class="reactor-container"&gt;
    &lt;!-- the third circle --&gt;
    &lt;div class="core-wrapper circle abs-center"&gt;&lt;/div&gt;
    &lt;!-- the second circle --&gt;
    &lt;div class="core-outer circle abs-center"&gt;&lt;/div&gt;
    &lt;!-- the smallest circle --&gt;
    &lt;div class="core-inner circle abs-center"&gt;&lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;</code></pre>
<p>This one will be a little bigger, and will again have same shadows, we will use a dark background for core-wrapper:</p>
<pre rel="CSS"><code class="language-css">.core-wrapper {
  width: 180px;
  height: 180px;
  background-color: #073c4b;
  box-shadow: 0px 0px 5px 4px #52fefe, 0px 0px 6px 2px #52fefe inset;
}</code></pre>
<figure id="post-268746" class="align-none media-268746"><img src="https://i1.wp.com/css-tricks.com/wp-content/uploads/2018/03/ironman-9.jpg?ssl=1" alt="" data-recalc-dims="1" /></figure>
<h3>Creating Reactor Coils and Rotating with CSS3 Transforms</h3>
<p>We have the core of the reactor, now we need a tunnel around the core. Actually, we can create an illusion of a round tunnel by drawing just one more circle little bigger than the <code>core-wrapper</code>. Let’s do it:</p>
<pre rel="HTML"><code>&lt;div class="fullpage-wrapper"&gt;
  &lt;div class="reactor-container"&gt;
    &lt;!-- the largest circle --&gt;
    &lt;div class="tunnel circle abs-center"&gt;&lt;/div&gt;
    &lt;!-- the third circle --&gt;
    &lt;div class="core-wrapper circle abs-center"&gt;&lt;/div&gt;
    &lt;!-- the second circle --&gt;
    &lt;div class="core-outer circle abs-center"&gt;&lt;/div&gt;
    &lt;!-- the smallest circle --&gt;
    &lt;div class="core-inner circle abs-center"&gt;&lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;</code></pre>
<p>&#8230;a little wider and add same glow to the tunnel:</p>
<pre rel="CSS"><code class="language-css">.tunnel {
  width: 220px;
  height: 220px;
  background-color: #fff;
  box-shadow: 0px 0px 5px 1px #52fefe, 0px 0px 5px 4px #52fefe inset;
}</code></pre>
<figure id="post-268747" class="align-none media-268747"><img src="https://i2.wp.com/css-tricks.com/wp-content/uploads/2018/03/ironman-10.jpg?ssl=1" alt="" data-recalc-dims="1" /></figure>
<p>Our tunnel is ready. </p>
<p>Make sure you do not just copy paste the code. Have a look at the glows of the circles and identify which glow is of which circle, whether it is outside glow or inset glow.</p>
<p>Now, we need eight coils on this tunnel. The coils are simple rectangles, but the major challenge is that we need the coils to run along the round path of the tunnel; not in straight line.</p>
<p>One way to do this would be to create eight small rectangles, shift their center to the center of the reactor, and rotate each coil by an increasing angle (in multiples of <code>45deg</code>). </p>
<p>Let’s not complicate it and make one rectangle coil at a time:</p>
<pre rel="HTML"><code>&lt;div class="fullpage-wrapper"&gt;
  &lt;div class="reactor-container"&gt;
    &lt;div class="tunnel circle abs-center"&gt;&lt;/div&gt;
    &lt;div class="core-wrapper circle abs-center"&gt;&lt;/div&gt;
    &lt;div class="core-outer circle abs-center"&gt;&lt;/div&gt;
    &lt;div class="core-inner circle abs-center"&gt;&lt;/div&gt;
    &lt;div class="coil-1"&gt;&lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;</code></pre>
<pre rel="CSS"><code class="language-css">.coil-1 {
  position: absolute;
  width: 30px;
  height: 26px;
  background-color: #073c4b;
  box-shadow: 0px 0px 5px #52fefe inset;
}</code></pre>
<figure id="post-268748" class="align-none media-268748"><img src="https://i1.wp.com/css-tricks.com/wp-content/uploads/2018/03/ironman-11.jpg?ssl=1" alt="" data-recalc-dims="1" /></figure>
<p>Now, we want to place this coil in the center at top of the tunnel. Like this:</p>
<figure id="post-268749" class="align-none media-268749"><img src="https://i1.wp.com/css-tricks.com/wp-content/uploads/2018/03/ironman-12.jpg?ssl=1" alt="" data-recalc-dims="1" /></figure>
<p>Our reactor-container is <code>300px</code> x <code>300px</code>, so the center is at <code>150px</code> from top and left. The tunnel is <code>220px</code> wide, so its radius will be <code>110px</code>. This gives us the top offset of the coil: <code>150px - 110px</code>. </p>
<p>We can keep left of the coil to <code>150px</code>, but since our coil is <code>30px</code> wide, it will shift the middle of the coil by <code>15px</code> to right, that’s why we need to subtract <code>15px</code> from <code>150px</code> to get the left offset of the coil.</p>
<p>We can either calculate these ourselves and put the value, or we can use the CSS <code>calc()</code> function. Let’s use the CSS <code>calc()</code> function to calculate the top and left properties of the coil:</p>
<pre rel="CSS"><code class="language-css">.coil-1 {
  position: absolute;
  width: 30px;
  height: 20px;
  top: calc(50% - 110px);
  left: calc(50% - 15px);
  background-color: #073c4b;
  box-shadow: 0px 0px 5px #52fefe inset;
}</code></pre>
<figure id="post-268750" class="align-none media-268750"><img src="https://i0.wp.com/css-tricks.com/wp-content/uploads/2018/03/ironman-13.jpg?ssl=1" alt="" data-recalc-dims="1" /></figure>
<p>As you can see, the <code>calc()</code> function takes a mathematical expression as its argument and solves it.</p>
<p>Now we need eight such coils but they must lie on the tunnel. To do that, as discussed, we can simply place the eight coils at this same place, then transform their origin to the center of the reactor, and rotate each coil by an increment of 45 degrees.</p>
<p>We need to update the coil’s origin because by default it is set to the center of the coil; we want it at center of the reactor:</p>
<figure id="post-268751" class="align-none media-268751"><img src="https://i0.wp.com/css-tricks.com/wp-content/uploads/2018/03/ironman-14.jpg?ssl=1" alt="" data-recalc-dims="1" /></figure>
<p>We will use <code>transform-origin</code> property to set the origin of the coil:</p>
<pre rel="CSS"><code class="language-css">.coil-1 {
  position: absolute;
  width: 30px;
  height: 20px;
  top: calc(50% - 110px);
  left: calc(50% - 15px);
  transform-origin: 15px 110px;
  background-color: #073c4b;
  box-shadow: 0px 0px 5px #52fefe inset;
}</code></pre>
<p>The first value, <code>15px</code>, in <code>transform-origin</code> is the <code>x-offset</code> (horizontal distance) from the top-left corner of the element, and the second value, <code>110px</code>, is the <code>y-offset</code> (vertical distance) from the top-left corner of the element.</p>
<p>The coil’s origin is now at the center of the reactor, let’s rotate it by 45 degrees using the CSS3 transform property and see what happens:</p>
<pre rel="CSS"><code>.coil-1 {
  position: absolute;
  width: 30px;
  height: 20px;
  top: calc(50% - 110px);
  left: calc(50% - 15px);
  transform-origin: 15px 110px;
  transform: rotate(45deg);
  background-color: #073c4b;
  box-shadow: 0px 0px 5px #52fefe inset;
}</code></pre>
<figure id="post-268752" class="align-none media-268752"><img src="https://i0.wp.com/css-tricks.com/wp-content/uploads/2018/03/ironman-15.jpg?ssl=1" alt="" data-recalc-dims="1" /></figure>
<p>Great! That’s exactly what we want.</p>
<p>Before creating all the eight coils, let’s create a coil container div that will contain all the eight coils:</p>
<pre rel="HTML"><code>&lt;div class="fullpage-wrapper"&gt;
  &lt;div class="reactor-container"&gt;
    &lt;div class="tunnel circle abs-center"&gt;&lt;/div&gt;
    &lt;div class="core-wrapper circle abs-center"&gt;&lt;/div&gt;
    &lt;div class="core-outer circle abs-center"&gt;&lt;/div&gt;
    &lt;div class="core-inner circle abs-center"&gt;&lt;/div&gt;
    &lt;!-- the coil container --&gt;
    &lt;div class="coil-container"&gt;
      &lt;div class="coil coil-1"&gt;&lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;</code></pre>
<p>You will notice we also added a class &#8220;coil&#8221; to the &#8220;coil-1&#8221; element. We will keep all the common styles for coils in the &#8220;coil&#8221; class, and the individual coil element classes will only have their angle of rotation:</p>
<pre rel="CSS"><code class="language-css">.coil-container {
  position: relative;
  width: 100%;
  height: 100%;
}

.coil {
  position: absolute;
  width: 30px;
  height: 20px;
  top: calc(50% - 110px);
  left: calc(50% - 15px);
  transform-origin: 15px 110px;
  background-color: #073c4b;
  box-shadow: 0px 0px 5px #52fefe inset;
}

.coil-1 {
  transform: rotate(45deg);
}</code></pre>
<p>The output will remain same.</p>
<p>Now, let’s make all the eight coils inside <code>.coil-container</code>:</p>
<pre rel="HTML"><code>&lt;div class="fullpage-wrapper"&gt;
  &lt;div class="reactor-container"&gt;
    &lt;div class="tunnel circle abs-center"&gt;&lt;/div&gt;
    &lt;div class="core-wrapper circle abs-center"&gt;&lt;/div&gt;
    &lt;div class="core-outer circle abs-center"&gt;&lt;/div&gt;
    &lt;div class="core-inner circle abs-center"&gt;&lt;/div&gt;
    &lt;!-- the coil container --&gt;
    &lt;div class="coil-container"&gt;
      &lt;div class="coil coil-1"&gt;&lt;/div&gt;
      &lt;div class="coil coil-2"&gt;&lt;/div&gt;
      &lt;div class="coil coil-3"&gt;&lt;/div&gt;
      &lt;div class="coil coil-4"&gt;&lt;/div&gt;
      &lt;div class="coil coil-5"&gt;&lt;/div&gt;
      &lt;div class="coil coil-6"&gt;&lt;/div&gt;
      &lt;div class="coil coil-7"&gt;&lt;/div&gt;
      &lt;div class="coil coil-8"&gt;&lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;</code></pre>
<p>&#8230;and give different rotations to all the coils (in increment of 45 degrees):</p>
<pre rel="CSS"><code class="language-css">.coil {
  position: absolute;
  width: 30px;
  height: 20px;
  top: calc(50% - 110px);
  left: calc(50% - 15px);
  transform-origin: 15px 110px;
  background-color: #073c4b;
  box-shadow: 0px 0px 5px #52fefe inset;
}

.coil-1 {
  transform: rotate(0deg);
}

.coil-2 {
  transform: rotate(45deg);
}

.coil-3 {
  transform: rotate(90deg);
}

.coil-4 {
  transform: rotate(135deg);
}

.coil-5 {
  transform: rotate(180deg);
}

.coil-6 {
  transform: rotate(225deg);
}

.coil-7 {
  transform: rotate(270deg);
}

.coil-8 {
  transform: rotate(315deg);
}</code></pre>
<figure id="post-268753" class="align-none media-268753"><img src="https://i2.wp.com/css-tricks.com/wp-content/uploads/2018/03/ironman-16.jpg?ssl=1" alt="" data-recalc-dims="1" /></figure>
<p>Our reactor is almost ready.</p>
<h3>Animating the Coils With CSS3 Animations</h3>
<p>In Iron Man’s Arc reactor, the coils don’t move but they will in our reactor. We will animate the coils to rotate along the tunnel and will use CSS3 animations for this—no JavaScript.</p>
<p>To create an animation, you need to know the initial and final states of the object you are going to animate. We define these initial and final states in CSS by using <code>@keyframes</code> at-rule:</p>
<pre rel="CSS"><code class="language-css">@keyframes reactor-anim {
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
}</code></pre>
<p>We want the element to be at 0 degrees and animate it until it reaches 360 degrees. And we named this animation as &#8220;reactor-anim.&#8221;</p>
<p>The element we want to animate is <code>.coil-contailer</code>. Notice, we didn’t define which object to animate yet, we have only defined the initial and the final state and name of the animation. </p>
<p>We need to link the element to the animation in order to take effect. We do it by using <code>animation-name</code> property on <code>.coil-container</code>:</p>
<pre rel="CSS"><code class="language-css">.coil-container {
  position: relative;
  width: 100%;
  height: 100%;
  animation-name: reactor-anim;
  animation-duration: 3s;
}</code></pre>
<p>Notice, we also gave the duration of animation using <code>animation-duration</code> property. This defines how much time it should take to go from the “from” state to the “to” state defined using the <code>@keyframes</code> at-rule.</p>
<p data-height="415" style="height: 415px; display: flex; align-items: center; justify-content: center; border: 2px solid black; margin: 1rem 0; padding: 1rem; overflow: auto;" data-theme-id="1" data-slug-hash="GxKZee" data-default-tab="result" data-user="supersarkar" data-embed-version="2" data-pen-title="Arc-Reactor-Ease-In" class="codepen">See the Pen <a href="https://codepen.io/supersarkar/pen/GxKZee/">Arc-Reactor-Ease-In</a> by Kunal Sarkar (<a href="https://codepen.io/supersarkar">@supersarkar</a>) on <a href="https://codepen.io">CodePen</a>.</p>
<p>We need to change two things here: we want the animation to go on infinitely and we want a linear animation. You can see the animation is slow at the beginning, then fast, then again slow at the end—this behavior is defined by the timing function of an animation.</p>
<p>Let’s make these changes:</p>
<pre rel="CSS"><code class="language-css">.coil-container {
  position: relative;
  width: 100%;
  height: 100%;
  animation-name: reactor-anim;
  animation-duration: 3s;
  animation-iteration-count: infinite;
  animation-timing-function: linear;
}</code></pre>
<p>We used <code>animation-iteration-count</code> property to set the animation to <code>infinite</code>, and <code>animation-timing-function</code> to make the animation <code>linear</code>, the default value of <code>animation-timing-function</code> is <code>ease</code>.</p>
<p data-height="410" style="height: 410px; display: flex; align-items: center; justify-content: center; border: 2px solid black; margin: 1rem 0; padding: 1rem; overflow: auto;" data-theme-id="1" data-slug-hash="vRBGwv" data-default-tab="result" data-user="supersarkar" data-embed-version="2" data-pen-title="Arc-Reactor-Linear-Infinite" class="codepen">See the Pen <a href="https://codepen.io/supersarkar/pen/vRBGwv/">Arc-Reactor-Linear-Infinite</a> by Kunal Sarkar (<a href="https://codepen.io/supersarkar">@supersarkar</a>) on <a href="https://codepen.io">CodePen</a>.</p>
<p>We can combine all of these animation properties&#8230;</p>
<pre rel="CSS"><code class="language-css">animation-name: reactor-anim;
animation-duration: 3s;
animation-iteration-count: infinite;
animation-timing-function: linear;</code></pre>
<p>&#8230;into one shorthand property like this:</p>
<pre rel="CSS"><code class="language-css">animation: 3s infinite linear reactor-anim;</code></pre>
<h3>Final Touches to the Reactor Container</h3>
<p>Our reactor is ready, now let’s make some final changes to the <code>.reactor-container</code>. First, we will need one dark circle behind the reactor:</p>
<pre rel="HTML"><code>&lt;div class="fullpage-wrapper"&gt;
  &lt;div class="reactor-container"&gt;
    &lt;!-- dark circle behind the reactor --&gt;
    &lt;div class="reactor-container-inner circle abs-center"&gt;&lt;/div&gt;
    &lt;div class="tunnel circle abs-center"&gt;&lt;/div&gt;
    &lt;div class="core-wrapper circle abs-center"&gt;&lt;/div&gt;
    &lt;div class="core-outer circle abs-center"&gt;&lt;/div&gt;
    &lt;div class="core-inner circle abs-center"&gt;&lt;/div&gt;
    &lt;div class="coil-container"&gt;
      &lt;div class="coil coil-1"&gt;&lt;/div&gt;
      &lt;div class="coil coil-2"&gt;&lt;/div&gt;
      &lt;div class="coil coil-3"&gt;&lt;/div&gt;
      &lt;div class="coil coil-4"&gt;&lt;/div&gt;
      &lt;div class="coil coil-5"&gt;&lt;/div&gt;
      &lt;div class="coil coil-6"&gt;&lt;/div&gt;
      &lt;div class="coil coil-7"&gt;&lt;/div&gt;
      &lt;div class="coil coil-8"&gt;&lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;</code></pre>
<p>Let’s give a dark background and add some glow to it:</p>
<pre rel="CSS"><code class="language-css">.reactor-container-inner {
  height: 238px;
  width: 238px;
  background-color: rgb(22, 26, 27);;
  box-shadow: 0px 0px 4px 1px #52fefe;
}</code></pre>
<p data-height="420" style="height: 420px; display: flex; align-items: center; justify-content: center; border: 2px solid black; margin: 1rem 0; padding: 1rem; overflow: auto;" data-theme-id="1" data-slug-hash="wmwWwB" data-default-tab="result" data-user="supersarkar" data-embed-version="2" data-pen-title="Arc-Reactor-Semi-Final" class="codepen">See the Pen <a href="https://codepen.io/supersarkar/pen/wmwWwB/">Arc-Reactor-Semi-Final</a> by Kunal Sarkar (<a href="https://codepen.io/supersarkar">@supersarkar</a>) on <a href="https://codepen.io">CodePen</a>.</p>
<p>See how the dark background and the glow creates an emboss effect?</p>
<p>Next, let’s make the <code>.rotator-container</code> round and give it some shadow and border, then we are done:</p>
<pre rel="CSS"><code class="language-css">.reactor-container {
  width: 300px;
  height: 300px;
  margin: auto;
  border: 1px dashed #888;
  position: relative;
  border-radius: 50%;
  background-color: #384c50;
  border: 1px solid rgb(18, 20, 20);
  box-shadow: 0px 0px 32px 8px rgb(18, 20, 20), 0px 0px 4px 1px rgb(18, 20, 20) inset;
}</code></pre>
<p data-height="425" style="height: 425px; display: flex; align-items: center; justify-content: center; border: 2px solid black; margin: 1rem 0; padding: 1rem; overflow: auto;" data-theme-id="1" data-slug-hash="QmLEWN" data-default-tab="result" data-user="supersarkar" data-embed-version="2" data-pen-title="Iron Man's Arc Reactor" class="codepen">See the Pen <a href="https://codepen.io/supersarkar/pen/QmLEWN/">Iron Man&#8217;s Arc Reactor</a> by Kunal Sarkar (<a href="https://codepen.io/supersarkar">@supersarkar</a>) on <a href="https://codepen.io">CodePen</a>.</p>
<p>Cheers! Our Arc Reactor is ready and even with a little animation as an added bonus. To level this up, we could explore using <a href="https://css-tricks.com/making-custom-properties-css-variables-dynamic/">custom properties</a> to create reusable variables for our color and number values for easier maintenance. Similarly, we could look into using a preprocessor—like Sass, Less or PostCSS—to write functions that do the mathematical lifting for us. Would love to see examples like that in the comments!</p>
<p>The post <a rel="nofollow" href="https://css-tricks.com/iron-mans-arc-reactor-using-css3-transforms-and-animations/">Iron Man’s Arc Reactor Using CSS3 Transforms and Animations</a> appeared first on <a rel="nofollow" href="https://css-tricks.com">CSS-Tricks</a>.</p>
]]></content:encoded>
					
					<wfw:commentRss>https://css-tricks.com/iron-mans-arc-reactor-using-css3-transforms-and-animations/feed/</wfw:commentRss>
			<slash:comments>4</slash:comments>
		
		
		<post-id xmlns="com-wordpress:feed-additions:1">268736</post-id>	</item>
		<item>
		<title>Animate a Container on Mouse Over Using Perspective and Transform</title>
		<link>https://css-tricks.com/animate-a-container-on-mouse-over-using-perspective-and-transform/</link>
					<comments>https://css-tricks.com/animate-a-container-on-mouse-over-using-perspective-and-transform/#comments</comments>
		
		<dc:creator><![CDATA[Mihai Ionescu]]></dc:creator>
		<pubDate>Thu, 15 Mar 2018 15:55:35 +0000</pubDate>
				<category><![CDATA[Article]]></category>
		<category><![CDATA[perspective]]></category>
		<category><![CDATA[transform]]></category>
		<guid isPermaLink="false">http://css-tricks.com/?p=267962</guid>

					<description><![CDATA[<p>I’ve been working on a website in which large pictures are displayed to the user. Instead of creating a typical lightbox effect (a zoom-in animation with a black overlay) for these large pictures, I decided to try and make something more interactive and fun. I ended up coding an image container that tilts as the user moves the mouse cursor above it.</p>
</p>
<p>Here’s the final version:</p>
<p data-height="570" style="height: 570px; display: flex; align-items: center; justify-content: center; border: 2px solid black; margin: 1rem 0; padding: 1rem; overflow: auto;" data-theme-id="1" data-slug-hash="MrLopq" data-default-tab="result" data-user="MihaiIonescu" data-embed-version="2" data-pen-title="MrLopq" class="codepen">See the Pen <a href="https://codepen.io/MihaiIonescu/pen/MrLopq/">MrLopq</a> by Mihai (<a href="https://codepen.io/MihaiIonescu">@MihaiIonescu</a>) on <a href="https://codepen.io">CodePen</a>.</p>
<p>This effect &#8230; <a href="https://css-tricks.com/animate-a-container-on-mouse-over-using-perspective-and-transform/" class="read-more">Read article <span class="screen-reader-text"> &#8220;Animate a Container on Mouse Over Using Perspective and Transform&#8221;</span></a></p>
<p>The post <a rel="nofollow" href="https://css-tricks.com/animate-a-container-on-mouse-over-using-perspective-and-transform/">Animate a Container on Mouse Over Using Perspective and Transform</a> appeared first on <a rel="nofollow" href="https://css-tricks.com">CSS-Tricks</a>.</p>
]]></description>
										<content:encoded><![CDATA[<p>I’ve been working on a website in which large pictures are displayed to the user. Instead of creating a typical lightbox effect (a zoom-in animation with a black overlay) for these large pictures, I decided to try and make something more interactive and fun. I ended up coding an image container that tilts as the user moves the mouse cursor above it.</p>
<p><span id="more-267962"></span></p>
<p>Here’s the final version:</p>
<p data-height="570" style="height: 570px; display: flex; align-items: center; justify-content: center; border: 2px solid black; margin: 1rem 0; padding: 1rem; overflow: auto;" data-theme-id="1" data-slug-hash="MrLopq" data-default-tab="result" data-user="MihaiIonescu" data-embed-version="2" data-pen-title="MrLopq" class="codepen">See the Pen <a href="https://codepen.io/MihaiIonescu/pen/MrLopq/">MrLopq</a> by Mihai (<a href="https://codepen.io/MihaiIonescu">@MihaiIonescu</a>) on <a href="https://codepen.io">CodePen</a>.</p>
<p>This effect is achieved through CSS and JavaScript. I figured I’d make a little tutorial explaining how each part works so you could easily reproduce it or extend it. </p>
<p>I recommend reading up on the almanac entries for <a href="https://css-tricks.com/almanac/properties/p/perspective/">perspective</a> and <a href="https://css-tricks.com/almanac/properties/t/transform/">transform</a> before we get started. We’re going to refer to these properties through the post and it’s a good idea to be familiar with them.</p>
<p>Let’s get down to it.</p>
<h3>Setup</h3>
<p>First, we need a container with another inner element. The container will help with the perspective.</p>
<pre rel="HTML"><code>&lt;div id="container"&gt;
  &lt;div id="inner"&gt;&lt;/div&gt;
&lt;/div&gt;</code></pre>
<p>For demonstration purposes, let’s center the card exactly in the middle of the screen: </p>
<pre rel="CSS""><code>body {
  /* Full screen width and height */
  width: 100%;
  min-height: 100vh;
    
  /* Centers the container in the middle of the screen */
  display: flex;
  justify-content: center;
  align-items: center;
    
  margin: 0;
  background-color: rgb(220, 220, 220);
}

#container {
  /* This will come into play later */
  perspective: 40px;
}

#inner {
  width: 20em;
  height: 18em;
  background-color: white;
}</code></pre>
<p>This gives us a white card that is positioned directly in the center of a light gray background. Note that we’ve set the perspective of the <code>#container</code> to <code>40px</code> which does nothing at this point because we have not created any transforms. That will be handled later in the JavaScript.</p>
<p data-height="500" style="height: 500px; display: flex; align-items: center; justify-content: center; border: 2px solid black; margin: 1rem 0; padding: 1rem; overflow: auto;" data-theme-id="1" data-slug-hash="OQQdPb" data-default-tab="result" data-user="MihaiIonescu" data-embed-version="2" data-pen-title="3D Image Container - Part 0" class="codepen">See the Pen <a href="https://codepen.io/MihaiIonescu/pen/OQQdPb/">3D Image Container &#8211; Part 0</a> by Mihai (<a href="https://codepen.io/MihaiIonescu">@MihaiIonescu</a>) on <a href="https://codepen.io">CodePen</a>.</p>
<h3>Let’s Start Scripting</h3>
<p>Here’s the outline for what we’re doing:</p>
<pre rel="JavaScript"><code>var container = document.getElementById('container');
var inner = document.getElementById('inner');
        
var onMouseEnterHandler = function(event) {
  update(event);
};
var onMouseLeaveHandler = function() {
  inner.style = "";
};
var onMouseMoveHandler = function(event) {
  if (isTimeToUpdate()) {
    update(event);
  }
};

container.onmouseenter = onMouseEnterHandler;
container.onmouseleave = onMouseLeaveHandler;
container.onmousemove = onMouseMoveHandler;</code></pre>
<p>And here is what all those things are (or will) be doing:</p>
<ul>
<li><strong>Handler Functions:</strong> these functions handle the events as they happen. We want to decide what happens when the cursor enters, moves over, and leaves the container, so each of those has a handler.</li>
<li><strong>Update Function:</strong> We haven’t coded this yet but its goal will be to update the 3D rotation of our <code>#inner</code> div.</li>
<li><strong>Time to Update Function:</strong> This is another function we haven’t coded yet but it will return <code>true</code> when an update is required. This is a way to reduce the number of calls to the <code>update()</code> function and improve the performance of our script.</li>
<li><strong>Event:</strong> This is a JavaScript object that describes the event that occurred.</li>
</ul>
<p>The code above will:</p>
<ul>
<li>Update the 3D rotation of the inner div as soon as the mouse enters the container.</li>
<li>Update the 3D rotation of the inner div when the appropriate time comes as the mouse moves over the container.</li>
<li>Reset the style of the inner div when the mouse leaves the container.</li>
</ul>
<h3>Is it Time to Update?</h3>
<p>Let’s add the function that decides when to update the 3D rotation of the <code>#inner</code> div.</p>
<pre rel="JavaScript"><code>var counter = 0;
var updateRate = 10;
var isTimeToUpdate = function() {
  return counter++ % updateRate === 0;
};</code></pre>
<p>When the <code>counter</code> reaches the <code>updateRate</code>, an update will be made.</p>
<p>At this point, you can try replacing the <code>update</code> function by a <code>console.log()</code> and play with the <code>updateRate</code> to see how it all works together.</p>
<h3>The Mouse</h3>
<p>Next up is the mouse object. This one is a little more complex than the other sections. Still, it’s not that difficult to understand, but the code can seem intimidating, especially if you’re new to JavaScript.</p>
<pre rel="JavaScript"><code>// Init
var container = document.getElementById('container');
var inner = document.getElementById('inner');
// Mouse 
var mouse = {
  _x: 0,
  _y: 0,
  x: 0,
  y: 0,
  updatePosition: function(event) {
    var e = event || window.event;
    this.x = e.clientX - this._x;
    this.y = (e.clientY - this._y) * -1;
  },
  setOrigin: function(e) {
    this._x = e.offsetLeft + Math.floor(e.offsetWidth/2);
    this._y = e.offsetTop + Math.floor(e.offsetHeight/2);
  },
  show: function() { return '(' + this.x + ', ' + this.y + ')'; }
}
// Track the mouse position relative to the center of the container.
mouse.setOrigin(container);</code></pre>
<p>Again, let’s walk through this together.</p>
<ul>
<li><code>show()</code>: Displays the current position of the mouse (if you want to do some debugging in the browser’s console).</li>
<li><code>setOrigin(e)</code>: Sets the coordinates <code>(0,0)</code> of our <code>mouse</code> object at the center of the element (<code>e</code>).</li>
<li><code>updatePosition()</code>: Updates the current position of our <code>mouse</code> object, relative to <code>(0,0)</code>.</li>
</ul>
<p>The last line of code <code>mouse.setOrigin(container)</code> snaps the coordinates <code>(0,0)</code> of our <code>mouse</code> object to the center of our container. Here&#8217;s an example that illustrates it. </p>
<p data-height="500" style="height: 500px; display: flex; align-items: center; justify-content: center; border: 2px solid black; margin: 1rem 0; padding: 1rem; overflow: auto;" data-theme-id="1" data-slug-hash="JpVPLQ" data-default-tab="result" data-user="MihaiIonescu" data-embed-version="2" data-pen-title="3D Image Container - Part 1" class="codepen">See the Pen <a href="https://codepen.io/MihaiIonescu/pen/JpVPLQ/">3D Image Container &#8211; Part 1</a> by Mihai (<a href="https://codepen.io/MihaiIonescu">@MihaiIonescu</a>) on <a href="https://codepen.io">CodePen</a>.</p>
<p>The idea behind all this is to add more rotation to our <code>#inner</code> div as you move the mouse farther from the center of the container.</p>
<h3>Update Styles on Mouse Position</h3>
<p>Here’s our update function:</p>
<pre rel="JavaScript"><code>var update = function(event) {
  mouse.updatePosition(event);
  updateTransformStyle(
    (mouse.y / inner.offsetHeight/2).toFixed(2),
    (mouse.x / inner.offsetWidth/2).toFixed(2)
  );
};

var updateTransformStyle = function(x, y) {
  var style = "rotateX(" + x + "deg) rotateY(" + y + "deg)";
  inner.style.transform = style;
  inner.style.webkitTransform = style;
  inner.style.mozTransform = style;
  inner.style.msTransform = style;
  inner.style.oTransform = style;
};</code></pre>
<ul>
<li><code>update()</code>: Updates the mouse position and updates the style of the <code>#inner</code> div.</li>
<li><code>updateTransformStyle()</code>: Updates the style for each vendor prefix.</li>
</ul>
<h3>Are We Done?</h3>
<p>We’d better do some testing! Looks like we get a change in perspective when the mouse cursor enters and exits the card, but it’s not as smooth as it could be:</p>
<p data-height="500" style="height: 500px; display: flex; align-items: center; justify-content: center; border: 2px solid black; margin: 1rem 0; padding: 1rem; overflow: auto;" data-theme-id="1" data-slug-hash="VQWWgj" data-default-tab="result" data-user="MihaiIonescu" data-embed-version="2" data-pen-title="3D Image Container - Part 2" class="codepen">See the Pen <a href="https://codepen.io/MihaiIonescu/pen/VQWWgj/">3D Image Container &#8211; Part 2</a> by Mihai (<a href="https://codepen.io/MihaiIonescu">@MihaiIonescu</a>) on <a href="https://codepen.io">CodePen</a>.</p>
<p>Oh right! We told it to update the rotation of our <code>#inner</code> div every time the <code>counter</code> hits the <code>updateRate</code>. This produces a clunky transition between updates. </p>
<p>How do we solve that? CSS transitions.</p>
<h3>Adding Transitions</h3>
<pre rel="CSS"><code>#inner {
  transition: transform 0.5s;
}</code></pre>
<p>These are arbitrary numbers. You can play with the perspective and transform values to make the effect more or less dramatic as you see fit.</p>
<p data-height="500" style="height: 500px; display: flex; align-items: center; justify-content: center; border: 2px solid black; margin: 1rem 0; padding: 1rem; overflow: auto;" data-theme-id="1" data-slug-hash="MQoodL" data-default-tab="result" data-user="MihaiIonescu" data-embed-version="2" data-pen-title="3D Image Container - Part 3" class="codepen">See the Pen <a href="https://codepen.io/MihaiIonescu/pen/MQoodL/">3D Image Container &#8211; Part 3</a> by Mihai (<a href="https://codepen.io/MihaiIonescu">@MihaiIonescu</a>) on <a href="https://codepen.io">CodePen</a>.</p>
<p class="explanation">Note that resizing the page will cause some problems because the position of the container changes in the page. The solution is to re-center your  <code>mouse</code> object in your <code>container</code> after the page is resized.</p>
<h3>Wrapping Up</h3>
<p>We’re done! Now we have a container for making an element a little more interactive. The demo at the beginning of this post uses an image inside of the container, but this can be used for other things besides images, including forms, modals, or just about any other content you drop in the container. Go experiment!</p>
<p>The post <a rel="nofollow" href="https://css-tricks.com/animate-a-container-on-mouse-over-using-perspective-and-transform/">Animate a Container on Mouse Over Using Perspective and Transform</a> appeared first on <a rel="nofollow" href="https://css-tricks.com">CSS-Tricks</a>.</p>
]]></content:encoded>
					
					<wfw:commentRss>https://css-tricks.com/animate-a-container-on-mouse-over-using-perspective-and-transform/feed/</wfw:commentRss>
			<slash:comments>7</slash:comments>
		
		
		<post-id xmlns="com-wordpress:feed-additions:1">267962</post-id>	</item>
		<item>
		<title>What Houdini Means for Animating Transforms</title>
		<link>https://css-tricks.com/what-houdini-means-for-animating-transforms/</link>
					<comments>https://css-tricks.com/what-houdini-means-for-animating-transforms/#comments</comments>
		
		<dc:creator><![CDATA[Ana Tudor]]></dc:creator>
		<pubDate>Wed, 07 Mar 2018 13:15:45 +0000</pubDate>
				<category><![CDATA[Article]]></category>
		<category><![CDATA[animation]]></category>
		<category><![CDATA[css variables]]></category>
		<category><![CDATA[custom properties]]></category>
		<category><![CDATA[houdini]]></category>
		<category><![CDATA[transform]]></category>
		<guid isPermaLink="false">http://css-tricks.com/?p=265831</guid>

					<description><![CDATA[<p>I&#8217;ve been playing with CSS transforms for over five years and one thing that has always bugged me was that I couldn&#8217;t animate the components of a <code>transform</code> chain individually. This article is going to explain the problem, the old workaround, the new magic <a href="https://developers.google.com/web/updates/2016/05/houdini">Houdini</a> <a href="https://drafts.css-houdini.org/css-properties-values-api/">solution</a> and, finally, will offer you a feast of eye candy through better looking examples than those used to illustrate concepts.</p>
</p>
<p>The Problem</p>
<p>In order to better understand the issue at hand, let&#8217;s consider the &#8230; <a href="https://css-tricks.com/what-houdini-means-for-animating-transforms/" class="read-more">Read article <span class="screen-reader-text"> &#8220;What Houdini Means for Animating Transforms&#8221;</span></a></p>
<p>The post <a rel="nofollow" href="https://css-tricks.com/what-houdini-means-for-animating-transforms/">What Houdini Means for Animating Transforms</a> appeared first on <a rel="nofollow" href="https://css-tricks.com">CSS-Tricks</a>.</p>
]]></description>
										<content:encoded><![CDATA[<p>I&#8217;ve been playing with CSS transforms for over five years and one thing that has always bugged me was that I couldn&#8217;t animate the components of a <code>transform</code> chain individually. This article is going to explain the problem, the old workaround, the new magic <a href="https://developers.google.com/web/updates/2016/05/houdini">Houdini</a> <a href="https://drafts.css-houdini.org/css-properties-values-api/">solution</a> and, finally, will offer you a feast of eye candy through better looking examples than those used to illustrate concepts.</p>
<p><span id="more-265831"></span></p>
<h3 id='problem'>The Problem</h3>
<p>In order to better understand the issue at hand, let&#8217;s consider the example of a box we move horizontally across the screen. This means one <code>div</code> as far as the HTML goes:</p>
<pre rel="HTML"><code class="language-html">&lt;div class="box"&gt;&lt;/div&gt;</code></pre>
<p>The CSS is also pretty straightforward. We give this box dimensions, a <code>background</code> and position it in the middle horizontally with a <code>margin</code>.</p>
<pre rel="SCSS"><code class="language-scss">$d: 4em;

.box {
  margin: .25*$d auto;
  width: $d; height: $d;
  background: #f90;
}</code></pre>
<p data-height="165" style="height: 165px; display: flex; align-items: center; justify-content: center; border: 2px solid black; margin: 1rem 0; padding: 1rem; overflow: auto;" data-theme-id="1" data-slug-hash="xpBNBz" data-default-tab="result" data-user="thebabydino" data-embed-version="2" data-pen-title="oscillating box - step #0 (creating the box)" class="codepen">See the <a href="http://codepen.io/thebabydino/pen/xpBNBz/">Pen</a> by thebabydino (<a href="http://codepen.io/thebabydino">@thebabydino</a>) on <a href="http://codepen.io">CodePen</a>.</p>
<p>Next, with the help of a translation along the <var>x</var> axis, we move it by half a viewport (<code>50vw</code>) to the left (in the negative direction of the <var>x</var> axis, the positive one being towards the right):</p>
<pre rel="SCSS"><code class="language-scss">transform: translate(-50vw);</code></pre>
<p data-height="165" style="height: 165px; display: flex; align-items: center; justify-content: center; border: 2px solid black; margin: 1rem 0; padding: 1rem; overflow: auto;" data-theme-id="1" data-slug-hash="rpbMQa" data-default-tab="result" data-user="thebabydino" data-embed-version="2" data-pen-title="oscillating box - step #1 (moving box to left)" class="codepen">See the <a href="http://codepen.io/thebabydino/pen/rpbMQa/">Pen</a> by thebabydino (<a href="http://codepen.io/thebabydino">@thebabydino</a>) on <a href="http://codepen.io">CodePen</a>.</p>
<p>Now the left half of the box is outside the screen. Decreasing the absolute amount of translation by half its edge length puts it fully within the viewport while decreasing it by anything more, let&#8217;s say a full edge length (which is <code>$d</code> or <code>100%</code>&mdash;remember that <code>%</code> values in <code>translate()</code> functions are <a href="https://css-tricks.com/state-responsive-3d-shapes/#article-header-id-1">relative to the dimensions of the element being translated</a>), makes it not even touch the left edge of the viewport anymore.</p>
<pre rel="SCSS"><code class="language-scss">transform: translate(calc(-1*(50vw - 100%)));</code></pre>
<p data-height="165" style="height: 165px; display: flex; align-items: center; justify-content: center; border: 2px solid black; margin: 1rem 0; padding: 1rem; overflow: auto;" data-theme-id="1" data-slug-hash="VyNKOM" data-default-tab="result" data-user="thebabydino" data-embed-version="2" data-pen-title="oscillating box - step #2 (initial animation position)" class="codepen">See the <a href="http://codepen.io/thebabydino/pen/VyNKOM/">Pen</a> by thebabydino (<a href="http://codepen.io/thebabydino">@thebabydino</a>) on <a href="http://codepen.io">CodePen</a>.</p>
<p>This is going to be our initial animation position.</p>
<p>We then create a set of <code>@keyframes</code> to move the box to the symmetrical position with respect to the initial one with no translation and reference them when setting the <code>animation</code>:</p>
<pre rel="SCSS"><code class="language-scss">$t: 1.5s;

.box {
  /* same styles as before */
  animation: move $t ease-in-out infinite alternate;
}

@keyframes move {
  to { transform: translate(calc(50vw - 100%)); }
}</code></pre>
<p>This all works as expected, giving us a box that moves from left to right and back:</p>
<p data-height="165" style="height: 165px; display: flex; align-items: center; justify-content: center; border: 2px solid black; margin: 1rem 0; padding: 1rem; overflow: auto;" data-preview="true" data-theme-id="1" data-slug-hash="eyoBOp" data-default-tab="result" data-user="thebabydino" data-embed-version="2" data-pen-title="oscillating box" class="codepen">See the <a href="http://codepen.io/thebabydino/pen/eyoBOp/">Pen</a> by thebabydino (<a href="http://codepen.io/thebabydino">@thebabydino</a>) on <a href="http://codepen.io">CodePen</a>.</p>
<p>But this is a pretty boring animation, so let&#8217;s make it more interesting. Let&#8217;s say we want the box to be scaled down to a factor of <code>.1</code> when it&#8217;s in the middle and have its normal size at the two ends. We could add one more keyframe:</p>
<pre rel="SCSS"><code class="language-scss">50% { transform: scale(.1); }</code></pre>
<p>The box now also scales (<a href="http://codepen.io/thebabydino/pen/WdWowq/">demo</a>), but, since we&#8217;ve added an extra keyframe, the timing function is not applied for the whole animation anymore&mdash;just for the portions in between keyframes. This makes our translation slow in the middle (at <code>50%</code>) as we now also have a keyframe there. So we need to tweak the timing function, both in the <code>animation</code> value and in the <code>@keyframes</code>. In our case, since we want to have an <code>ease-in-out</code> overall, we can split it into one <code>ease-in</code> and one <code>ease-out</code>.</p>
<pre rel="SCSS"><code class="language-scss">.box {
  animation: move $t ease-in infinite alternate;
}

@keyframes move {
  50% {
    transform: scale(.1);
    animation-timing-function: ease-out;
  }
  to { transform: translate(calc(50vw - 100%)); }
}</code></pre>
<p data-height="165" style="height: 165px; display: flex; align-items: center; justify-content: center; border: 2px solid black; margin: 1rem 0; padding: 1rem; overflow: auto;" data-preview="true" data-theme-id="1" data-slug-hash="mpgRqJ" data-default-tab="result" data-user="thebabydino" data-embed-version="2" data-pen-title="oscillating &#038; scaling box - proper timing functions" class="codepen">See the <a href="http://codepen.io/thebabydino/pen/mpgRqJ/">Pen</a> by thebabydino (<a href="http://codepen.io/thebabydino">@thebabydino</a>) on <a href="http://codepen.io">CodePen</a>.</p>
<p>Now all works fine, but what if we wanted different timing functions for the translation and scaling? The timing functions we&#8217;ve set mean the <code>animation</code> is slower at the beginning, faster in the middle and then slower again at the end. What if we wanted this to apply just to the translation, but not to the scale? What if we wanted the scaling to happen fast at the beginning, when it goes from <code>1</code> towards <code>.1</code>, slow in the middle when it&#8217;s around <code>.1</code> and then fast again at the end when it goes back to <code>1</code>?</p>
<figure><img src="https://css-tricks.com/wp-content/uploads/2018/02/ani_tl.svg" alt="SVG illustration. Shows the timeline, highlighting the 0%, 50% and 100% keyframes. At 0%, we want the translation to start slowly, but the scaling to start fast. At 50%, we want the translation to be at its fastest, while the scaling would be at its slowest. At 100%, the translation ends slowly, while the scaling ends fast."/><figcaption>The animation timeline (<a href="https://codepen.io/thebabydino/pen/OQLZbL?editors=1000">live</a>).</figcaption></figure>
<p>Well, it&#8217;s just not possible to set different timing functions for different transform functions in the same chain. We cannot make the translation slow and the scaling fast at the beginning or the other way around in the middle. At least, not while what we animate is the <code>transform</code> property and they&#8217;re part of the same <code>transform</code> chain.</p>
<h3 id='old-workaround'>The Old Workaround</h3>
<p>There are of course ways of going around this issue. Traditionally, the solution has been to split the <code>transform</code> (and consequently, the <code>animation</code>) over multiple elements. This gives us the following structure:</p>
<pre rel="HTML"><code class="language-html">&lt;div class="wrap"&gt;
  &lt;div class="box"&gt;&lt;/div&gt;
&lt;/div&gt;</code></pre>
<p>We move the <code>width</code> property on the wrapper. Since <code>div</code> elements are block elements by default, this will also determine the <code>width</code> of its <code>.box</code> child without us having to set it explicitly. We keep the <code>height</code> on the <code>.box</code> however, as the <code>height</code> of a child (the <code>.box</code> in this case) also determines the <code>height</code> of its parent (the wrapper in this case).</p>
<p>We also move up the <code>margin</code>, <code>transform</code> and <code>animation</code> properties. In addition to this, we switch back to an <code>ease-in-out</code> timing function for this <code>animation</code>. We also modify the <code>move</code> set of <code>@keyframes</code> to what it was initially, so that we get rid of the <code>scale()</code>.</p>
<pre rel="SCSS"><code class="language-scss">.wrap {
  margin: .25*$d calc(50% - #{.5*$d});
  width: $d;
  transform: translate(calc(-1*(50vw - 100%)));
  animation: move $t ease-in-out infinite alternate;
}

@keyframes move {
  to { transform: translate(calc(50vw - 100%)); }
}</code></pre>
<p>We create another set of <code>@keyframes</code> which we use for the actual <code>.box</code> element. This is an alternating <code>animation</code> of half the duration of the one producing the oscillatory motion.</p>
<pre rel="SCSS"><code class="language-scss">.box {
  height: $d;
  background: #f90;
  animation: size .5*$t ease-out infinite alternate;
}

@keyframes size { to { transform: scale(.1); } }</code></pre>
<p>We now have the result we wanted: </p>
<p data-height="165" style="height: 165px; display: flex; align-items: center; justify-content: center; border: 2px solid black; margin: 1rem 0; padding: 1rem; overflow: auto;" data-preview="true" data-theme-id="1" data-slug-hash="MrRBRX" data-default-tab="result" data-user="thebabydino" data-embed-version="2" data-pen-title="oscillating &#038; scaling box - different timing functions, old workaround" class="codepen">See the <a href="http://codepen.io/thebabydino/pen/MrRBRX/">Pen</a> by thebabydino (<a href="http://codepen.io/thebabydino">@thebabydino</a>) on <a href="http://codepen.io">CodePen</a>.</p>
<p>This is a solid workaround that doesn&#8217;t add too much extra code, not to mention the fact that, in this particular case, we don&#8217;t really need two elements, we could do with just one and one of its pseudo-elements. But if our transform chain gets longer, we have no choice but to add extra elements. And, in 2018, we can do better than that!</p>
<h3 id='houdini-solution'>The Houdini Solution</h3>
<p>Some of you may already know that <a href="https://css-tricks.com/tag/css-variables/">CSS variables</a> are not animatable (and I guess anyone who didn&#8217;t just found out). If we try to use them in an <code>animation</code>, they just flip from one value to the other when half the time in between has elapsed.</p>
<p>Consider the initial example of the oscillating box (no scaling involved). Let&#8217;s say we try to animate it using a custom property <code>--x</code>:</p>
<pre rel="SCSS"><code class="language-scss">.box {
  /* same styles as before */
  transform: translate(var(--x, calc(-1*(50vw - #{$d}))));
  animation: move $t ease-in-out infinite alternate
}

@keyframes move { to { --x: calc(50vw - #{$d}) } }</code></pre>
<p>Sadly, this just results in a flip at <code>50%</code>, the official reason being that browsers cannot know the type of the custom property (which doesn&#8217;t make sense to me, but I guess that doesn&#8217;t really matter).</p>
<p data-height="165" style="height: 165px; display: flex; align-items: center; justify-content: center; border: 2px solid black; margin: 1rem 0; padding: 1rem; overflow: auto;" data-preview="true" data-theme-id="1" data-slug-hash="EoJdVg" data-default-tab="result" data-user="thebabydino" data-embed-version="2" data-pen-title="oscillating &#038; scaling box - animating CSS var fail" class="codepen">See the <a href="http://codepen.io/thebabydino/pen/EoJdVg/">Pen</a> by thebabydino (<a href="http://codepen.io/thebabydino">@thebabydino</a>) on <a href="http://codepen.io">CodePen</a>.</p>
<p>But we can forget about all of this because now Houdini has entered the picture and we can register such custom properties so that we explicitly give them a type (the <code>syntax</code>).</p>
<p class="explanation">For more info on this, check out the <a href="https://www.youtube.com/watch?v=66E0_QFnmlA">talk</a> and <a href="http://slides.com/malyw/houdini-codemotion#/28">slides</a> by <a href="https://twitter.com/malyw">Serg Hospodarets</a>.</p>
<pre rel="JavaScript"><code class="language-javascript">CSS.registerProperty({
  name: '--x', 
  syntax: '&lt;length&gt;',
  initialValue: 0, 
  inherits: false
});</code></pre>
<p class="explanation"><code>inherits</code> was optional in the early versions of the spec, but then it became mandatory, so if you find an older Houdini demo that doesn&#8217;t work anymore, it may well be because it doesn&#8217;t explicitly set <code>inherits</code>.</p>
<p>We&#8217;ve set the <code>initialValue</code> to <code>0</code>, because we have to set it to something and that something has to be a <a href="https://drafts.css-houdini.org/css-properties-values-api/#computationally-independent">computationally independent</a> value&mdash;that is, it cannot depend on anything we can set or change in the CSS and, given the initial and final translation values depend on the box dimensions, which we set in the CSS, <code>calc(-1*(50vw - 100%))</code> is not valid here. It doesn&#8217;t even work to set <code>--x</code> to <code>calc(-1*(50vw - 100%))</code>, we need to use <code>calc(-1*(50vw - #{$d}))</code> instead.</p>
<pre rel="SCSS"><code class="language-scss">$d: 4em;
$t: 1.5s;

.box {
  margin: .25*$d auto;
  width: $d; height: $d;
  --x: calc(-1*(50vw - #{$d}));
  transform: translate(var(--x));
  background: #f90;
  animation: move $t ease-in-out infinite alternate;
}

@keyframes move { to { --x: calc(50vw - #{$d}); } }</code></pre>
<figure><img src="https://i1.wp.com/css-tricks.com/wp-content/uploads/2018/02/houdini_demo_simple.gif?ssl=1" alt="Animated gif. Shows a square box oscillating horizontally from left to right and back. The motion is slow at the left and right ends and faster in the middle." data-recalc-dims="1"/><figcaption>The simple oscillating box we get using the new method (<a href="https://codepen.io/thebabydino/pen/BJEqVe">live demo</a>, needs Houdini support).</figcaption></figure>
<p>For now, this only works in Blink browsers behind the <strong>Experimental Web Platform features</strong> flag. This can be enabled from <code>chrome://flags</code> (or, if you&#8217;re using Opera, <code>opera://flags</code>):</p>
<figure><img src="https://i2.wp.com/css-tricks.com/wp-content/uploads/2017/09/scr_chrome_flag_exp_web_platform.png?ssl=1" alt="Screenshot showing the Experimental Web Platform features flag being enabled in Chrome." data-recalc-dims="1"/><figcaption>The Experimental Web Platform features flag enabled in Chrome.</figcaption></figure>
<p>In all other browsers, we still see the flip at <code>50%</code>.</p>
<p>Applying this to our oscillating and scaling demo means we introduce two custom properties we register and animate&mdash;one is the translation amount along the <var>x</var> axis (<code>--x</code>) and the other one is the uniform scaling factor (<code>--f</code>).</p>
<pre rel="JavaScript"><code class="language-javascript">CSS.registerProperty({ /* same as before */ });

CSS.registerProperty({
  name: '--f', 
  syntax: '&lt;number&gt;',
  initialValue: 1, 
  inherits: false
});</code></pre>
<p>The relevant CSS is as follows:</p>
<pre rel="SCSS"><code class="language-scss">.box {
  --x: calc(-1*(50vw - #{$d}));
  transform: translate(var(--x)) scale(var(--f));
  animation: move $t ease-in-out infinite alternate, 
             size .5*$t ease-out infinite alternate;
}

@keyframes move { to { --x: calc(50vw - #{$d}); } }

@keyframes size { to { --f: .1 } }</code></pre>
<figure><img src="https://i2.wp.com/css-tricks.com/wp-content/uploads/2018/02/houdini_demo_double.gif?ssl=1" alt="Animated gif. Shows the same oscillating box from before now also scaling down to 10% when it's right in the middle. The scaling is fast at the beginning and the end and slow in the middle." data-recalc-dims="1"/><figcaption>The oscillating and scaling with the new method (<a href="https://codepen.io/thebabydino/pen/qxWogV">live demo</a>, needs Houdini support).</figcaption></figure>
<h3 id='better-looking-stuff'>Better Looking Stuff</h3>
<p>A simple oscillating and scaling square isn&#8217;t the most exciting thing though, so let&#8217;s see nicer demos!</p>
<figure><img src="https://i2.wp.com/css-tricks.com/wp-content/uploads/2018/02/ex.png?ssl=1" alt="Screenshots of the two demos we dissect here. Left: a rotating wavy rainbow grid of cubes. Right: bouncing square." data-recalc-dims="1"/><figcaption>More interesting examples. Left: rotating wavy grid of cubes. Right: bouncing square.</figcaption></figure>
<h4 id='3d-version'>The 3D version</h4>
<p>Going from 2D to 3D, the square becomes a cube and, since just one cube isn&#8217;t interesting enough, let&#8217;s have a whole grid of them!</p>
<p>We consider the <code>body</code> to be our scene. In this scene, we have a 3D assembly of cubes (<code>.a3d</code>). These cubes are distributed on a grid of <code>nr</code> rows and <code>nc</code> columns:</p>
<pre rel="Pug"><code class="language-pug">- var nr = 13, nc = 13;
- var n = nr*nc;

.a3d
  while n--
    .cube
      - var n6hedron= 6; // cube always has 6 faces
      while n6hedron--
        .cube__face</code></pre>
<p>The first thing we do is a few basic styles to create a scene with a perspective, put the whole assembly in the middle and put each cube face into its place. We won&#8217;t be going into the details of how to build a CSS cube because I&#8217;ve already dedicated <a href="https://css-tricks.com/simplifying-css-cubes-custom-properties/">a very detailed article</a> to this topic, so if you need a recap, check that one out!</p>
<p>The result so far can be seen below &#8211; all the cubes stacked up in the middle of the scene:</p>
<figure><img src="https://i0.wp.com/css-tricks.com/wp-content/uploads/2018/02/ex_0_stack.png?ssl=1" alt="Screenshot. Shows all cubes (as wireframes) in the same position in the middle of the scene, making it look as if there's only one wireframe." data-recalc-dims="1"/><figcaption>All the cubes stacked up in the middle (<a href="https://codepen.io/thebabydino/pen/ZrGagg">live demo</a>).</figcaption></figure>
<p>For all these cubes, their front half is in front of the plane of the screen and their back half is behind the plane of the screen. In the plane of the screen, we have a square section of our cube. This square is identical to the ones representing the cube faces.</p>
<p data-height="265" style="height: 265px; display: flex; align-items: center; justify-content: center; border: 2px solid black; margin: 1rem 0; padding: 1rem; overflow: auto;" data-theme-id="1" data-slug-hash="YeqaKJ" data-default-tab="result" data-user="thebabydino" data-embed-version="2" data-pen-title="cube with section (red, hashed) in plane of screen" class="codepen">See the <a href="http://codepen.io/thebabydino/pen/YeqaKJ/">Pen</a> by thebabydino (<a href="http://codepen.io/thebabydino">@thebabydino</a>) on <a href="http://codepen.io">CodePen</a>.</p>
<p>Next, we set the column (<code>--i</code>) and row (<code>--j</code>) indices on groups of cubes. Initially, we set both these indices to <code>0</code> for all cubes.</p>
<pre rel="SCSS"><code class="language-scss">.cube {
  --i: 0;
  --j: 0;
}</code></pre>
<p>Since we have a number of cubes equal to the number of columns (<code>nc</code>) on every row, we then set the row index to <code>1</code> for all cubes after the first <code>nc</code> ones. Then, for all cubes after the first <code>2*nc</code> ones, we set the row index to <code>2</code>. And so on, until we&#8217;ve covered all <code>nr</code> rows:</p>
<pre rel="Pug"><code class="language-pug">style
  | .cube:nth-child(n + #{1*nc + 1}) { --j: 1 }
  | .cube:nth-child(n + #{2*nc + 1}) { --j: 2 }
  //- and so on
  | .cube:nth-child(n + #{(nr - 1)*nc + 1}) { --j: #{nr - 1} }</code></pre>
<p>We can compact this in a loop:</p>
<pre rel="Pug"><code class="language-pug">style
  - for(var i = 1; i &lt; nr; i++) {
    | .cube:nth-child(n + #{i*nc + 1}) { --j: #{i} }
  -}</code></pre>
<p>Afterwards, we move on to setting the column indices. For the columns, we always need to skip a number of cubes equal to <code>nc - 1</code> before we encounter another cube with the same index. So, for every cube, the <code>nc</code>-th cube after it is going to have the same index and we&#8217;re going to have <code>nc</code> such groups of cubes.</p>
<p>(We only need to set the index to the last <code>nc - 1</code>, because all cubes have the column index set to <code>0</code> initially, so we can skip the first group containing the cubes for which the column index is <code>0</code> &#8211; no need to set <code>--i</code> again to the same value it already has.)</p>
<pre rel="Pug"><code class="language-pug">style
  | .cube:nth-child(#{nc}n + 2) { --i: 1 }
  | .cube:nth-child(#{nc}n + 3) { --i: 2 }
  //- and so on
  | .cube:nth-child(#{nc}n + #{nc}) { --i: #{nc - 1} }</code></pre>
<p>This, too, can be compacted in a loop:</p>
<pre rel="Pug"><code class="language-pug">style
  - for(var i = 1; i &lt; nc; i++) {
    | .cube:nth-child(#{nc}n + #{i + 1}) { --i: #{i} }
  -}</code></pre>
<p>Now that we have all the row and column indices set, we can distribute these cubes on a 2D grid in the plane of the screen using a 2D <code>translate()</code> transform, according to the illustration below, where each cube is represented by its square section in the plane of the screen and the distances are measured in between <code>transform-origin</code> points (which are, by default, at <code>50% 50% 0</code>, so dead in the middle of the square cube sections from the plane of the screen):</p>
<figure><img src="https://css-tricks.com/wp-content/uploads/2018/02/base_grid_off.svg" alt="SVG illustration. Shows how to create a basic grid of square, vertical cube sections with nc columns and nr rows starting from the position of the top left item. The top left item is on the first column (of index <code>0</code>) and on the first row (of index <code>0</code>). All items on the second column (of index <code>1</code>) are offset horizontally by and edge length. All items on the third column (of index <code>2</code>) are offset horizontally by two edge lengths. In general, all items on the column of index <code>i</code> are offset horizontally by <code>i</code> edge lengths. All items on the last column (of index <code>nc - 1</code>) are offset horizontally by <code>nc - 1</code> edge lengths. All items on the second row (of index <code>1</code>) are offset vertically by and edge length. All items on the third row (of index <code>2</code>) are offset vertically by two edge lengths. In general, all items on the row of index <code>j</code> are offset vertically by <code>j</code> edge lengths. All items on the last row (of index <code>nr - 1</code>) are offset vertically by <code>nr - 1</code> edge lengths.&#8221;/><figcaption>How to create a basic grid starting from the position of the top left item (<a href="https://codepen.io/thebabydino/pen/JpXLLm">live</a>).</figcaption></figure>
<pre rel="SCSS"><code class="language-scss">/* $l is the cube edge length */
.cube {
  /* same as before */
  --x: calc(var(--i)*#{$l});
  --y: calc(var(--j)*#{$l});
  transform: translate(var(--x), var(--y));
}</code></pre>
<p>This gives us a grid, but it&#8217;s not in the middle of the screen.</p>
<figure><img src="https://i0.wp.com/css-tricks.com/wp-content/uploads/2018/02/ex_0_grid_off.png?ssl=1" alt="Screenshot. Shows the grid with nc columns and nr rows, with cubes repersented as wireframes. The midpoint of the top left cube of the rectangular grid is dead in the middle of the screen.." data-recalc-dims="1"/><figcaption>The grid, having the midpoint of the top left cube in the middle of the screen (<a href="https://codepen.io/thebabydino/pen/WMpgzN">live demo</a>).</figcaption></figure>
<p>Right now, it&#8217;s the central point of the top left cube that&#8217;s in the middle of the screen, as highlighted in the demo above. What we want is for the grid to be in the middle, meaning that we need to shift all cubes left and up (in the negative direction of both the <var>x</var> and <var>y</var> axes) by the horizontal and vertical differences between half the grid dimensions (<code>calc(.5*var(--nc)*#{$l})</code> and <code>calc(.5*var(--nr)*#{$l})</code>, respectively) and the distances between the top left corner of the grid and the midpoint of the top left cube&#8217;s vertical cross-section in the plane of the screen (these distances are each half the cube edge, or <code>.5*$l</code>).</p>
<figure><img src="https://css-tricks.com/wp-content/uploads/2018/02/base_grid_mid.svg" alt=""/><figcaption>The difference between the position of the grid midpoint and the top left item midpoint (<a href="https://codepen.io/thebabydino/pen/EQWreO">live</a>).</figcaption></figure>
<p>Subtracting these differences from the previous amounts, our code becomes:</p>
<pre rel="SCSS"><code class="language-scss">.cube {
  /* same as before */
  --x: calc(var(--i)*#{$l} - (.5*var(--nc)*#{$l} - .5*#{$l}));
  --y: calc(var(--j)*#{$l} - (.5*var(--nr)*#{$l} - .5*#{$l}));
}</code></pre>
<p>Or even better:</p>
<pre rel="SCSS"><code class="language-scss">.cube {
  /* same as before */
  --x: calc((var(--i) - .5*(var(--nc) - 1))*#{$l}));
  --y: calc((var(--j) - .5*(var(--nr) - 1))*#{$l}));
}</code></pre>
<p>We also need to make sure we set the <code>--nc</code> and <code>--nr</code> custom properties:</p>
<pre rel="Pug"><code class="language-pug">- var nr = 13, nc = 13;
- var n = nr*nc;

//- same as before
.a3d(style=`--nc: ${nc}; --nr: ${nr}`)
  //- same as before</code></pre>
<p>This gives us a grid that&#8217;s in the middle of the viewport:</p>
<figure><img src="https://i2.wp.com/css-tricks.com/wp-content/uploads/2018/02/ex_0_grid_mid.png?ssl=1" alt="Screenshot. Shows a grid of cube wireframes right in the middle." data-recalc-dims="1"/><figcaption>The grid is now in the middle (<a href="https://codepen.io/thebabydino/pen/WMpmLY">live</a>).</figcaption></figure>
<p>We&#8217;ve also made the cube edge length <code>$l</code> smaller so that the grid fits within the viewport.</p>
<p>Alternatively, we can go for a CSS variable <code>--l</code> instead so that we can control the edge length depending on the number of columns and rows. The first step here is setting the maximum of the two to a <code>--nmax</code> variable:</p>
<pre rel="Pug"><code class="language-pug">- var nr = 13, nc = 13;
- var n = nr*nc;

//- same as before
.a3d(style=`--nc: ${nc}; --nr: ${nr}; --max: ${Math.max(nc, nr)}`)
  //- same as before</code></pre>
<p>Then, we set the edge length (<code>--l</code>) to something like <code>80%</code> (completely arbitrary value) of the minimum viewport dimension over this maximum (<code>--max</code>):</p>
<pre rel="SCSS"><code class="language-scss">.cube {
  /* same as before */
  --l: calc(80vmin/var(--max));
}</code></pre>
<p>Finally, we update the cube and face transforms, the face dimensions and <code>margin</code> to use <code>--l</code> instead of <code>$l</code>:</p>
<pre rel="SCSS"><code class="language-scss">.cube {
  /* same as before */
  --l: calc(80vmin/var(--max));
  --x: calc((var(--i) - .5*(var(--nc) - 1))*var(--l));
  --y: calc((var(--j) - .5*(var(--nr) - 1))*var(--l));
	
  &amp;__face {
    /* same as before */
    margin: calc(-.5*var(--l));
    width: var(--l); height: var(--l);
    transform: rotate3d(var(--i), var(--j), 0, calc(var(--m, 1)*#{$ba4gon})) 
               translatez(calc(.5*var(--l)));
  }
}</code></pre>
<p>Now we have a nice responsive grid!</p>
<figure><img src="https://i1.wp.com/css-tricks.com/wp-content/uploads/2018/02/ex_0_grid_resp.gif?ssl=1" alt="Animated gif. Shows the previously created grid scaling with the viewport." data-recalc-dims="1"/><figcaption>The grid is now in the middle and responsive such that it always fits within the viewport (<a href="https://codepen.io/thebabydino/pen/jZBRMg">live</a>).</figcaption></figure>
<p>But it&#8217;s an ugly one, so let&#8217;s turn it into a pretty rainbow by making the <code>color</code> of each cube depend on its column index (<code>--i</code>):</p>
<pre rel="SCSS"><code class="language-scss">.cube {
  /* same as before */
  color: hsl(calc(var(--i)*360/var(--nc)), 65%, 65%);
}</code></pre>
<figure><img src="https://i1.wp.com/css-tricks.com/wp-content/uploads/2018/02/ex_0_grid_rainbow.png?ssl=1" alt="Screenshot. The assembly wireframe has now a rainbow look, with every column of cubes having a different hue." data-recalc-dims="1"/><figcaption>The rainbow grid (<a href="https://codepen.io/thebabydino/pen/XZMQZp">live demo</a>).</figcaption></figure>
<p>We&#8217;ve also made the scene background dark so that we have better contrast with the now lighter cube edges.</p>
<p>To spice things up even further, we add a row rotation around the <var>y</var> axis depending on the row index (<code>--j</code>):</p>
<pre rel="SCSS"><code class="language-scss">.cube {
  /* same as before */
  transform: rotateY(calc(var(--j)*90deg/var(--nr))) 
             translate(var(--x), var(--y));
}</code></pre>
<figure><img src="https://i1.wp.com/css-tricks.com/wp-content/uploads/2018/02/ex_0_grid_twist.png?ssl=1" alt="Screenshot. The assembly wireframe now appears twisted, with every row being rotated at a different angle, increasing from top to bottom." data-recalc-dims="1"/><figcaption>The twisted grid (<a href="https://codepen.io/thebabydino/pen/qxrwMx">live demo</a>).</figcaption></figure>
<p>We&#8217;ve also decreased the cube edge length <code>--l</code> and increased the <code>perspective</code> value in order to allow this twisted grid to fit in.</p>
<p>Now comes the fun part! For every cube, we animate its position back and forth along the <var>z</var> axis by half the grid width (we make the <code>translate()</code> a <code>translate3d()</code> and use an additional custom property <code>--z</code> that goes between <code>calc(.5*var(--nc)*var(--l))</code> and <code>calc(-.5*var(--nc)*var(--l))</code>) and its size (via a uniform <code>scale3d()</code> of factor <code>--f</code> that goes between <code>1</code> and <code>.1</code>). This is pretty much the same thing we did for the square in our original example, except the motion now happens along the <var>z</var> axis, not along the <var>x</var> axis and the scaling happens in 3D, not just in 2D.</p>
<pre rel="SCSS"><code class="language-scss">$t: 1s;

.cube {
  /* same as before */
  --z: calc(var(--m)*.5*var(--nc)*var(--l));
  transform: rotateY(calc(var(--j)*90deg/var(--nr))) 
             translate3d(var(--x), var(--y), var(--z)) 
             scale3d(var(--f), var(--f), var(--f));
  animation: a $t ease-in-out infinite alternate;
  animation-name: move, zoom;
  animation-duration: $t, .5*$t;
}

@keyframes move { to { --m: -1 } }

@keyframes zoom { to { --f: .1 } }</code></pre>
<p>This doesn&#8217;t do anything until we register the multiplier <code>--m</code> and the scaling factor <code>--f</code> to give them a type and an initial value:</p>
<pre rel="JavaScript"><code class="language-javascript">CSS.registerProperty({
  name: '--m', 
  syntax: '&lt;number&gt;',
  initialValue: 1, 
  inherits: false
});

CSS.registerProperty({
  name: '--f', 
  syntax: '&lt;number&gt;',
  initialValue: 1, 
  inherits: false
});</code></pre>
<figure><img src="https://i0.wp.com/css-tricks.com/wp-content/uploads/2018/02/ex_0_grid_mov.gif?ssl=1" alt="Animated gif. Every cube now moves back and forth along its own z axis (post row rotation), between half a grid width behind its xOy plane and half a grid width in front of its xOy plane. Each cube also scales along all three axes, going from its initial size to a tenth of it along each axis and then back to its initial size." data-recalc-dims="1"/><figcaption>The animated grid (<a href="https://codepen.io/thebabydino/pen/mXWZEO">live demo</a>, needs Houdini support).</figcaption></figure>
<p>At this point, all cubes animate at the same time. To make things more interesting, we add a delay that depends on both the column and row index:</p>
<pre rel="SCSS"><code class="language-scss">animation-delay: calc((var(--i) + var(--j))*#{-2*$t}/(var(--nc) + var(--nr)));</code></pre>
<figure><img src="https://i2.wp.com/css-tricks.com/wp-content/uploads/2018/02/ex_0_grid_wave.png?ssl=1" alt="Screenshot" data-recalc-dims="1"/><figcaption>The waving grid effect (<a href="https://codepen.io/thebabydino/pen/EQWBwY">live</a>).</figcaption></figure>
<p>The final touch is to add a rotation on the 3D assembly:</p>
<pre rel="SCSS"><code class="language-scss">.a3d {
  top: 50%; left: 50%;
  animation: ry 8s linear infinite;
}

@keyframes ry { to { transform: rotateY(1turn); } }</code></pre>
<p>We also make the faces opaque by giving them a black background and we have the final result:</p>
<figure><img src="https://i2.wp.com/css-tricks.com/wp-content/uploads/2018/02/ex_0_grid_fin.gif?ssl=1" alt="Animated gif. Now the cube faces are opaque (we've given them a black background) whole assembly rotates around its y axis, making the animation more interesting." data-recalc-dims="1"/><figcaption>The final result (<a href="https://codepen.io/thebabydino/pen/yvMdKZ">live demo</a>, needs Houdini support).</figcaption></figure>
<p>The performance for this is pretty bad, as it can be seen from the GIF recording above, but it&#8217;s still interesting to see how far we can push things.</p>
<h4 id='hopping-square'>Hopping Square</h4>
<p>I came across <a href="https://codepen.io/roydigerhund/pen/jqJvWK">the original</a> in <a href="https://css-tricks.com/making-css-animations-feel-natural/#comment-1614273">a comment</a> to another article and, as soon as I saw the code, I thought it was the perfect candidate for a makeover using some Houdini magic!</p>
<p>Let&#8217;s start by understanding what is happening in the original code.</p>
<p>In the HTML, we have nine divs.</p>
<pre rel="HTML"><code class="language-html"><!-- original HTML -->
&lt;div class="frame"&gt;
  &lt;div class="center"&gt;
    &lt;div class="down"&gt;
      &lt;div class="up"&gt;
        &lt;div class="squeeze"&gt;
          &lt;div class="rotate-in"&gt;
            &lt;div class="rotate-out"&gt;
              &lt;div class="square"&gt;&lt;/div&gt;
            &lt;/div&gt;
          &lt;/div&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;
    &lt;div class="shadow"&gt;&lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;</code></pre>
<p>Now, this animation is a lot more complex than anything I could ever come up with, but, even so, nine elements seems to be overkill. So let&#8217;s take a look at the CSS, see what they&#8217;re each used for and see how much we can simplify the code in preparation for switching to the Houdini-powered solution.</p>
<p>Let&#8217;s start with the animated elements. The <code>.down</code> and <code>.up</code> elements each have an <code>animation</code> related to moving the square vertically:</p>
<pre rel="SCSS"><code class="language-scss">/* original */
.down {
  position: relative;
  animation: down $duration ease-in infinite both;

  .up {
    animation: up $duration ease-in-out infinite both;
    /* the rest */
  }
}

@keyframes down {
  0% {
    transform: translateY(-100px);
  }
  20%, 100% {
    transform: translateY(0);
  }
}

@keyframes up {
  0%, 75% {
    transform: translateY(0);
  }
  100% {
    transform: translateY(-100px);
  }
}</code></pre>
<p>With <code>@keyframes</code> and animations on both elements having the same duration, we can pull off a make-one-out-of-two trick.</p>
<p>In the case of the first set of <code>@keyframes</code>, all the action (going from <code>-100px</code> to <code>0</code>) happens in the <code>[0%, 20%]</code> interval, while, in the case of the second one, all the action (going from <code>0</code> to <code>-100px</code>) happens in the <code>[75%, 100%]</code> interval. These two intervals don&#8217;t intersect. Because of this and because both animations have the same duration we can add up the translation values at each keyframe.</p>
<ul>
<li>at <code>0%</code>, we have <code>-100px</code> from the first set of <code>@keyframes</code> and <code>0</code> from the second, which gives us <code>-100px</code></li>
<li>at <code>20%</code>, we have <code>0</code> from the first set of <code>@keyframes</code> and <code>0</code> from the second (as we have <code>0</code> for any frame from <code>0%</code> to <code>75%</code>), which gives us <code>0</code></li>
<li>at <code>75%</code>, we have <code>0</code> from the first set of <code>@keyframes</code> (as we have <code>0</code> for any frame from <code>20%</code> to <code>100%</code>) and <code>0</code> from the second, which gives us <code>0</code></li>
<li>at <code>100%</code>, we have <code>0</code> from the first set of <code>@keyframes</code> and <code>-100px</code> from the second, which gives us <code>-100px</code></li>
</ul>
<p>Our new code is as follows. We have removed the <code>animation-fill-mode</code> from the shorthand as it doesn&#8217;t do anything in this case since our <code>animation</code> loops infinitely, has a non-zero duration and no delay:</p>
<pre rel="SCSS"><code class="language-scss">/* new */
.jump {
  position: relative;
  transform: translateY(-100px);
  animation: jump $duration ease-in infinite;
  /* the rest */
}

@keyframes jump {
  20%, 75% { 
    transform: translateY(0);
    animation-timing-function: ease-in-out;
  }
}</code></pre>
<p>Note that we have different timing functions for the two animations, so we need to switch between them in the <code>@keyframes</code>. We still have the same effect, but we got rid of one element and one set of <code>@keyframes</code>.</p>
<p>Next, we do the same thing for the <code>.rotate-in</code> and <code>.rotate-out</code> elements and their <code>@keyframes</code>:</p>
<pre rel="SCSS"><code class="language-scss">/* original */
.rotate-in {
  animation: rotate-in $duration ease-out infinite both;

  .rotate-out {
    animation: rotate-out $duration ease-in infinite both;
  }
}

@keyframes rotate-in {
  0% {
    transform: rotate(-135deg);
  }
  20%, 100% {
    transform: rotate(0deg);
  }
}

@keyframes rotate-out {
  0%, 80% {
    transform: rotate(0);
  }
  100% {
    transform: rotate(135deg);
  }
}</code></pre>
<p>In a similar manner to the previous case, we add up the rotation values for each keyframe.</p>
<ul>
<li>at <code>0%</code>, we have <code>-135deg</code> from the first set of <code>@keyframes</code> and <code>0deg</code> from the second, which gives us <code>-135deg</code></li>
<li>at <code>20%</code>, we have <code>0deg</code> from the first set of <code>@keyframes</code> and <code>0deg</code> from the second (as we have <code>0deg</code> for any frame from <code>0%</code> to <code>80%</code>), which gives us <code>0deg</code></li>
<li>at <code>80%</code>, we have <code>0deg</code> from the first set of <code>@keyframes</code> (as we have <code>0deg</code> for any frame from <code>20%</code> to <code>100%</code>) and <code>0deg</code> from the second, which gives us <code>0deg</code></li>
<li>at <code>100%</code>, we have <code>0deg</code> from the first set of <code>@keyframes</code> and <code>135deg</code> from the second, which gives us <code>135deg</code></li>
</ul>
<p>This means we can compact things to:</p>
<pre rel="SCSS"><code class="language-scss">/* new */
.rotate {
  transform: rotate(-135deg);
  animation: rotate $duration ease-out infinite;
}

@keyframes rotate {
  20%, 80% {
    transform: rotate(0deg);
    animation-timing-function: ease-in;
  }
  100% { transform: rotate(135deg); }
}</code></pre>
<p>We only have one element with a scaling <code>transform</code> that distorts our white square:</p>
<pre rel="SCSS"><code class="language-scss">/* original */
.squeeze {
  transform-origin: 50% 100%;
  animation: squeeze $duration $easing infinite both;
}

@keyframes squeeze {
  0%, 4% {
    transform: scale(1);
  }
  45% {
    transform: scale(1.8, 0.4);
  }
  100% {
    transform: scale(1);
  }
}</code></pre>
<p>There&#8217;s not really much we can do here in terms of compacting the code, save for removing the <code>animation-fill-mode</code> and grouping the <code>100%</code> keyframe with the <code>0%</code> and <code>4%</code> ones:</p>
<pre rel="SCSS"><code class="language-scss">/* new */
.squeeze {
  transform-origin: 50% 100%;
  animation: squeeze $duration $easing infinite;
}

@keyframes squeeze {
  0%, 4%, 100% { transform: scale(1); }
  45% { transform: scale(1.8, .4); }
}</code></pre>
<p>The innermost element (<code>.square</code>) is only used to display the white box and has no <code>transform</code> set on it.</p>
<pre rel="SCSS"><code class="language-css"> /* original */
.square {
  width: 100px;
  height: 100px;
  background: #fff;
}</code></pre>
<p>This means we can get rid of it if we move its styles to its parent element.</p>
<pre rel="SCSS"><code class="language-css">/* new */
$d: 6.25em;

.rotate {
  width: $d; height: $d;
  transform: rotate(-135deg);
  background: #fff;
  animation: rotate $duration ease-out infinite;
}</code></pre>
<p>We got rid of three elements so far and our structure has become:</p>
<pre rel="Haml"><code class="language-haml">.frame
  .center
    .jump
      .squeeze
        .rotate
    .shadow</code></pre>
<p>The outermost element (<code>.frame</code>) serves as a scene or container. This is the big blue square.</p>
<pre rel="SCSS"><code class="language-css">/* original */
.frame {
  position: absolute;
  top: 50%;
  left: 50%;
  width: 400px;
  height: 400px;
  margin-top: -200px;
  margin-left: -200px;
  border-radius: 2px;
  box-shadow: 1px 2px 10px 0px rgba(0,0,0,0.2);
  overflow: hidden;
  background: #3498db;
  color: #fff;
  font-family: 'Open Sans', Helvetica, sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}</code></pre>
<p>There&#8217;s no text in this demo, so we can get rid of the text-related properties. We can also get rid of the <code>color</code> property since, not only do we not have text anywhere in this demo, but we&#8217;re also not using this for any borders, shadows, backgrounds (via <code>currentColor</code>) and so on.</p>
<p>We can also avoid taking this containing element out of the document flow by using a flexbox layout on the <code>body</code>. This also eliminates the offsets and the <code>margin</code> properties.</p>
<pre rel="SCSS"><code class="language-scss">/* new */
$s: 4*$d;

body {
  display: flex;
  align-items: center;
  justify-content: center;
  height: 100vh;
}

.frame {
  overflow: hidden;
  position: relative;
  width: $s; height: $s;
  border-radius: 2px;
  box-shadow: 1px 2px 10px rgba(#000, .2);
  background: #3498db;
}</code></pre>
<p>We&#8217;ve also tied the dimensions of this element to those of the hopping square.</p>
<p>The <code>.center</code> element is only used for positioning its direct children (<code>.jump</code> and <code>.shadow</code>), so we can take it out altogether and use the offsets on it directly on these children.</p>
<p>We use absolute positioning on all <code>.frame</code> descendants. This makes the <code>.jump</code> and <code>.squeeze</code> elements <code>0x0</code> boxes, so we tweak the <code>transform-origin</code> for the squeezing <code>transform</code> (<code>100%</code> of <code>0</code> is always <code>0</code>, but the value we want is half the square edge length <code>.5*$d</code>). We also set a <code>margin</code> of minus half the square edge length (<code>-.5*$d</code>) on the <code>.rotate</code> element (to compensate for the <code>translate(-50%, -50%)</code> we had on the removed <code>.center</code> element).</p>
<pre rel="SCSS"><code class="language-scss">/* new */
.frame * { position: absolute, }

.jump {
  top: $top; left: $left;
  /* same as before */
}

.squeeze {
  transform-origin: 50% .5*$d;
  /* same as before */
}

.rotate {
  margin: -.5*$d;
  /* same as before */
}</code></pre>
<p>Finally, let&#8217;s take a look at the <code>.shadow</code> element.</p>
<pre rel="SCSS"><code class="language-scss">/* original */
.shadow {
  position: absolute;
  z-index: -1;
  bottom: -2px;
  left: -4px;
  right: -4px;
  height: 2px;
  border-radius: 50%;
  background: rgba(0,0,0,0.2);
  box-shadow: 0 0 0px 8px rgba(0,0,0,0.2);
  animation: shadow $duration ease-in-out infinite both;
}

@keyframes shadow {
  0%, 100% {
    transform: scaleX(.5);
  }
  45%, 50% {
    transform: scaleX(1.8);
  }
}</code></pre>
<p>We&#8217;re of course removing the position since we&#8217;ve already set that for all descendants of the <code>.frame</code>. We can also get rid of the <code>z-index</code> if we move the <code>.shadow</code> before the <code>.jump</code> element in the DOM.</p>
<p>Next, we have the offsets. The midpoint of the shadow is offset by <code>$left</code> (just like the <code>.jump</code> element) horizontally and by <code>$top</code> plus half a square edge length (<code>.5*$d</code>) vertically.</p>
<p>We see a <code>height</code> that&#8217;s set to <code>2px</code>. Along the other axis, the <code>width</code> computes to the square&#8217;s edge length (<code>$d</code>) plus <code>4px</code> from the <code>left</code> and <code>4px</code> from the <code>right</code>. That&#8217;s plus <code>8px</code> in total. But one thing we notice is that the <code>box-shadow</code> with an <code>8px</code> spread and no blur is just an extension of the <code>background</code>. So we can just increase the dimensions of the our element by twice the spread along both axes and get rid of the <code>box-shadow</code> altogether.</p>
<p>Just like in the case of the other elements, we also get rid of the <code>animation-fill-mode</code> from the <code>animation</code> shorthand:</p>
<pre rel="SCSS"><code class="language-scss">/* new */
.shadow {
  margin: .5*($d - $sh-h) (-.5*$sh-w);
  width: $sh-w; height: $sh-h;
  border-radius: 50%;
  transform: scaleX(.5);
  background: rgba(#000, .2);
  animation: shadow $duration ease-in-out infinite;
}

@keyframes shadow {
  45%, 50% { transform: scaleX(1.8); }
}</code></pre>
<p>We&#8217;ve now reduced the code in the original demo by about <strong>40%</strong> while still getting the same result.</p>
<p data-height="525" style="height: 525px; display: flex; align-items: center; justify-content: center; border: 2px solid black; margin: 1rem 0; padding: 1rem; overflow: auto;" data-preview="true" data-theme-id="1" data-slug-hash="goJWVy" data-default-tab="result" data-user="thebabydino" data-embed-version="2" data-pen-title="Hopping square - compact cross-browser version" class="codepen">See the <a href="http://codepen.io/thebabydino/pen/goJWVy/">Pen</a> by thebabydino (<a href="http://codepen.io/thebabydino">@thebabydino</a>) on <a href="http://codepen.io">CodePen</a>.</p>
<p>Our next step is to merge the <code>.jump</code>, <code>.squeeze</code> and <code>rotate</code> components into one, so that we go from three elements to a single one. Just as a reminder, the relevant styles we have at this point are:</p>
<pre rel="SCSS"><code class="language-scss">.jump {
  transform: translateY(-100px);
  animation: jump $duration ease-in infinite;
}

.squeeze {
  transform-origin: 50% .5*$d;
  animation: squeeze $duration $easing infinite;
}

.rotate {
  transform: rotate(-135deg);
  animation: rotate $duration ease-out infinite;
}

@keyframes jump {
  20%, 75% { 
    transform: translateY(0);
    animation-timing-function: ease-in-out;
  }
}

@keyframes squeeze {
  0%, 4%, 100% { transform: scale(1); }
  45% { transform: scale(1.8, .4); }
}

@keyframes rotate {
  20%, 80% {
    transform: rotate(0deg);
    animation-timing-function: ease-in;
  }
  100% { transform: rotate(135deg); }
}</code></pre>
<p>The only problem here is that the scaling <code>transform</code> has a <code>transform-origin</code> that&#8217;s different from the default <code>50% 50%</code>. Fortunately, we can go around that.</p>
<p>Any <code>transform</code> with a <code>transform-origin</code> different from the default is equivalent to a <code>transform</code> chain with default <code>transform-origin</code> that first translates the element such that its default <code>transform-origin</code> point (the <code>50% 50%</code> point in the case of HTML elements and the <code>0 0</code> point of the <code>viewBox</code> <a href="https://css-tricks.com/transforms-on-svg-elements/">in the case of SVG elements</a>) goes to the desired <code>transform-origin</code>, applies the actual transformation we want (scaling, rotation, shearing, a combination of these&#8230; doesn&#8217;t matter) and then applies the reverse translation (the values for each of the axes of coordinates are multiplied by <code>-1</code>).</p>
<figure><video controls src="https://css-tricks.com/wp-content/uploads/2018/02/chain_equiv_to_trf_orig.mp4"></video><figcaption>
Any transform with a <code>transform</code> with a <code>transform-origin</code> different from the default is equivalent to a chain that translates the point of the default <code>transform-origin</code> to that of the custom one, performs the desired <code>transform</code> and then reverses the initial translation (<a href="https://codepen.io/thebabydino/pen/gvjZGe/">live demo</a>).</figcaption></figure>
<p>Putting this into code means that if we have any <code>transform</code> with <code>transform-origin: $x1 $y1</code>, the following two are equivalent:</p>
<pre rel="SCSS"><code class="language-scss">/* transform on HTML element with transform-origin != default */

transform-origin: $x1 $y1;
transform: var(--transform); /* can be rotation, scaling, shearing */

/* equivalent transform chain on HTML element with default transform-origin */
transform: translate(calc(#{$x1} - 50%), calc(#{$y1} - 50%))
           var(--transform)
           translate(calc(50% - #{$x1}), calc(50% - $y1);</code></pre>
<p>In our particular case, we have the default <code>transform-origin</code> value along the <var>x</var> axis, so we only need to perform a translation along the <var>y</var> axis. By also replacing the hardcoded values with variables, we get the following transform chain:</p>
<pre rel="SCSS"><code class="language-scss">transform: translateY(var(--y))
  translateY(.5*$d) scale(var(--fx), var(--fy)) translateY(-.5*$d)
  rotate(var(--az));</code></pre>
<p>We can compact this a bit by joining the first two translations:</p>
<pre rel="SCSS"><code class="language-scss">transform: translateY(calc(var(--y) + #{.5*$d}))
  scale(var(--fx), var(--fy)) translateY(-.5*$d)
  rotate(var(--az));</code></pre>
<p>We also put the three animations on the three elements into just one:</p>
<pre rel="SCSS"><code class="language-scss">animation: jump $duration ease-in infinite, 
  squeeze $duration $easing infinite, 
  rotate $duration ease-out infinite;</code></pre>
<p>And we modify the <code>@keyframes</code> so that we now animate the newly-introduced custom properties <code>--y</code>, <code>--fx</code>, <code>--fy</code> and <code>--az</code>:</p>
<pre rel="SCSS"><code class="language-scss">@keyframes jump {
  20%, 75% { 
    --y: 0;
    animation-timing-function: ease-in-out;
  }
}

@keyframes squeeze {
  0%, 4%, 100% { --fx: 1; --fy: 1 }
  45% { --fx: 1.8; --fy: .4 }
}

@keyframes rotate {
  20%, 80% {
    --az: 0deg;
    animation-timing-function: ease-in;
  }
  100% { --az: 135deg }
}</code></pre>
<p>However, this won&#8217;t work unless we register these CSS variables we have introduced and want to animate:</p>
<pre rel="JavaScript"><code class="language-javascript">CSS.registerProperty({
  name: '--y', 
  syntax: '&lt;length&gt;',
  initialValue: '-100px', 
  inherits: false
});

CSS.registerProperty({
  name: '--fx', 
  syntax: '&lt;number&gt;',
  initialValue: 1, 
  inherits: false
});

/* exactly the same for --fy */

CSS.registerProperty({
  name: '--az', 
  syntax: '&lt;angle&gt;',
  initialValue: '-135deg', 
  inherits: false
});</code></pre>
<p>We now have a working demo of the method animating CSS variables. But given that our structure is now one wrapper with two children, we can reduce it further to one element and two pseudo-elements, thus getting the final version which can be seen below. It&#8217;s worth noting that this only works in Blink browsers with the Experimental Web Platform features flag enabled.</p>
<figure><img src="https://i0.wp.com/css-tricks.com/wp-content/uploads/2018/02/ex_1_box_fin.gif?ssl=1" alt="Animated gif. The square rotates in the air, falls down and gets squished against the ground, then bounces back up and the cycle repeats." data-recalc-dims="1"/><figcaption>The final result (<a href="https://codepen.io/thebabydino/pen/MrZvNm">live</a>, needs Houdini support)</figcaption></figure>
<p>The post <a rel="nofollow" href="https://css-tricks.com/what-houdini-means-for-animating-transforms/">What Houdini Means for Animating Transforms</a> appeared first on <a rel="nofollow" href="https://css-tricks.com">CSS-Tricks</a>.</p>
]]></content:encoded>
					
					<wfw:commentRss>https://css-tricks.com/what-houdini-means-for-animating-transforms/feed/</wfw:commentRss>
			<slash:comments>3</slash:comments>
		
		<enclosure url="https://css-tricks.com/wp-content/uploads/2018/02/chain_equiv_to_trf_orig.mp4" length="2895782" type="video/mp4" />

		<post-id xmlns="com-wordpress:feed-additions:1">265831</post-id>	</item>
		<item>
		<title>Simplifying the Apple Watch Breathe App Animation With CSS Variables</title>
		<link>https://css-tricks.com/simplifying-apple-watch-breathe-app-animation-css-variables/</link>
					<comments>https://css-tricks.com/simplifying-apple-watch-breathe-app-animation-css-variables/#comments</comments>
		
		<dc:creator><![CDATA[Ana Tudor]]></dc:creator>
		<pubDate>Mon, 15 Jan 2018 15:00:56 +0000</pubDate>
				<category><![CDATA[Article]]></category>
		<category><![CDATA[CSS]]></category>
		<category><![CDATA[css variables]]></category>
		<category><![CDATA[custom properties]]></category>
		<category><![CDATA[transform]]></category>
		<guid isPermaLink="false">http://css-tricks.com/?p=264228</guid>

					<description><![CDATA[<p>When I saw the <a href="https://css-tricks.com/recreating-apple-watch-breathe-app-animation/">original article</a> on how to recreate this animation, my first thought was that it could all be simplified with the use of preprocessors and especialy CSS variables. So let&#8217;s dive into it and see how!</p>
</p>
<p>The result we want to reproduce.<br />
The structure</p>
<p>We keep the exact same structure.</p>
<p>In order to avoid writing the same thing multiple times, I chose to use a preprocessor.</p>
<p>My choice of preprocessor always depends on what I want to &#8230; <a href="https://css-tricks.com/simplifying-apple-watch-breathe-app-animation-css-variables/" class="read-more">Read article <span class="screen-reader-text"> &#8220;Simplifying the Apple Watch Breathe App Animation With CSS Variables&#8221;</span></a></p>
<p>The post <a rel="nofollow" href="https://css-tricks.com/simplifying-apple-watch-breathe-app-animation-css-variables/">Simplifying the Apple Watch Breathe App Animation With CSS Variables</a> appeared first on <a rel="nofollow" href="https://css-tricks.com">CSS-Tricks</a>.</p>
]]></description>
										<content:encoded><![CDATA[<p>When I saw the <a href="https://css-tricks.com/recreating-apple-watch-breathe-app-animation/">original article</a> on how to recreate this animation, my first thought was that it could all be simplified with the use of preprocessors and especialy CSS variables. So let&#8217;s dive into it and see how!</p>
<p><span id="more-264228"></span></p>
<figure><img src="https://i2.wp.com/css-tricks.com/wp-content/uploads/2017/12/result-6.gif?ssl=1" alt="Animated gif. Shows the result we want to get: six initially coinciding circles move out from the middle of the screen while the whole assembly scales up and rotates." data-recalc-dims="1"/><figcaption>The result we want to reproduce.</figcaption></figure>
<h3 id='structure'>The structure</h3>
<p>We keep the exact same structure.</p>
<p>In order to avoid writing the same thing multiple times, I chose to use a preprocessor.</p>
<p>My choice of preprocessor always depends on what I want to do, as, in a lot of cases, something like Pug offers more flexibility, but other times, Haml or Slim allow me to write the least amount of code, without even having to introduce a loop variable I wouldn&#8217;t be needing later anyway.</p>
<p>Until recently, I would have probably used Haml in this case. However, I&#8217;m currently partial to <a href="https://twitter.com/Long_Lazuli/status/941102906660573184">another technique</a> that lets me avoid setting the number of items both in the HTML and CSS preprocessor code, which means I avoid having to modify it in both if I need to use a different value at some point.</p>
<p>To better understand what I mean, consider the following Haml and Sass:</p>
<pre rel="Haml"><code>- 6.times do
  .item</code></pre>
<pre rel="SCSS"><code class="language-scss">$n: 6; // number of items

/* set styles depending on $n */</code></pre>
<p>In the example above, if I change the number of items in the Haml code, then I need to also change it in the Sass code, otherwise things break. In a more or less obvious manner, the result is not the intended one anymore.</p>
<p>So we can go around that by setting the number of circles as the value of a CSS variable we later use in the Sass code. And, in this situation, I feel better using Pug:</p>
<pre rel="Pug"><code>- var nc = 6; // number of circles

.watch-face(style=`--nc: ${nc}`)
  - for(var i = 0; i &lt; nc; i++)
    .circle(style=`--i: ${i}`)</code></pre>
<p>We&#8217;ve also set the index for every <code>.circle</code> element in a similar manner.</p>
<h3 id='basic-styles'>The basic styles</h3>
<p>We keep the exact same styles on the <code>body</code>, no change there.</p>
<p>Just like for the structure, we use a preprocessor in order to avoid writing almost the same thing multiple times. My choice is Sass because that&#8217;s what I&#8217;m most comfortable with, but for something simple like this demo, there&#8217;s nothing in particular about Sass that makes it the best choice &#8211; LESS or Stylus do the job just as well. It&#8217;s just faster for me to write Sass code, that&#8217;s all.</p>
<p>But what do we use a preprocessor for?</p>
<p>Well, first of all, we use a variable <code>$d</code> for the diameter of the circles, so that if we want to make them bigger or smaller and also control how far out they go during the animation, we only have to change the value of this variable.</p>
<p>In case anyone is wondering why not use CSS variables here, it&#8217;s because I prefer to only take this path when I need my variables to be dynamic. This is not the case with the diameter, so why write more and then maybe even have to come up with workarounds for CSS variable bugs we might run into?</p>
<pre rel="SCSS"><code class="language-scss">$d: 8em;

.circle {
  width: $d; height: $d;
}</code></pre>
<p>Note that we are not setting any dimensions on the wrapper (<code>.watch-face</code>). We don&#8217;t need to.</p>
<p>In general, if the purpose of an element is just to be a container for absolutely positioned elements, a container on which we apply group transforms (animated or not) and this container has no visible text content, no backgrounds, no borders, no box shadows&#8230; then there&#8217;s no need to set explicit dimensions on it.</p>
<p>A side effect of this is that, in order to keep our circles in the middle, we need to give them a negative <code>margin</code> of minus the radius (which is half the diameter).</p>
<pre rel="SCSS"><code class="language-scss">$d: 8em;
$r: .5*$d;

.circle {
  margin: -$r;
  width: $d; height: $d;
}</code></pre>
<p>We also give them the same <code>border-radius</code>, <code>mix-blend-mode</code> and <code>background</code> as in the original article and we get the following result:</p>
<figure><img src="https://i2.wp.com/css-tricks.com/wp-content/uploads/2017/12/expected_blend_mode.png?ssl=1" alt="Chrome screenshot. Shows the expected result we get at this point after applying these properties." data-recalc-dims="1"/><figcaption>The expected result so far (<a href="https://codepen.io/thebabydino/pen/e87ff2e92369ab6bd100dd1e6803cd96">live demo</a>).</figcaption></figure>
<p>Well, we get the above in WebKit browsers and Firefox, as Edge doesn&#8217;t yet support <code>mix-blend-mode</code> (though you can <a href="https://wpdev.uservoice.com/forums/257854-microsoft-edge-developer/suggestions/6263617-mix-blend-mode">vote for implementation</a> and please do that if you want to see it supported because your votes do count), so it shows us something a bit ugly:</p>
<figure><img src="https://i2.wp.com/css-tricks.com/wp-content/uploads/2017/12/edge_no_blend_mode.png?ssl=1" alt="Edge screenshot. No mix-blend-mode support means the overlapping regions don't look any different from the non-overlapping ones and the result is uglyish." data-recalc-dims="1"/><figcaption>The Edge result doesn&#8217;t look that good.</figcaption></figure>
<p>To get around this, we use <code>@supports</code>:</p>
<pre rel="SCSS"><code class="language-scss">.circle {
  /* same styles as before */
  
  @supports not (mix-blend-mode: screen) {
    opacity: .75
  }
}</code></pre>
<p>Not perfect, but much better:</p>
<figure><img src="https://i2.wp.com/css-tricks.com/wp-content/uploads/2017/12/edge_opacity.png?ssl=1" alt="Edge screenshot. Shows the result we get when we use partial transparency to get a result that's more like the mix-blend-mode one in other browsers." data-recalc-dims="1"/><figcaption>Using <code>@supports</code> and <code>opacity</code> to fix the lack of <code>mix-blend-mode</code> support in Edge (<a href="https://codepen.io/thebabydino/pen/55573f9a4453dd4040fce6e24bc7938a">live demo</a>).</figcaption></figure>
<p>Now let&#8217;s look a bit at the result we want to get:</p>
<figure><img src="https://i2.wp.com/css-tricks.com/wp-content/uploads/2017/12/result_numbering_split-an.png?ssl=1" alt="Screenshot of the desired circular distribution with annotations. The whole thing is split into two halves (a left one and a right one) by a vertical midline. The first three circles are in the right half and have a bluish green background, while the last three of the six circles are in the left half and have a yellowish green background. The circles are numbered starting from the topmost one in the right half and then they go clockwise." data-recalc-dims="1"/><figcaption>The desired result.</figcaption></figure>
<p>We have six circles in total, three of them in the left half and three others in the right half. They all have a <code>background</code> that&#8217;s some kind of green, those in the left half a bit more towards yellow and those in the right half a bit more towards blue.</p>
<p>If we number our circles starting from the topmost one in the right half and then going clockwise, we have that the first three circles are in the right half and have a bluish green <code>background</code> and the last three are in the left half and have a yellowish green <code>background</code>.</p>
<p>At this point, we&#8217;ve set the <code>background</code> for all the circles to be the yellowish blue one. This means we need to override it for the first half of the six circles. Since we cannot use CSS variables in selectors, we do this from the Pug code:</p>
<pre rel="Pug"><code>- var nc = 6; // number of circles

style .circle:nth-child(-n + #{.5*nc}) { background: #529ca0 }
.watch-face(style=`--nc: ${nc}`)
  - for(var i = 0; i &lt; nc; i++)
    .circle(style=`--i: ${i}`)</code></pre>
<p>In case you need a refresher on this, <code>:nth-child(-n + a)</code> selects the items at the valid indices we get for <code>n ≥ 0</code> integer values. In our case, <code>a = .5*nc = .5*6 = 3</code>, so our selector is <code>:nth-child(-n + 3)</code>.</p>
<p>If we replace <code>n</code> with <code>0</code>, we get <code>3</code>, which is a valid index, so our selector matches the third circle.</p>
<p>If we replace <code>n</code> with <code>1</code>, we get <code>2</code>, also a valid index, so our selector matches the second circle.</p>
<p>If we replace <code>n</code> with <code>2</code>, we get <code>1</code>, again valid, so our selector matches the first circle.</p>
<p>If we replace <code>n</code> with <code>3</code>, we get <code>0</code>, which isn&#8217;t a valid index, as indices are not <code>0</code>-based here. At this point, we stop as it becomes clear we won&#8217;t be getting any other positive values if we continue.</p>
<p>The following Pen illustrates how this works &#8211; the general rule is that <code>:nth-child(-n + a)</code> selects the first <code>a</code> items:</p>
<p data-height="350" style="height: 350px; display: flex; align-items: center; justify-content: center; border: 2px solid black; margin: 1rem 0; padding: 1rem; overflow: auto;" data-theme-id="1" data-slug-hash="BJwzGE" data-default-tab="result" data-user="thebabydino" data-embed-version="2" data-pen-title="Illustrating :nth-child(-n + a) " class="codepen">See the <a href="http://codepen.io/thebabydino/pen/BJwzGE/">Pen</a> by thebabydino (<a href="http://codepen.io/thebabydino">@thebabydino</a>) on <a href="http://codepen.io">CodePen</a>.</p>
<p>Returning to our circular distribution, the result so far can be seen below:</p>
<p data-height="535" style="height: 535px; display: flex; align-items: center; justify-content: center; border: 2px solid black; margin: 1rem 0; padding: 1rem; overflow: auto;" data-theme-id="1" data-slug-hash="07935aef54390ca7768c6e360cd655ed" data-default-tab="result" data-user="thebabydino" data-embed-version="2" data-pen-title="Apple Watch Breathe App step #2" class="codepen">See the <a href="http://codepen.io/thebabydino/pen/07935aef54390ca7768c6e360cd655ed/">Pen</a> by thebabydino (<a href="http://codepen.io/thebabydino">@thebabydino</a>) on <a href="http://codepen.io">CodePen</a>.</p>
<h3 id='positioning'>Positioning</h3>
<p>First off, we make the wrapper relatively positioned and its <code>.circle</code> children absolutely positioned. Now they all overlap in the middle.</p>
<p data-height="250" style="height: 250px; display: flex; align-items: center; justify-content: center; border: 2px solid black; margin: 1rem 0; padding: 1rem; overflow: auto;" data-theme-id="1" data-slug-hash="78ef3a34257b9a3c6d010392f7ad5890" data-default-tab="result" data-user="thebabydino" data-embed-version="2" data-pen-title="Apple Watch Breathe App step #3" class="codepen">See the <a href="http://codepen.io/thebabydino/pen/78ef3a34257b9a3c6d010392f7ad5890/">Pen</a> by thebabydino (<a href="http://codepen.io/thebabydino">@thebabydino</a>) on <a href="http://codepen.io">CodePen</a>.</p>
<p>In order to understand what we need to do next, let&#8217;s take a look at the following illustration:</p>
<figure><img src="https://css-tricks.com/wp-content/uploads/2017/12/rightmost_circle_offset.svg" alt="SVG Illustration. Shows the circles in their initial (overlapping dead in the middle) and final positions (with the rightmost one being highlighted in its final position). The segment between the central point of this circle in the initial position and in the final position is a horizontal segment of length equal to the circle radius."/><figcaption>The rightmost circle going from its initial to its final position (<a href="https://codepen.io/thebabydino/pen/dJywGM?editors=1000">live</a>).</figcaption></figure>
<p>The central points of the circles in the initial position are on the same horizontal line and a radius away from the rightmost circle. This means we can get to this final position by a translation of a radius <code>$r</code> along the <var>x</var> axis.</p>
<p>But what about the other circles? Their central points in the final position are also a radius away from their initial position, only along other lines.</p>
<figure><img src="https://css-tricks.com/wp-content/uploads/2017/12/circle_offsets.svg" alt="SVG Illustration. Shows the circles in their initial (overlapping dead in the middle) and final positions. The segments connecting the initial position of their central points (all dead in the middle) and the final positions of the same points are highlighted. They're all segments of length equal to the circle radius."/><figcaption>All circles: initial position (dead in the middle) is a radius away from the final one for each and every one of them (<a href="https://codepen.io/thebabydino/pen/WdNVxJ?editors=1000">live</a>).</figcaption></figure>
<p>This means that, if we first rotate their system of coordinates until their <var>x</var> axis coincides with the line between the initial and final position of the central points and then translate them by a radius, we can get them all in the correct final position in a very similar manner.</p>
<p data-height="500" style="height: 500px; display: flex; align-items: center; justify-content: center; border: 2px solid black; margin: 1rem 0; padding: 1rem; overflow: auto;" data-theme-id="1" data-slug-hash="4bf7fbf9c8d769474f34cab6b8bb7caa" data-default-tab="result" data-user="thebabydino" data-embed-version="2" data-pen-title="getting final circle positions via rotate &#038; translate chain" class="codepen">See the <a href="http://codepen.io/thebabydino/pen/4bf7fbf9c8d769474f34cab6b8bb7caa/">Pen</a> by thebabydino (<a href="http://codepen.io/thebabydino">@thebabydino</a>) on <a href="http://codepen.io">CodePen</a>.</p>
<p>Alright, but rotate each of them by what angle?</p>
<p>Well, we start from the fact that we have <code>360°</code> on a circle around a point.</p>
<p data-height="500" style="height: 500px; display: flex; align-items: center; justify-content: center; border: 2px solid black; margin: 1rem 0; padding: 1rem; overflow: auto;" data-theme-id="1" data-slug-hash="EjbBbz" data-default-tab="result" data-user="thebabydino" data-embed-version="2" data-pen-title="full circle - responsive SVG explanation" class="codepen">See the <a href="http://codepen.io/thebabydino/pen/EjbBbz/">Pen</a> by thebabydino (<a href="http://codepen.io/thebabydino">@thebabydino</a>) on <a href="http://codepen.io">CodePen</a>.</p>
<p>We have six circles distributed evenly, so the rotation difference between any two consecutive ones is <code>360°/6 = 60°</code>. Since we don&#8217;t need to rotate the rightmost <code>.circle</code> (the second one), that one&#8217;s at <code>0°</code>, which puts the one before (the first one) at <code>-60°</code>, the one after (the second one) at <code>60°</code> and so on.</p>
<p data-height="500" style="height: 500px; display: flex; align-items: center; justify-content: center; border: 2px solid black; margin: 1rem 0; padding: 1rem; overflow: auto;" data-theme-id="1" data-slug-hash="EoNNOe" data-default-tab="result" data-user="thebabydino" data-embed-version="2" data-pen-title="rotation angles" class="codepen">See the <a href="http://codepen.io/thebabydino/pen/EoNNOe/">Pen</a> by thebabydino (<a href="http://codepen.io/thebabydino">@thebabydino</a>) on <a href="http://codepen.io">CodePen</a>.</p>
<p class="explanation">Note that <code>-60°</code> and <code>300° = 360° - 60°</code> occupy the same position on the circle, so whether we get there by a clockwise (positive) rotation of <code>300°</code> or by going <code>60°</code> the other way around the circle (which gives us the minus sign) doesn&#8217;t matter. We&#8217;ll be using the <code>-60°</code> option in the code because it makes it easier to spot a convenient pattern in our case.</p>
<p>So our transforms look like this:</p>
<pre rel="SCSS"><code class="language-scss">.circle {
  &amp;:nth-child(1 /* = 0 + 1 */) {
    transform: rotate(-60deg /* -1·60° = (0 - 1)·360°/6 */) translate($r);
  }
  &amp;:nth-child(2 /* = 1 + 1 */) {
    transform: rotate(  0deg /*  0·60° = (1 - 1)·360°/6 */) translate($r);
  }
  &amp;:nth-child(3 /* = 2 + 1 */) {
    transform: rotate( 60deg /*  1·60° = (2 - 1)·360°/6 */) translate($r);
  }
  &amp;:nth-child(4 /* = 3 + 1 */) {
    transform: rotate(120deg /*  2·60° = (3 - 1)·360°/6 */) translate($r);
  }
  &amp;:nth-child(5 /* = 4 + 1 */) {
    transform: rotate(180deg /*  3·60° = (4 - 1)·360°/6 */) translate($r);
  }
  &amp;:nth-child(6 /* = 5 + 1 */) {
    transform: rotate(240deg /*  4·60° = (5 - 1)·360°/6 */) translate($r);
  }
}</code></pre>
<p>This gives us the distribution we&#8217;ve been after:</p>
<p data-height="350" style="height: 350px; display: flex; align-items: center; justify-content: center; border: 2px solid black; margin: 1rem 0; padding: 1rem; overflow: auto;" data-theme-id="1" data-slug-hash="108126def04b1c8d6c0bc889c8751778" data-default-tab="result" data-user="thebabydino" data-embed-version="2" data-pen-title="Apple Watch Breathe App step #4" class="codepen">See the <a href="http://codepen.io/thebabydino/pen/108126def04b1c8d6c0bc889c8751778/">Pen</a> by thebabydino (<a href="http://codepen.io/thebabydino">@thebabydino</a>) on <a href="http://codepen.io">CodePen</a>.</p>
<p>However, it&#8217;s very repetitive code that can easily be compacted. For any of them, the rotation angle can be written as a function of the current index and the total number of items:</p>
<pre rel="SCSS"><code class="language-scss">.circle {
  /* previous styles */
  
  transform: rotate(calc((var(--i) - 1)*360deg/var(--nc))) translate($r);
}</code></pre>
<p>This <a href="https://codepen.io/thebabydino/pen/09d96c9c95f089a4407f0feeb6a8eb69">works in WebKit browsers and Firefox 57+</a>, but fails in Edge and older Firefox browsers due to the lack of support for using <code>calc()</code> inside <code>rotate()</code> functions.</p>
<p>Fortunately, in this case, we have the option of computing and setting the individual rotation angles in the Pug code and then using them as such in the Sass code:</p>
<pre rel="Pug"><code>- var nc = 6, ba = 360/nc;

style .circle:nth-child(-n + #{.5*nc}) { background: #529ca0 }
.watch-face
  - for(var i = 0; i &lt; nc; i++)
    .circle(style=`--ca: ${(i - 1)*ba}deg`)</code></pre>
<pre rel="SCSS"><code class="language-scss">.circle {
  /* previous styles */
  
  transform: rotate(var(--ca)) translate($r);
}</code></pre>
<p>We didn&#8217;t really need the previous custom properties for anything else in this case, so we just got rid of them.</p>
<p>We now have a compact code, cross-browser version of the distribution we&#8217;ve been after:</p>
<p data-height="350" style="height: 350px; display: flex; align-items: center; justify-content: center; border: 2px solid black; margin: 1rem 0; padding: 1rem; overflow: auto;" data-theme-id="1" data-slug-hash="bc7b250be466e5a27e37df93cc172387" data-default-tab="result" data-user="thebabydino" data-embed-version="2" data-pen-title="Apple Watch Breathe App step #6" class="codepen">See the <a href="http://codepen.io/thebabydino/pen/bc7b250be466e5a27e37df93cc172387/">Pen</a> by thebabydino (<a href="http://codepen.io/thebabydino">@thebabydino</a>) on <a href="http://codepen.io">CodePen</a>.</p>
<p>Good, this means we&#8217;re done with the most important part! Now for the fluff&#8230;</p>
<h3 id='finishing'>Finishing up</h3>
<p>We take the <code>transform</code> declaration out of the class and put it inside a set of <code>@keyframes</code>. In the class, we replace it with the no translation case:</p>
<pre rel="CSS"><code class="language-css">.circle {
  /* same as before */
  
  transform: rotate(var(--ca))
}

@keyframes circle {
  to { transform: rotate(var(--ca)) translate($r) }
}</code></pre>
<p>We also add the <code>@keyframes</code> set for the pulsing animation on the <code>.watch-face</code> element.</p>
<pre rel="CSS"><code class="language-css">@keyframes pulse {
  0% { transform: scale(.15) rotate(.5turn) }
}</code></pre>
<p>Note that we don&#8217;t need both the <code>0%</code> (<code>from</code>) and <code>100%</code> (<code>to</code>) keyframes. Whenever these are missing, their values for the animated properties (just the <code>transform</code> property in our case) are generated from the values we&#8217;d have on the animated elements without the <code>animation</code>.</p>
<p>In the <code>circle</code> animation case, that&#8217;s <code>rotate(var(--ca))</code>. In the <code>pulse</code> animation case, <code>scale(1)</code> gives us the same matrix as <code>none</code>, which is the default value for <code>transform</code> so we don&#8217;t even need to set it on the <code>.watch-face</code> element.</p>
<p>We make the <code>animation-duration</code> a Sass variable, so that, if we ever want to change it, we only need to change it in one place. And finally, we set the <code>animation</code> property on both the <code>.watch-face</code> element and the <code>.circle</code> elements.</p>
<pre rel="SCSS"><code class="language-scss">$t: 4s;

.watch-face {
  position: relative;
  animation: pulse $t cubic-bezier(.5, 0, .5, 1) infinite alternate
}

.circle {
  /* same as before */
  
  animation: circle $t infinite alternate
}</code></pre>
<p>Note that we&#8217;re not setting a timing function for the <code>circle</code> animation. This is <code>ease</code> in the original demo and we don&#8217;t set it explicitly because it&#8217;s the default value.</p>
<p>And that&#8217;s it &#8211; we have <a href="http://codepen.io/thebabydino/pen/7a07795162c5db78cab9776767468f70/">our animated result</a>!</p>
<p>We could also tweak the translation distance so that it&#8217;s not exactly <code>$r</code>, but a slightly smaller value (something like <code>.95*$r</code> for example). This can also make the <code>mix-blend-mode</code> effect a bit more interesting:</p>
<p data-height="350" style="height: 350px; display: flex; align-items: center; justify-content: center; border: 2px solid black; margin: 1rem 0; padding: 1rem; overflow: auto;" data-theme-id="1" data-slug-hash="e391d0f7f7155c475888e72fdcf39ea3" data-default-tab="result" data-user="thebabydino" data-embed-version="2" data-pen-title="Apple Watch Breathe App step #8" class="codepen">See the <a href="http://codepen.io/thebabydino/pen/e391d0f7f7155c475888e72fdcf39ea3/">Pen</a> by thebabydino (<a href="http://codepen.io/thebabydino">@thebabydino</a>) on <a href="http://codepen.io">CodePen</a>.</p>
<h3 id='general-case'>Bonus: the general case!</h3>
<p>The above is for six <code>.circle</code> petals in particular. Now we&#8217;ll see how we can adapt it so that it works for any number of petals. Wait, do we need to do  more than just change the number of circle elements from the Pug code?</p>
<p>Well, let&#8217;s see what happens if we do just that:</p>
<figure><img src="https://i1.wp.com/css-tricks.com/wp-content/uploads/2017/12/result_compar-an.png?ssl=1" alt="Screenshots. They show the result we get for nc equal to 6, 8 and 9. When nc is 6, we have the previous case: splitting the whole thing into two halves with a vertical line, we have the first three (bluish green) circles in the right half and the last three (yellowish green) circles in the left half. When nc is 8, we also have the first half of the circles (the first four, bluish green) on one side of a line splitting the assembly into two geometrically symmetrical halves and the last four circles (yellowish green) on the other side of the same line. This line however isn't vertical anymore. In the nc = 9 case, all circles are yellowish green." data-recalc-dims="1"/><figcaption>The result for <code>nc</code> equal to <code>6</code> (left), <code>8</code> (middle) and <code>9</code> (right).</figcaption></figure>
<p>The results don&#8217;t look bad, but they don&#8217;t fully follow the same pattern &#8211; having the first half of the circles (the bluish green ones) on the right side of a vertical symmetry line and the second half (yellowish green) on the left side.</p>
<p>We&#8217;re pretty close in the <code>nc = 8</code> case, but the symmetry line isn&#8217;t vertical. In the <code>nc = 9</code> case however, all our circles have a yellowish green <code>background</code>.</p>
<p>So let&#8217;s see why these things happen and how we can get the results we actually want.</p>
<h4 id='nth-child'>Making <code>:nth-child()</code> work for us</h4>
<p>First off, remember we&#8217;re making half the number of circles have a bluish green <code>background</code> with this little bit of code:</p>
<pre><code>.circle:nth-child(-n + #{.5*nc}) { background: #529ca0 }</code></pre>
<p>But in the <code>nc = 9</code> case, we have that <code>.5*nc = .5*9 = 4.5</code>, which makes our selector <code>:nth-child(-n + 4.5)</code>. Since <code>4.5</code> is not an integer, the selector isn&#8217;t valid and the <code>background</code> doesn&#8217;t get applied. So the first thing we do here is floor the <code>.5*nc</code> value:</p>
<pre rel="Pug"><code>style .circle:nth-child(-n + #{~~(.5*nc)}) { background: #529ca0 }</code></pre>
<p>This is better, as for a <code>nc</code> value of <code>9</code>, the selector we get is <code>.circle:nth-child(-n + 4)</code>, which gets us the first <code>4</code> items to apply a bluish green <code>background</code> on them:</p>
<p data-height="350" style="height: 350px; display: flex; align-items: center; justify-content: center; border: 2px solid black; margin: 1rem 0; padding: 1rem; overflow: auto;" data-theme-id="1" data-slug-hash="1136ec0994243d65f450f0ca270be116" data-default-tab="result" data-user="thebabydino" data-embed-version="2" data-pen-title="Apple Watch Breathe App step #9" class="codepen">See the <a href="http://codepen.io/thebabydino/pen/1136ec0994243d65f450f0ca270be116/">Pen</a> by thebabydino (<a href="http://codepen.io/thebabydino">@thebabydino</a>) on <a href="http://codepen.io">CodePen</a>.</p>
<p>However, we still don&#8217;t have the same number of bluish green and yellowish green circles if <code>nc</code> is odd. In order to fix that, we make the circle in the middle (going from the first to the last) have a gradient <code>background</code>.</p>
<p>By &#8220;the circle in the middle&#8221; we mean the circle that&#8217;s an equal number of circles away from both the start and the end. The following interactive demo illustrates this, as well as the fact that, when the total number of circles is even, we don&#8217;t have a middle circle.</p>
<p data-height="325" style="height: 325px; display: flex; align-items: center; justify-content: center; border: 2px solid black; margin: 1rem 0; padding: 1rem; overflow: auto;" data-theme-id="1" data-slug-hash="baoMYE" data-default-tab="result" data-user="thebabydino" data-embed-version="2" data-pen-title="the middle item" class="codepen">See the <a href="http://codepen.io/thebabydino/pen/baoMYE/">Pen</a> by thebabydino (<a href="http://codepen.io/thebabydino">@thebabydino</a>) on <a href="http://codepen.io">CodePen</a>.</p>
<p>Alright, how do we get this circle?</p>
<p>Mathematically, this is the intersection between the set containing the first <code>ceil(.5*nc)</code> items and the set containing all but the first <code>floor(.5*nc)</code> items. If <code>nc</code> is even, then <code>floor(.5*nc)</code> and <code>ceil(.5*nc)</code> are equal and our intersection is the <a href="https://en.wikipedia.org/wiki/Empty_set">empty set</a> <code>∅</code>. This is illustrated by the following Pen:</p>
<p data-height="430" style="height: 430px; display: flex; align-items: center; justify-content: center; border: 2px solid black; margin: 1rem 0; padding: 1rem; overflow: auto;" data-theme-id="1" data-slug-hash="WdXQQg" data-default-tab="result" data-user="thebabydino" data-embed-version="2" data-pen-title="Get middle item" class="codepen">See the <a href="http://codepen.io/thebabydino/pen/WdXQQg/">Pen</a> by thebabydino (<a href="http://codepen.io/thebabydino">@thebabydino</a>) on <a href="http://codepen.io">CodePen</a>.</p>
<p>We get the first <code>ceil(.5*nc)</code> items using <code>:nth-child(-n + #{Math.ceil(.5*nc)})</code>, but what about the other set?</p>
<p>In general, <code>:nth-child(n + a)</code> selects all but the first <code>a - 1</code> items:</p>
<p data-height="350" style="height: 350px; display: flex; align-items: center; justify-content: center; border: 2px solid black; margin: 1rem 0; padding: 1rem; overflow: auto;" data-theme-id="1" data-slug-hash="qpPyKj" data-default-tab="result" data-user="thebabydino" data-embed-version="2" data-pen-title="Illustrating :nth-child(n + a)" class="codepen">See the <a href="http://codepen.io/thebabydino/pen/qpPyKj/">Pen</a> by thebabydino (<a href="http://codepen.io/thebabydino">@thebabydino</a>) on <a href="http://codepen.io">CodePen</a>.</p>
<p>So in order to get all but the first <code>floor(.5*nc)</code> items, we use <code>:nth-child(n + #{~~(.5*nc) + 1})</code>.</p>
<p>This means we have the following selector for the middle circle:</p>
<pre><code>:nth-child(n + #{~~(.5*nc) + 1}):nth-child(-n + #{Math.ceil(.5*nc)})</code></pre>
<p>Let&#8217;s see what this gives us.</p>
<ul>
<li>If we have <code>3</code> items, our selector is <code>:nth-child(n + 2):nth-child(-n + 2)</code>, which gets us the second item (the intersection between the <code>{2, 3, 4, ...}</code> and <code>{2, 1}</code> sets)</li>
<li>If we have <code>4</code> items, our selector is <code>:nth-child(n + 3):nth-child(-n + 2)</code>, which doesn&#8217;t catch anything (the intersection between the <code>{3, 4, 5, ...}</code> and <code>{2, 1}</code> sets is the empty set <code>∅</code>)</li>
<li>If we have <code>5</code> items, our selector is <code>:nth-child(n + 3):nth-child(-n + 3)</code>, which gets us the third item (the intersection between the <code>{3, 4, 5, ...}</code> and <code>{3, 2, 1}</code> sets)</li>
<li>If we have <code>6</code> items, our selector is <code>:nth-child(n + 4):nth-child(-n + 3)</code>, which doesn&#8217;t catch anything (the intersection between the <code>{4, 5, 6, ...}</code> and <code>{3, 2, 1}</code> sets is the empty set <code>∅</code>)</li>
<li>If we have <code>7</code> items, our selector is <code>:nth-child(n + 4):nth-child(-n + 4)</code>, which gets us the fourth item (the intersection between the <code>{4, 5, 6, ...}</code> and <code>{4, 3, 2, 1}</code> sets)</li>
<li>If we have <code>8</code> items, our selector is <code>:nth-child(n + 5):nth-child(-n + 4)</code>, which doesn&#8217;t catch anything (the intersection between the <code>{5, 6, 7, ...}</code> and <code>{4, 3, 2, 1}</code> sets is the empty set <code>∅</code>)</li>
<li>If we have <code>9</code> items, our selector is <code>:nth-child(n + 5):nth-child(-n + 5)</code>, which gets us the fifth item (the intersection between the <code>{5, 6, 7, ...}</code> and <code>{5, 4, 3, 2, 1}</code> sets)</li>
</ul>
<p>Now that we can select the item in the middle when we have an odd number of them in total, let&#8217;s give it a gradient <code>background</code>:</p>
<pre rel="Pug"><code>- var nc = 6, ba = 360/nc;

style .circle:nth-child(-n + #{~~(.5*nc)}) { background: var(--c0) }
  | .circle:nth-child(n + #{~~(.5*nc) + 1}):nth-child(-n + #{Math.ceil(.5*nc)}) {
  |   background: linear-gradient(var(--c0), var(--c1))
  | }
.watch-face(style=`--c0: #529ca0; --c1: #61bea2`)
  - for(var i = 0; i &lt; nc; i++)
    .circle(style=`--ca: ${(i - 1)*ba}deg`)</code></pre>
<p>The reason why we use a top to bottom gradient is that, ultimately, we want this item to be at the bottom, split into two halves by the vertical symmetry line of the assembly. This means we first need to rotate it until its <var>x</var> axis points down and then translate it down along this new direction of its <var>x</var> axis. In this position, the top of the item is in the right half of the assembly and the bottom of the item is in the left half of the assembly. So, if we want a gradient from the right side of the assembly to the left side of the assembly, this is a top to bottom gradient on that actual <code>.circle</code> element.</p>
<p data-height="500" style="height: 500px; display: flex; align-items: center; justify-content: center; border: 2px solid black; margin: 1rem 0; padding: 1rem; overflow: auto;" data-theme-id="1" data-slug-hash="d123fdb66265a929fda5babe21f574da" data-default-tab="result" data-user="thebabydino" data-embed-version="2" data-pen-title="Apple Watch Breathe App step #10" class="codepen">See the <a href="http://codepen.io/thebabydino/pen/d123fdb66265a929fda5babe21f574da/">Pen</a> by thebabydino (<a href="http://codepen.io/thebabydino">@thebabydino</a>) on <a href="http://codepen.io">CodePen</a>.</p>
<p>Using this technique, we have now solved the issue of the backgrounds for the general case:</p>
<p data-height="350" style="height: 350px; display: flex; align-items: center; justify-content: center; border: 2px solid black; margin: 1rem 0; padding: 1rem; overflow: auto;" data-theme-id="1" data-slug-hash="efe67d2e82d8e0848b66587749d2d29a" data-default-tab="result" data-user="thebabydino" data-embed-version="2" data-pen-title="Apple Watch Breathe App step #10" class="codepen">See the <a href="http://codepen.io/thebabydino/pen/efe67d2e82d8e0848b66587749d2d29a/">Pen</a> by thebabydino (<a href="http://codepen.io/thebabydino">@thebabydino</a>) on <a href="http://codepen.io">CodePen</a>.</p>
<p>Now all that&#8217;s left to do is make the symmetry axis vertical.</p>
<h4 id='taming-angles'>Taming the angles</h4>
<p>In order to see what we need to do here, let&#8217;s focus on the desired positioning in the top part. There, we want to always have two circles (the first in DOM order on the right and the last in DOM order on the left) symmetrically positioned with respect to the vertical axis that splits our assembly into two halves that mirror each other.</p>
<p data-height="490" style="height: 490px; display: flex; align-items: center; justify-content: center; border: 2px solid black; margin: 1rem 0; padding: 1rem; overflow: auto;" data-theme-id="1" data-slug-hash="KZyrJj" data-default-tab="result" data-user="thebabydino" data-embed-version="2" data-pen-title="circular distribution: top items" class="codepen">See the <a href="http://codepen.io/thebabydino/pen/KZyrJj/">Pen</a> by thebabydino (<a href="http://codepen.io/thebabydino">@thebabydino</a>) on <a href="http://codepen.io">CodePen</a>.</p>
<p>The fact that they&#8217;re symmetrical means the vertical axis splits the angular distance between them <code>ba</code> (which is <code>360°</code> divided by the total number of circles <code>nc</code>) into two equal halves.</p>
<figure><img src="https://css-tricks.com/wp-content/uploads/2018/01/axis_angle_split_half.svg" alt="SVG Illustration. Shows the circles distributed around a central point with the two at the top (symmetrical with respect to the vertical axis that splits the whole assembly into two mirrored halves) being highlighted. This middle axis splits the angular distance between the central points of these two circles into two equal halves."/><figcaption>Angles formed by vertical symmetry line and the radial lines to the central points of the top angles are both equal to half a base angle (<a href="https://codepen.io/thebabydino/pen/MrORYa?editors=1000">live</a>).</figcaption></figure>
<p>So both are half a base angle (where the base angle <code>ba</code> is <code>360°</code> divided by the total number of circles <code>nc</code>) away from the vertical symmetry axis, one in the clockwise direction and the other one the other way.</p>
<p>The upper half of the symmetry axis is at <code>-90°</code> (which is equivalent to <code>270°</code>).</p>
<figure><img src="https://css-tricks.com/wp-content/uploads/2018/01/deg_on_circle.svg" alt="SVG Illustration. Shows degrees around a circle in 90° steps. We start from the right (3 o'clock). This is the 0° and, in general, any multiple of 360° angle. Going clockwise, we have 90° down (at 6 o'clock), 180° on the left (at 9 o'clock) and 270° at the top (12 o'clock). Going the other way from 0°, we have -90° at the top (12 o'clock), -180° on the left (9 o'clock) and so on."/><figcaption>Degree values around the circle (<a href="https://codepen.io/thebabydino/pen/goXJqg?editors=1000">live</a>).</figcaption></figure>
<p>So in order to get to the first circle in DOM order (the one at the top on the right), we start from <code>0°</code>, go by <code>90°</code> in the negative direction and then by half a base angle back in the positive direction (clockwise). This puts the first circle at <code>.5*ba - 90</code> degrees.</p>
<figure><img src="https://css-tricks.com/wp-content/uploads/2018/01/angle_first_item.svg" alt="SVG Illustration. Shows graphically how to get the angular position of the first circle. Starting from 0° (3 o'clock), we go in the negative direction by 90° (getting at 12 o'clock). Afterwards, we go back in the positive direction by half a base angle."/><figcaption>How to get the angle the first circle is placed at (<a href="https://codepen.io/thebabydino/pen/JMOgbr?editors=1000">live</a>).</figcaption></figure>
<p>After that, every other circle is at the angle of the previous circle plus a base angle. This way, we have:</p>
<ul>
<li>the first circle (index <code>0</code>, selector <code>:nth-child(1)</code>) is at <code>ca₀ = .5*ba - 90</code> degrees</li>
<li>the second circle (index <code>1</code>, selector <code>:nth-child(2)</code>) is at <code>ca₁ = ca₀ + ba = ca₀ + 1*ba</code> degrees</li>
<li>the third circle (index <code>2</code>, selector <code>:nth-child(3)</code>u) is at <code>ca₂ = ca₁ + ba = ca₀ + ba + ba = ca₀ + 2*ba</code> degrees</li>
<li>in general, the circle of index <code>k</code> is at <code>caₖ = caₖ₋₁ + ba = ca₀ + k*ba</code> degrees</li>
</ul>
<p>So the the current angle of the circle at index <code>i</code> is <code>.5*ba - 90 + i*ba = (i + .5)*ba - 90</code> degrees:</p>
<pre rel="Pug"><code>- var nc = 6, ba = 360/nc;

//- same as before
.watch-face(style=`--c0: #529ca0; --c1: #61bea2`)
  - for(var i = 0; i &lt; nc; i++)
    .circle(style=`--ca: ${(i + .5)*ba - 90}deg`)</code></pre>
<p>This gives our final Pen, where we only need to change <code>nc</code> from the Pug code to change the result:</p>
<p data-height="350" style="height: 350px; display: flex; align-items: center; justify-content: center; border: 2px solid black; margin: 1rem 0; padding: 1rem; overflow: auto;" data-theme-id="1" data-slug-hash="d484a1562ff987d536c5a9091d556be9" data-default-tab="result" data-user="thebabydino" data-embed-version="2" data-pen-title="Apple Watch Breathe App - general case final" class="codepen">See the <a href="http://codepen.io/thebabydino/pen/d484a1562ff987d536c5a9091d556be9/">Pen</a> by thebabydino (<a href="http://codepen.io/thebabydino">@thebabydino</a>) on <a href="http://codepen.io">CodePen</a>.</p>
<p>The post <a rel="nofollow" href="https://css-tricks.com/simplifying-apple-watch-breathe-app-animation-css-variables/">Simplifying the Apple Watch Breathe App Animation With CSS Variables</a> appeared first on <a rel="nofollow" href="https://css-tricks.com">CSS-Tricks</a>.</p>
]]></content:encoded>
					
					<wfw:commentRss>https://css-tricks.com/simplifying-apple-watch-breathe-app-animation-css-variables/feed/</wfw:commentRss>
			<slash:comments>1</slash:comments>
		
		
		<post-id xmlns="com-wordpress:feed-additions:1">264228</post-id>	</item>
	</channel>
</rss>
